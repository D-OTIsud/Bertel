<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>OTI du Sud ¬∑ API ‚Äì Documentation</title>
  <meta name="color-scheme" content="light dark" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --brand: #76B097;          /* Main theme color */
      --brand-700:#5A8B73;
      --brand-600:#6BA088;
      --brand-500:#76B097;
      --brand-400:#8BC2A6;
      --brand-300:#A0D1B5;
      --brand-200:#B5E0C4;
      --brand-100:#CAEFD3;
      --brand-50:#DFF8E2;
      --accent:#76B097;          /* Accent color matches main theme */
      --accent-light:#A0D1B5;
      --bg:#FAFCFA;
      --card:#FFFFFF;
      --text:#1F2937;
      --muted:#6B7280;
      --line:#E5E7EB;
      --code-bg:#0B1020;
      --code:#EDEFF6;
      --shadow:0 10px 25px rgba(118,176,151,.08),0 2px 6px rgba(118,176,151,.04);
      --shadow-hover:0 15px 35px rgba(118,176,151,.12),0 4px 10px rgba(118,176,151,.06);
      --radius:18px;
      --gradient:linear-gradient(135deg, var(--brand-400), var(--brand-600));
    }
    @media (prefers-color-scheme: dark){
      :root{
        --bg:#0B1117;
        --card:#0F1722;
        --text:#E5E7EB;
        --muted:#A3AAB5;
        --line:#1F2A37;
        --shadow:0 10px 25px rgba(0,0,0,.25),0 2px 6px rgba(0,0,0,.15);
        --shadow-hover:0 15px 35px rgba(0,0,0,.35),0 4px 10px rgba(0,0,0,.2);
        --code-bg:#0A0F1A;
        --code:#DDE1F2;
        --gradient:linear-gradient(135deg, var(--brand-500), var(--brand-700));
      }
    }
    .dark{
      --bg:#0B1117;
      --card:#0F1722;
      --text:#E5E7EB;
      --muted:#A3AAB5;
      --line:#1F2A37;
      --shadow:0 10px 25px rgba(0,0,0,.25),0 2px 6px rgba(0,0,0,.15);
      --shadow-hover:0 15px 35px rgba(0,0,0,.35),0 4px 10px rgba(0,0,0,.2);
      --code-bg:#0A0F1A;
      --code:#DDE1F2;
      --gradient:linear-gradient(135deg, var(--brand-500), var(--brand-700));
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,'Helvetica Neue',Arial,'Noto Sans',sans-serif;
      color:var(--text);
      background:var(--bg);
      line-height:1.55;
    }
    a{color:var(--brand-400);text-decoration:none}
    a:hover{text-decoration:underline}
    /* Header */
    .topbar{
      position:sticky;top:0;z-index:50;
      background:var(--gradient);
      color:#fff;border-bottom:1px solid rgba(255,255,255,.15);
      box-shadow:0 8px 32px rgba(118,176,151,.15), 0 4px 16px rgba(118,176,151,.1);
      backdrop-filter:blur(20px);
      position: relative;
      overflow: hidden;
    }
    .topbar::before{
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(45deg, rgba(255,255,255,.05) 0%, transparent 50%, rgba(255,255,255,.03) 100%);
      pointer-events: none;
    }
    .topbar-inner{
      max-width:1200px;margin:0 auto;
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:32px;
      padding:24px 24px;
      align-items:center;
      min-height:100px;
      position: relative;
      z-index: 1;
    }
    .header-left{
      display:flex;
      align-items:center;
      gap:20px;
    }
    .logo{
      width:70px;height:70px;border-radius:20px;background:#fff;padding:10px;
      box-shadow:0 6px 20px rgba(118,176,151,.25),inset 0 0 0 2px rgba(118,176,151,.1);
      transition:all 0.3s ease;
      flex-shrink:0;
    }
    .logo:hover{
      transform:scale(1.08) rotate(2deg);
      box-shadow:0 8px 25px rgba(118,176,151,.35),inset 0 0 0 2px rgba(118,176,151,.2);
    }
    .title{
      display:flex;flex-direction:column;gap:6px;
    }
    .title strong{
      font-weight:800;letter-spacing:.4px;font-size:22px;
      text-shadow:0 2px 4px rgba(0,0,0,.1);
    }
    .title small{
      opacity:.95;font-size:15px;font-weight:500;
      text-shadow:0 1px 2px rgba(0,0,0,.1);
    }
    .header-right{
      display:flex;
      flex-direction:column;
      gap:16px;
      align-items:flex-end;
    }
    .actions{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
    }
    .chip{
      background:rgba(255,255,255,.18);
      color:#fff;border:1px solid rgba(255,255,255,.25);
      border-radius:999px;padding:8px 12px;font-size:12px;font-weight:700;
      box-shadow:0 2px 8px rgba(0,0,0,.1);
      transition:all 0.2s ease;
    }
    .chip:hover{
      background:rgba(255,255,255,.25);
      transform:translateY(-1px);
    }
    .btn{
      border-radius:14px;border:1px solid rgba(255,255,255,.3);
      background:rgba(255,255,255,.15);color:#fff;padding:10px 14px;
      display:flex;align-items:center;gap:8px;font-weight:600;
      transition:all 0.3s ease;
      backdrop-filter:blur(10px);
      font-size:13px;
    }
    .btn:hover{
      background:rgba(255,255,255,.25);
      transform:translateY(-2px);
      box-shadow:0 6px 16px rgba(255,255,255,.2);
      border-color:rgba(255,255,255,.4);
    }
    .searchbar{
      width:100%;
      max-width:420px;
    }
    .searchbar input{
      width:100%;border:none;background:#fff;border-radius:16px;
      padding:16px 18px 16px 48px;color:#111;outline:none;font-size:15px;
      box-shadow:0 4px 16px rgba(118,176,151,.15), 0 2px 8px rgba(118,176,151,.1);
      background:
        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="%2376B097" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>') 16px 50% / 24px 24px no-repeat, #fff;
      transition:all 0.3s ease;
      font-weight:500;
    }
    .searchbar input:focus{
      box-shadow:0 6px 20px rgba(118,176,151,.2), 0 4px 12px rgba(118,176,151,.15);
      transform:translateY(-1px);
    }
    .searchbar input::placeholder{
      color:#999;
      font-weight:400;
    }
    @media (prefers-color-scheme: dark){
      .searchbar input{background:
        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="%23A0D1B5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>') 16px 50% / 24px 24px no-repeat, var(--card); color:var(--text)}
    }
    .container{
      max-width:1200px;margin:0 auto;padding:10px 18px 90px;display:grid;
      grid-template-columns:minmax(260px, 320px) 1fr;gap:24px;
    }
    @media (max-width:1024px){
      .container{
        grid-template-columns:1fr;
        gap:20px;
      }
    }
    /* TOC */
    .toc{
      position:sticky;top:20px;align-self:start;background:var(--card);
      border:1px solid var(--line);border-radius:var(--radius);box-shadow:var(--shadow);
      padding:20px;max-height:calc(100vh - 40px);overflow-y:auto;overflow-x:hidden;
      backdrop-filter:blur(10px);
      transition:all 0.3s ease;
    }
    .toc::-webkit-scrollbar{
      width:6px;
    }
    .toc::-webkit-scrollbar-track{
      background:transparent;
      border-radius:3px;
    }
    .toc::-webkit-scrollbar-thumb{
      background:var(--brand-300);
      border-radius:3px;
    }
    .toc::-webkit-scrollbar-thumb:hover{
      background:var(--brand-400);
    }
    .toc::-webkit-scrollbar-corner{
      background:transparent;
    }
    .toc:hover{
      box-shadow:var(--shadow-hover);
      transform:translateY(-2px);
    }
    .toc h3{
      margin:0 0 16px 0;font-size:14px;text-transform:uppercase;letter-spacing:.1em;
      color:var(--brand-600);font-weight:700;border-bottom:2px solid var(--brand-100);
      padding-bottom:8px;
    }
    .toc a{
      display:block;padding:8px 12px;border-radius:10px;color:var(--text);
      border-left:4px solid transparent;font-size:14px;font-weight:500;
      transition:all 0.3s ease;text-decoration:none;margin-bottom:2px;
      position:relative;word-wrap:break-word;hyphens:auto;
    }
    .toc a:hover{
      background:rgba(118,176,151,.1);
      transform:translateX(4px);
      border-left-color:var(--brand-300);
      color:var(--brand-700);
      box-shadow:0 2px 8px rgba(118,176,151,.15);
    }
    .toc a.active{
      background:linear-gradient(135deg, rgba(118,176,151,.15), rgba(118,176,151,.08));
      border-left-color:var(--brand-500);
      color:var(--brand-700);
      font-weight:600;
      transform:translateX(6px);
      box-shadow:0 2px 8px rgba(118,176,151,.2);
    }
    .toc a.active::before{
      content: '';
      position: absolute;
      left: -4px;
      top: 50%;
      transform: translateY(-50%);
      width: 4px;
      height: 20px;
      background: var(--brand-500);
      border-radius: 0 2px 2px 0;
    }
    .toc .sub{
      padding-left:16px;
      margin-left:8px;
      border-left:2px solid var(--brand-100);
      overflow:hidden;
    }
    .toc .sub a{
      font-size:13px;
      padding:6px 10px;
      word-wrap:break-word;
    }
    .toc .sub a.active{
      border-left-color:var(--brand-400);
    }
    
    /* Main */
    .card{
      background:var(--card);border:1px solid var(--line);border-radius:var(--radius);
      box-shadow:var(--shadow);padding:22px;margin-bottom:18px;
      backdrop-filter:blur(10px);
      transition:all 0.2s ease;
    }
    .card:hover{
      box-shadow:var(--shadow-hover);
      transform:translateY(-2px);
    }
    h1{font-size:32px;margin:0 0 6px 0}
    h2{font-size:26px;margin:24px 0 8px}
    h3{font-size:20px;margin:18px 0 8px}
    p{margin:8px 0 12px}
    .lead{color:var(--muted);font-size:15px}
    .pill{display:inline-flex;align-items:center;gap:8px;font-weight:700;
      color:var(--brand-700);background:rgba(118,176,151,.14);border:1px solid rgba(118,176,151,.3);
      padding:6px 10px;border-radius:999px;font-size:12px;
      transition:all 0.2s ease;
    }
    .pill:hover{
      background:rgba(118,176,151,.20);
      transform:scale(1.02);
    }
    
    /* Tip card styles */
    .tip-card{
      height:fit-content;
      max-width:100%;
      background:linear-gradient(135deg, rgba(59,130,246,.08), rgba(59,130,246,.04));
      border:1px solid rgba(59,130,246,.2);
    }
    .tip-pill{
      background:rgba(59,130,246,.2);
      border-color:rgba(59,130,246,.4);
      color:#1e40af;
    }
    .tip-pill:hover{
      background:rgba(59,130,246,.3);
    }
    .tip-text{
      color:#374151;
      font-weight:500;
    }
    @media (prefers-color-scheme: dark){
      .tip-card{
        background:linear-gradient(135deg, rgba(59,130,246,.15), rgba(59,130,246,.08));
        border:1px solid rgba(59,130,246,.3);
      }
      .tip-pill{
        background:rgba(59,130,246,.25);
        border-color:rgba(59,130,246,.5);
        color:#60a5fa;
      }
      .tip-pill:hover{
        background:rgba(59,130,246,.35);
      }
      .tip-text{
        color:#d1d5db;
      }
    }
    .dark .tip-card{
      background:linear-gradient(135deg, rgba(59,130,246,.15), rgba(59,130,246,.08));
      border:1px solid rgba(59,130,246,.3);
    }
    .dark .tip-pill{
      background:rgba(59,130,246,.25);
      border-color:rgba(59,130,246,.5);
      color:#60a5fa;
    }
    .dark .tip-pill:hover{
      background:rgba(59,130,246,.35);
    }
    .dark .tip-text{
      color:#d1d5db;
    }
    /* Tables */
    table{width:100%;border-collapse:separate;border-spacing:0 6px}
    th,td{padding:10px 12px;vertical-align:top}
    th{font-size:12px;text-transform:uppercase;letter-spacing:.06em;color:var(--muted)}
    tbody tr{background:linear-gradient(var(--card),var(--card)) padding-box, radial-gradient(120% 100% at 0 0,rgba(118,176,151,.13),transparent 40%) border-box;
      border:1px solid var(--line);border-radius:12px;
      transition:all 0.2s ease;
    }
    tbody tr:hover{
      background:linear-gradient(var(--card),var(--card)) padding-box, radial-gradient(120% 100% at 0 0,rgba(118,176,151,.18),transparent 40%) border-box;
      transform:translateY(-1px);
      box-shadow:0 4px 12px rgba(118,176,151,.08);
    }
    tbody td:first-child{border-top-left-radius:12px;border-bottom-left-radius:12px}
    tbody td:last-child{border-top-right-radius:12px;border-bottom-right-radius:12px}
    code,.badge{
      font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,Monaco,monospace;
      font-size:.92em;border-radius:6px;padding:.08em .35em;background:rgba(118,176,151,.08);
      transition:all 0.2s ease;
    }
    code:hover{
      background:rgba(118,176,151,.12);
    }
    .badge{background:rgba(118,176,151,.12);border:1px solid rgba(118,176,151,.25);color:var(--brand-600); font-weight:700}
    /* Collapsible sections */
    details{
      border:1px solid var(--line);border-radius:14px;background:var(--card);margin:12px 0;box-shadow:var(--shadow);
      transition:all 0.2s ease;
    }
    details:hover{
      box-shadow:var(--shadow-hover);
    }
    details>summary{
      cursor:pointer;list-style:none;padding:14px 16px;font-weight:700;display:flex;align-items:center;gap:10px;
      transition:all 0.2s ease;
    }
    details>summary:hover{
      background:rgba(118,176,151,.05);
      border-radius:14px 14px 0 0;
    }
    details>summary::before{
      content:"";width:18px;height:18px;flex:0 0 18px;border-radius:50%;
      background:conic-gradient(var(--accent) 25%, transparent 0 100%);mask:radial-gradient(circle 8px, transparent 7px,#000 8px);
      transition:transform .25s ease
    }
    details[open]>summary::before{transform:rotate(90deg)}
    details .content{padding:2px 16px 16px}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:14px;align-items:start}
    @media (max-width:900px){.row{grid-template-columns:1fr}}
    
    /* Deck layout for filters */
    .deck-example{
      margin-bottom:32px;
    }
    .deck-example h4{
      margin:0 0 16px 0;
      color:var(--brand-600);
      font-size:16px;
      font-weight:700;
    }
    .deck-parameters{
      margin-top:32px;
    }
    .deck-parameters h4{
      margin:0 0 20px 0;
      color:var(--brand-600);
      font-size:18px;
      font-weight:700;
      border-bottom:2px solid var(--brand-100);
      padding-bottom:12px;
    }
    .filters-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(300px, 1fr));
      gap:24px;
    }
    .filter-category{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:16px;
      padding:20px;
      box-shadow:0 4px 12px rgba(118,176,151,.08);
      transition:transform 0.2s ease, box-shadow 0.2s ease;
    }
    .filter-category:hover{
      transform:translateY(-2px);
      box-shadow:0 8px 24px rgba(118,176,151,.12);
    }
    .filter-category h5{
      margin:0 0 16px 0;
      color:var(--brand-700);
      font-size:14px;
      font-weight:600;
      text-transform:uppercase;
      letter-spacing:.05em;
      border-bottom:1px solid var(--brand-100);
      padding-bottom:8px;
    }
    .filter-category ul{
      margin:0;
      padding:0;
      list-style:none;
    }
    .filter-category li{
      padding:6px 0;
      font-size:13px;
      line-height:1.5;
      border-bottom:1px solid rgba(118,176,151,.05);
    }
    .filter-category li:last-child{
      border-bottom:none;
    }
    .filter-category code{
      background:rgba(118,176,151,.08);
      color:var(--brand-700);
      font-weight:600;
      padding:2px 6px;
      border-radius:4px;
    }
    @media (max-width:900px){
      .filters-grid{
        grid-template-columns:1fr;
        gap:16px;
      }
      .filter-category{
        padding:16px;
      }
    }
    /* Code blocks */
    pre{
      background:var(--code-bg);color:var(--code);border-radius:14px;
      padding:14px 12px;overflow:auto;border:1px solid #121826;
      position:relative;
    }
    .code-tabs{
      border:1px solid var(--line); 
      border-radius:14px; 
      overflow:hidden; 
      box-shadow:var(--shadow);
      position:relative;
    }
    .tab-panel{
      position:relative;
    }
    .tab-bar{display:flex;background:linear-gradient(180deg,#ffffff, #f5f7fb);border-bottom:1px solid var(--line)}
    @media (prefers-color-scheme: dark){.tab-bar{background:linear-gradient(180deg,#0F1722,#0c1421)}}
    .tab-bar button{
      all:unset;cursor:pointer;padding:10px 14px;font-weight:700;font-size:13px;
      color:var(--muted);
    }
    .tab-bar button.active{color:var(--text);border-bottom:2px solid var(--accent)}
    .tab-panel{display:none}
    .tab-panel.active{display:block}
    .code-actions{
      display:flex;justify-content:flex-end;gap:8px;
      margin:-12px 12px 12px 0;
      position:relative;
      z-index:10;
    }
    .copy{
      all:unset;cursor:pointer;
      background:rgba(118,176,151,.12);
      border:1px solid rgba(118,176,151,.3);
      padding:8px 12px;border-radius:8px;font-weight:600;
      font-size:12px;color:#ffffff;
      transition:all 0.2s ease;
      position:relative;
      backdrop-filter:blur(8px);
      box-shadow:0 2px 8px rgba(118,176,151,.15);
    }
    .copy:hover{
      background:rgba(118,176,151,.18);
      border-color:var(--brand-400);
      transform:translateY(-1px);
      box-shadow:0 4px 12px rgba(118,176,151,.2);
    }
    .copy.success{
      border-color:var(--brand-500);
      color:#ffffff;
      background:rgba(118,176,151,.15);
      box-shadow:0 2px 8px rgba(118,176,151,.25);
    }
    
    /* Floating copy button */
    .copy-floating{
      position:absolute !important;
      top:8px;
      right:8px;
      z-index:20;
      margin:0 !important;
    }
    
    /* Special positioning for tab panels */
    .tab-panel .copy-floating{
      top:6px;
      right:6px;
    }
    /* Footer */
    .footer{
      text-align:center;color:var(--muted);font-size:12px;margin-top:26px
    }
    .kdb{border:1px solid var(--line);border-bottom-width:3px;border-radius:8px;padding:.1em .5em;font-weight:700}
    .hero-badge{
      display:inline-flex;gap:8px;align-items:center;background:var(--brand-50);color:var(--brand-700);
      border:1px solid var(--brand-300);padding:6px 10px;border-radius:999px;margin-top:6px;
      transition:all 0.2s ease;
    }
    .hero-badge:hover{
      background:var(--brand-100);
      transform:scale(1.02);
      box-shadow:0 4px 12px rgba(118,176,151,.15);
    }
    .inline-help{font-size:13px;color:var(--muted)}
    .sep{height:1px;background:var(--line);margin:12px 0}
    
    /* Additional visual enhancements */
    .tab-bar button{
      transition:all 0.2s ease;
    }
    .tab-bar button:hover{
      background:rgba(118,176,151,.08);
    }
    
    /* Smooth scrolling */
    html {
      scroll-behavior: smooth;
    }
    
    /* Enhanced focus states */
    a:focus, button:focus, input:focus {
      outline: 2px solid var(--brand-400);
      outline-offset: 2px;
    }
    
    /* Loading animation for better UX */
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }
    
    .loading {
      animation: pulse 2s infinite;
    }
    
    /* Enhanced code blocks */
    pre {
      position: relative;
      overflow-x: auto;
    }
    
    /* Better mobile responsiveness */
    /* Medium screens */
    @media (max-width: 1200px) and (min-width: 769px) {
      .container {
        grid-template-columns: minmax(240px, 280px) 1fr;
        gap: 20px;
      }
      
      .toc {
        padding: 18px;
        max-height: calc(100vh - 40px);
        top: 20px;
      }
      
      .toc a {
        padding: 7px 10px;
        font-size: 13px;
      }
    }
    
    /* Small screens */
    @media (max-width: 768px) {
      .topbar-inner {
        grid-template-columns: 1fr;
        gap: 16px;
        padding: 16px 12px;
      }
      
      .header-left {
        justify-content: center;
        text-align: center;
      }
      
      .header-right {
        align-items: center;
      }
      
      .searchbar {
        max-width: 100%;
      }
      
      .actions {
        justify-content: center;
        flex-wrap: wrap;
      }
      
      .logo {
        width: 60px;
        height: 60px;
      }
      
      .title strong {
        font-size: 20px;
      }
      
      .title small {
        font-size: 13px;
      }
      
      .toc {
        top: 20px;
        padding: 16px;
        max-height: calc(100vh - 40px);
        position: sticky;
      }
      
      .toc a {
        padding: 6px 10px;
        font-size: 13px;
      }
      
      .toc .sub {
        padding-left: 12px;
        margin-left: 6px;
      }
      
      .container {
        grid-template-columns: 1fr;
        padding: 8px 12px 60px;
        gap: 16px;
      }
      
      .card {
        padding: 16px;
        margin-bottom: 12px;
      }
      
      h1 { font-size: 28px; }
      h2 { font-size: 22px; }
      h3 { font-size: 18px; }
    }

    /* Enhanced section transitions and hover effects */
    .card, details, section {
      transition: all 0.3s ease;
      position: relative;
    }
    
    .card:hover, details:hover, section:hover {
      transform: translateY(-1px);
    }
    
    /* Smooth scroll behavior */
    html {
      scroll-behavior: smooth;
    }

    /* Floating toggle sections button */
    .floating-toggle {
      position: fixed;
      bottom: 30px;
      right: 30px;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: var(--brand);
      color: white;
      border: none;
      box-shadow: 0 4px 16px rgba(118,176,151,.3), 0 2px 8px rgba(118,176,151,.2);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      font-weight: bold;
      transition: all 0.3s ease;
      z-index: 1000;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,.2);
    }

    .floating-toggle:hover {
      transform: translateY(-2px) scale(1.05);
      box-shadow: 0 6px 20px rgba(118,176,151,.4), 0 4px 12px rgba(118,176,151,.3);
      background: var(--brand-600);
    }

    .floating-toggle:active {
      transform: translateY(0) scale(0.95);
    }

    /* Dark mode adjustments */
    @media (prefers-color-scheme: dark) {
      .floating-toggle {
        box-shadow: 0 4px 16px rgba(0,0,0,.4), 0 2px 8px rgba(0,0,0,.3);
        border: 1px solid rgba(255,255,255,.1);
      }
      
      .floating-toggle:hover {
        box-shadow: 0 6px 20px rgba(0,0,0,.5), 0 4px 12px rgba(0,0,0,.4);
      }
    }

    .dark .floating-toggle {
      box-shadow: 0 4px 16px rgba(0,0,0,.4), 0 2px 8px rgba(0,0,0,.3);
      border: 1px solid rgba(255,255,255,.1);
    }
    
    .dark .floating-toggle:hover {
      box-shadow: 0 6px 20px rgba(0,0,0,.5), 0 4px 12px rgba(0,0,0,.4);
    }
  </style>
</head>
<body>
  <header class="topbar">
    <div class="topbar-inner">
      <div class="header-left">
      <img class="logo" alt="OTI du Sud" src="https://supabertel.otisud.re/storage/v1/object/public/logo//logo200X200.png">
      <div class="title">
        <strong>OTI du SUD ¬∑ API</strong>
        <small>Documentation compl√®te & bonnes pratiques</small>
      </div>
      </div>
      <div class="header-right">
        <div class="searchbar">
          <input id="globalSearch" type="search" placeholder="Rechercher dans la doc (endpoints, param√®tres, champs‚Ä¶)">
        </div>
      <div class="actions">
        <span class="chip" title="Version de la page">v1</span>
          <button class="btn" id="toggleTheme" title="Basculer mode clair/sombre"><span id="themeText">Light</span> ‚ñæ</button>
          <button class="btn" id="toggleSections" title="D√©plier/Replier toutes les sections">‚ñæ Ouvrir tout</button>
      </div>
    </div>
    </div>
  </header>

  <main class="container" id="container">
    <!-- TOC -->
    <nav class="toc" id="toc">
      <h3>Sommaire</h3>
      <!-- auto-filled -->
    </nav>

    <!-- CONTENT -->
    <div id="content">
      <section class="card" id="intro">
        <h1>Documentation de l‚ÄôAPI</h1>
        <p class="lead">Une API structur√©e autour d'appels <code>/rpc/&lt;nom_fonction&gt;</code> via <b>POST</b>, avec pagination, filtres riches et extraction des trac√©s KML/GPX pour les itin√©raires.</p>
      </section>

      <!-- 1) Auth & conventions -->
      <section class="card" id="auth">
        <h2>1) Authentification & conventions</h2>

        <details open>
          <summary>1.1 M√©thodes d'authentification</summary>
          <div class="content">
            <p>L'API Bertel v3 supporte plusieurs m√©thodes d'authentification selon votre contexte d'utilisation :</p>
            
            <h3>JWT (Recommand√©e pour les applications)</h3>
            <p>Pour les applications web/mobile avec utilisateurs connect√©s :</p>
            <div class="code-block">
              <pre><code>Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...</code></pre>
            </div>
            <p><strong>Avantages :</strong> Acc√®s aux donn√©es √©tendues selon les r√¥les utilisateur, s√©curit√© maximale.</p>
            
            <h3>Cl√© API (Service-to-Service)</h3>
            <p>Pour les int√©grations serveur-√†-serveur :</p>
            <div class="code-block">
              <pre><code>apikey: bertel_sk_1234567890abcdef</code></pre>
            </div>
            <p><strong>Avantages :</strong> Acc√®s complet aux donn√©es publiques, id√©al pour les synchronisations automatiques.</p>
            
            <h3>Acc√®s anonyme (Lecture seule)</h3>
            <p>Pour les donn√©es publiques uniquement :</p>
            <div class="code-block">
              <pre><code>apikey: &lt;SUPABASE_ANON_KEY&gt;
Authorization: Bearer &lt;SUPABASE_ANON_KEY&gt;</code></pre>
            </div>
            <p><strong>Important :</strong> m√™me en acc√®s anonyme, Supabase/PostgREST exige ces en-t√™tes pour router la requ√™te. Utilisez la cl√© publique (anon) fournie par votre projet Supabase.</p>
            <p><strong>Limitations :</strong> Seules les donn√©es publiques (<code>status = 'published'</code>) sont accessibles.</p>
          </div>
        </details>

        <details>
          <summary>1.2 En-t√™tes HTTP requis</summary>
          <div class="content">
            <p>Chaque requ√™te doit inclure :</p>
            <ul>
              <li><code>Content-Type: application/json</code></li>
              <li><code>Accept: application/json</code></li>
              <li>Vos en-t√™tes d'authentification selon votre m√©thode choisie (voir ci-dessus)</li>
            </ul>
            
            <h3>Exemple complet de requ√™te</h3>
            <div class="code-block">
              <pre><code>curl -X POST "https://api.bertel.re/rpc/get_object_resource" \
  -H "Content-Type: application/json" \
  -H "Accept: application/json" \
  -H "apikey: {SUPABASE_ANON_KEY}" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -d '{"p_object_id": "HOTTST0000000001"}'</code></pre>
            </div>
            <p class="inline-help"><strong>Remplacez</strong> <code>{SUPABASE_ANON_KEY}</code> par la cl√© publique (anon) de votre projet Supabase. Pour les appels serveur √† serveur, utilisez la cl√© service et un token appropri√©.</p>
          </div>
        </details>

        <details>
          <summary>1.3 Niveaux d'acc√®s aux donn√©es</summary>
          <div class="content">
            <p>Selon votre m√©thode d'authentification, vous avez acc√®s √† diff√©rents niveaux de donn√©es :</p>
            
            <table>
              <thead>
                <tr><th>M√©thode</th><th>Donn√©es publiques</th><th>Donn√©es √©tendues</th><th>Donn√©es priv√©es</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>Anonyme</strong></td>
                  <td>‚úÖ Objets publi√©s uniquement</td>
                  <td>‚ùå Non</td>
                  <td>‚ùå Non</td>
                </tr>
                <tr>
                  <td><strong>Cl√© API</strong></td>
                  <td>‚úÖ Tous les objets</td>
                  <td>‚úÖ Selon les r√¥les</td>
                  <td>‚ùå Non</td>
                </tr>
                <tr>
                  <td><strong>JWT (Utilisateur)</td>
                  <td>‚úÖ Tous les objets</td>
                  <td>‚úÖ Si acteur de l'organisation</td>
                  <td>‚úÖ Si acteur de l'organisation</td>
                </tr>
              </tbody>
            </table>
            
            <div class="card info-card" style="margin-top: 16px;">
              <div class="pill info-pill">Donn√©es √©tendues</div>
              <p>Les <strong>donn√©es √©tendues</strong> incluent : descriptions priv√©es, contacts non-publics, m√©dias non-publi√©s, informations l√©gales, r√©ductions, politiques de groupe.</p>
            </div>
            
            <div class="card warning-card" style="margin-top: 16px;">
              <div class="pill warning-pill">S√©curit√©</div>
              <p>L'acc√®s aux donn√©es √©tendues/priv√©es n√©cessite que l'utilisateur soit li√© √† l'organisation propri√©taire de l'objet via son adresse email dans <code>actor_channel</code>.</p>
            </div>
          </div>
        </details>

        <details>
          <summary>1.4 Gestion des erreurs d'authentification</summary>
          <div class="content">
            <p>L'API retourne des codes d'erreur sp√©cifiques pour les probl√®mes d'authentification :</p>
            
            <table>
              <thead>
                <tr><th>Code HTTP</th><th>Message</th><th>Cause</th><th>Solution</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td><code>401</code></td>
                  <td>Unauthorized</td>
                  <td>Token JWT invalide ou expir√©</td>
                  <td>Renouveler le token ou se reconnecter</td>
                </tr>
                <tr>
                  <td><code>403</code></td>
                  <td>Forbidden</td>
                  <td>Cl√© API invalide ou droits insuffisants</td>
                  <td>V√©rifier la cl√© API ou les permissions</td>
                </tr>
                <tr>
                  <td><code>429</code></td>
                  <td>Too Many Requests</td>
                  <td>Limite de taux d√©pass√©e</td>
                  <td>Attendre ou impl√©menter un backoff</td>
                </tr>
              </tbody>
            </table>
            
            <h3>Exemple de r√©ponse d'erreur</h3>
            <div class="code-block">
              <pre><code>{
  "code": "PGRST301",
  "message": "JWT expired",
  "hint": "Refresh your token and try again"
}</code></pre>
            </div>
          </div>
        </details>

        <details open>
          <summary>1.5 Convention d'appel</summary>
          <div class="content">
            <p><b>M√©thode</b> : <code>POST</code><br>
              <b>Chemin</b> : <code>/rpc/&lt;nom_fonction&gt;</code></p>
            <p>Exemples : <code>/rpc/get_object_resource</code> ‚Ä¢ <code>/rpc/list_object_resources_page</code> ‚Ä¢ <code>/rpc/list_object_resources_since_fast</code> ‚Ä¢ <code>/rpc/list_object_resources_filtered_page</code> ‚Ä¢ <code>/rpc/list_object_resources_filtered_since_fast</code></p>
            <p><b>Corps</b> : JSON avec param√®tres nomm√©s (voir chaque endpoint).</p>
          </div>
        </details>

        <details open>
          <summary>1.6 Types de base (comment lire les r√©ponses)</summary>
          <div class="content">
              <table>
                <thead><tr><th>Type</th><th>Description</th></tr></thead>
                <tbody>
                  <tr><td><code>string</code></td><td>Texte (ex. <code>"H√¥tel du Parc"</code>).</td></tr>
                  <tr><td><code>number</code></td><td>Nombre (ex. <code>12</code>, <code>3.14</code>).</td></tr>
                  <tr><td><code>boolean</code></td><td><code>true</code> / <code>false</code>.</td></tr>
                  <tr><td><code>timestamp</code></td><td>Date-heure ISO 8601 en UTC (ex. <code>"2024-03-18T09:30:00Z"</code>).</td></tr>
                  <tr><td><code>enum</code> (code)</td><td>Valeur cod√©e (ex. <code>"image"</code>, <code>"ITI"</code>, <code>"published"</code>).</td></tr>
                  <tr><td><code>array</code></td><td>Liste (ex. <code>["fr","en"]</code>).</td></tr>
                  <tr><td><code>object</code></td><td>Sous-ensemble structur√© avec ses propres champs.</td></tr>
                </tbody>
              </table>
            <div class="card tip-card" style="margin-top: 20px;">
              <div class="pill tip-pill">Astuce</div>
              <p class="lead tip-text">Les champs absents pour un objet sont renvoy√©s comme <code>[]</code>, <code>{}</code> ou <code>null</code> selon le bloc : pas d'exception.</p>
            </div>
          </div>
        </details>

        <details open id="object-types-codes">
          <summary>1.7 Codes de types d'objets (p_types / p_object_type)</summary>
          <div class="content">
            <p>Les endpoints d‚Äô√©num√©ration et de recherche acceptent un ou plusieurs codes de type d‚Äôobjet via <code>p_types</code> (ou <code>p_object_type</code> selon la fonction). Liste des codes disponibles‚Äâ:</p>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Usage principal</th><th>Informations cl√©s pour le voyageur</th></tr></thead>
              <tbody>
                <tr><td><code>ORG</code></td><td>Organisation</td><td>OTI/CRT, gestion et publication</td><td><code>contacts</code> (t√©l, email, site), <code>opening_times</code>, <code>location</code>, <code>descriptions</code>, <code>media</code></td></tr>
                <tr><td><code>HOT</code></td><td>H√¥tel</td><td>H√©bergement h√¥telier</td><td><code>prices</code> (gammes/p√©riodes), <code>amenities</code> (wifi, parking, breakfast), <code>capacity</code> (chambres), <code>classifications</code> (√©toiles, √©co-labels)</td></tr>
                <tr><td><code>HPA</code></td><td>H√©bergement particulier</td><td>G√Æte / meubl√©</td><td><code>prices</code>, <code>amenities</code> (cuisine, lave-linge, parking), <code>capacity</code>, <code>classifications</code> (√©pis G√Ætes de France)</td></tr>
                <tr><td><code>HLO</code></td><td>H√©bergement loisir</td><td>R√©sidences / villages</td><td><code>amenities</code> (piscine, spa, kids_club), <code>prices</code>, <code>capacity</code>, <code>classifications</code> (√©toiles, labels)</td></tr>
                <tr><td><code>CAMP</code></td><td>Camping</td><td>Terrain de camping</td><td><code>capacity</code> (emplacements, tentes, camping-cars), <code>amenities</code> (sanitaires, √©lectricit√©, eau), <code>prices</code>, <code>opening_times</code></td></tr>
                <tr><td><code>RES</code></td><td>Restaurant</td><td>Restauration</td><td><code>opening_times</code> (service midi/soir), <code>menus</code> (plats/prix), <code>cuisine_types</code>/<code>dietary_tags</code>/<code>allergens</code>, <code>contacts</code> (r√©servation)</td></tr>
                <tr><td><code>FMA</code></td><td>Festival / Manifestation</td><td>√âv√©nements</td><td><code>fma</code> & <code>fma_occurrences</code> (dates/horaires), <code>location</code>, ticket/prix, <code>descriptions</code>/<code>media</code></td></tr>
                <tr><td><code>ITI</code></td><td>Itin√©raire</td><td>Parcours & trac√©s</td><td><code>itinerary</code> (distance, dur√©e, difficult√©, d√©nivel√©), <code>itinerary_details</code> (info, parking, √©quipement), <code>track</code> (KML/GPX), √©tapes</td></tr>
                <tr><td><code>VIL</code></td><td>Village</td><td>Entit√© territoriale</td><td><code>location</code>/<code>descriptions</code> (pourquoi visiter), <code>environment_tags</code> (plage, montagne, patrimoine), <code>relations</code> (POI proches)</td></tr>
                <tr><td><code>PCU</code></td><td>Point culture urbaine</td><td>Arts, expositions</td><td><code>location</code>, <code>descriptions</code> (expo/th√®me), <code>opening_times</code>, <code>media</code></td></tr>
                <tr><td><code>PNA</code></td><td>Point nature aventure</td><td>Randonn√©e, outdoor</td><td><code>location</code> (d√©part/spot), <code>descriptions</code> (activit√©, consignes), <code>opening_times</code>, <code>amenities</code> (parking, eau)</td></tr>
                <tr><td><code>ASC</code></td><td>Association</td><td>Structure associative</td><td><code>contacts</code> (participation/adh√©sion), <code>descriptions</code>, <code>opening_times</code> (accueil), <code>location</code></td></tr>
                <tr><td><code>COM</code></td><td>Commerce</td><td>Boutique / retail</td><td><code>opening_times</code>, <code>amenities</code> (accessibilit√©, parking), <code>classifications</code>/<code>tags</code> (retail), <code>payment_methods</code></td></tr>
                <tr><td><code>PSV</code></td><td>Service public</td><td>Toilettes publiques, eau potable, bornes EV</td><td><code>opening_times</code> (24/7 ou horaires), type (<code>public_toilets</code>/<code>drinking_water</code>/<code>electric_charging</code>), accessibilit√©, co√ªt</td></tr>
                <tr><td><code>RVA</code></td><td>Aire camping‚Äëcar</td><td>Aire de stationnement vans/camping‚Äëcars</td><td><code>capacity</code> (v√©hicules, camping-cars, emplacements), <code>amenities</code> (√©lectricit√©, eau, vidange), <code>opening_times</code>/<code>stay_limits</code>, tarifs</td></tr>
              </tbody>
            </table>
            <p class="inline-help">Exemples‚Äâ: <code>"p_types": ["PSV"]</code> pour lister uniquement les services publics ‚Ä¢ <code>"p_types": ["RVA","CAMP"]</code> pour aires et campings.</p>
          </div>
        </details>
      </section>

      <!-- 2) Endpoints -->
      <section class="card" id="endpoints">
        <h2>2) Endpoints</h2>

        <div class="card" id="postman-collection" style="background: linear-gradient(135deg, rgba(118,176,151,.1), rgba(118,176,151,.05)); border: 1px solid rgba(118,176,151,.2); margin-bottom: 24px;">
          <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
            <div style="background: rgba(118,176,151,.15); padding: 8px; border-radius: 12px; color: var(--brand-700); font-size: 20px;">üöÄ</div>
            <h3 style="margin: 0; color: var(--brand-700);">Collection Postman disponible</h3>
          </div>
          <p style="margin-bottom: 16px; color: var(--text);">Testez l'API directement avec notre collection Postman compl√®te, incluant tous les endpoints, exemples et tests automatiques.</p>
          <div style="display: flex; align-items: center; gap: 12px; flex-wrap: wrap;">
            <a href="https://www.postman.com/docking-module-astronaut-45890211/oti-du-sud-bertel-v3/collection/61gyd5k/bertel-api-v3-0?action=share&creator=24615556" 
               target="_blank" 
               style="background: var(--brand); color: white; padding: 12px 20px; border-radius: 12px; text-decoration: none; font-weight: 600; display: inline-flex; align-items: center; gap: 8px; transition: all 0.3s ease; box-shadow: 0 4px 12px rgba(118,176,151,.3);">
              <span>üì¶</span>
              Ouvrir dans Postman
            </a>
            <div style="font-size: 14px; color: var(--muted); display: flex; align-items: center; gap: 6px;">
              <span>‚ú®</span>
              <span>Collection publique ‚Ä¢ Tests automatiques ‚Ä¢ Variables d'environnement</span>
            </div>
          </div>
        </div>

        <!-- 2.1 get_object_resource -->
        <details open id="get_object_resource">
          <summary>2.1 R√©cup√©rer une ressource : <code>get_object_resource</code></summary>
          <div class="content">
            <p><b>But</b> ‚Äî Obtenir toutes les donn√©es d‚Äôun objet (et, si demand√©, son trac√© <b>KML/GPX</b> pour un itin√©raire).</p>

            <h3>Param√®tres (JSON)</h3>
            <table>
              <thead><tr><th>Param√®tre</th><th>Type</th><th>Obligatoire</th><th>D√©faut</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>p_object_id</code></td><td><code>string</code></td><td>‚úÖ</td><td>‚Äî</td><td>Identifiant de la ressource √† lire.</td></tr>
                <tr><td><code>p_lang_prefs</code></td><td><code>array&lt;string&gt;</code></td><td>‚ùå</td><td><code>["fr"]</code></td><td>Pr√©f√©rences de langue (ordre de priorit√©).</td></tr>
                <tr><td><code>p_track_format</code></td><td><code>enum</code> <code>"none" | "kml" | "gpx"</code></td><td>‚ùå</td><td><code>"none"</code></td><td>Trac√© : par d√©faut aucun. Mettez <code>"kml"</code> ou <code>"gpx"</code> (type ITI).</td></tr>
                <tr><td><code>p_options</code></td><td><code>object</code></td><td>‚ùå</td><td><code>{}</code></td><td>Options avanc√©es (voir d√©tails ci-dessous).</td></tr>
              </tbody>
            </table>

            <details>
              <summary><b>p_options</b> ‚Äî options avanc√©es</summary>
              <div class="content">
                <table>
                  <thead><tr><th>Option</th><th>Type</th><th>D√©faut</th><th>Description</th></tr></thead>
                  <tbody>
                    <tr><td><code>include_stages</code></td><td><code>boolean</code></td><td><code>true</code></td><td>Inclure les √©tapes dans le trac√© KML/GPX.</td></tr>
                    <tr><td><code>stage_color</code></td><td><code>string</code></td><td><code>"red"</code></td><td>Couleur des √©tapes (KML uniquement).</td></tr>
                    <tr><td><code>render</code></td><td><code>boolean</code></td><td><code>true</code></td><td>G√©n√©rer le bloc <code>render</code> avec donn√©es format√©es.</td></tr>
                    <tr><td><code>render_locale</code></td><td><code>string</code></td><td><code>auto</code></td><td>Locale pour le formatage (ex. "fr-FR").</td></tr>
                    <tr><td><code>render_tz</code></td><td><code>string</code></td><td><code>"UTC"</code></td><td>Fuseau horaire pour le formatage.</td></tr>
                    <tr><td><code>render_version</code></td><td><code>string</code></td><td><code>"1.0"</code></td><td>Version du formatage.</td></tr>
                    <tr><td><code>fields</code></td><td><code>array&lt;string&gt;</code></td><td><code>null</code></td><td>Limiter les champs retourn√©s (ex. ["id", "name", "contacts"]).</td></tr>
                    <tr><td><code>include</code></td><td><code>array&lt;string&gt;</code></td><td><code>null</code></td><td>Inclure des blocs optionnels (ex. ["render", "actors"]).</td></tr>
                    <tr><td><code>org_object_id</code></td><td><code>string</code></td><td><code>auto</code></td><td>Pr√©f√©rence d'organisation pour les descriptions.</td></tr>
                    <tr><td><code>include_private</code></td><td><code>boolean</code></td><td><code>false</code></td><td>Inclure les donn√©es priv√©es (n√©cessite permissions).</td></tr>
                  </tbody>
                </table>
                <div class="card tip-card" style="margin-top: 16px;">
                  <div class="pill tip-pill">Exemple</div>
                  <pre style="background: var(--code-bg); color: var(--code); padding: 12px; border-radius: 8px; margin: 8px 0; overflow-x: auto;"><code>{
  "p_object_id": "HOT123",
  "p_lang_prefs": ["fr", "en"],
  "p_track_format": "kml",
  "p_options": {
    "include_stages": true,
    "stage_color": "blue",
    "render": true,
    "render_locale": "fr-FR",
    "fields": ["id", "name", "contacts", "media"],
    "org_object_id": "ORG456"
  }
}</code></pre>
                </div>
              </div>
            </details>

            <details>
              <summary>Important (trac√© ITI)</summary>
              <div class="content">
                <ul>
                  <li>Par d√©faut : <code>p_track_format = "none"</code> ‚Üí aucun trac√© dans la r√©ponse.</li>
                  <li>Si <code>"kml"</code> ou <code>"gpx"</code> :
                    <ul>
                      <li><code>include_stages</code> contr√¥le l‚Äôajout des √©tapes.</li>
                      <li><b>KML</b> : si <code>include_stages=true</code>, vous pouvez r√©gler <code>stage_color</code> (ex. <code>"red"</code>, <code>"blue"</code>, <code>"green"</code>, <code>"orange"</code>, <code>"purple"</code>, <code>"black"</code>, <code>"white"</code>, <code>"yellow"</code>, <code>"cyan"</code>, <code>"magenta"</code>, <code>"gray"</code>, <code>#RRGGBB</code> ou <code>AABBGGRR</code>).</li>
                      <li><b>GPX</b> : <code>stage_color</code> est ignor√© (waypoints ‚ÄúFlag, Red‚Äù).</li>
                    </ul>
                  </li>
                </ul>
              </div>
            </details>

            <h3>Exemples d‚Äôappel</h3>
            <div class="code-tabs" data-tabs>
              <div class="tab-bar">
                <button class="active" data-tab="curl">cURL</button>
                <button data-tab="js">JavaScript (fetch)</button>
              </div>
              <div class="tab-panel active" data-panel="curl">
                <button class="copy copy-floating" data-copy="#ex-gor-curl">Copier</button>
<pre id="ex-gor-curl">curl -X POST "{BASE_URL}/rpc/get_object_resource" \
  -H "Content-Type: application/json" \
  -H "Accept: application/json" \
  -H "apikey: {SUPABASE_ANON_KEY}" \
  -H "Authorization: Bearer {SUPABASE_ANON_KEY}" \
  -d '{
    "p_object_id": "ITI123",
    "p_lang_prefs": ["fr","en"],
    "p_track_format": "kml",
    "p_options": { "include_stages": true, "stage_color": "blue" }
  }'</pre>
              </div>
              <div class="tab-panel" data-panel="js">
                <button class="copy copy-floating" data-copy="#ex-gor-js">Copier</button>
<pre id="ex-gor-js">const res = await fetch(`${BASE_URL}/rpc/get_object_resource`, {
  method: "POST",
  headers: {
    "Content-Type": "application/json",
    "Accept": "application/json",
    "apikey": SUPABASE_ANON_KEY,
    "Authorization": `Bearer ${SUPABASE_ANON_KEY}`
  },
  body: JSON.stringify({
    p_object_id: "ITI123",
    p_lang_prefs: ["fr","en"],
    p_track_format: "none" // pas de trac√© par d√©faut
  })
});
const json = await res.json();</pre>
              </div>
            </div>
          </div>
        </details>

        <!-- 2.2 list_object_resources_page -->
        <details id="list_object_resources_page">
          <summary>2.2 Lister (pagination page/offset) : <code>list_object_resources_page</code></summary>
          <div class="content">
            <p><b>But</b> ‚Äî Lister des ressources avec pagination simple (offset/page), filtr√©es par type, statut, recherche. <b class="badge">Par d√©faut, pas de trac√©</b>.</p>
            <h3>Param√®tres (JSON)</h3>
            <table>
              <thead><tr><th>Param√®tre</th><th>Type</th><th>Obligatoire</th><th>D√©faut</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>p_cursor</code></td><td><code>string</code></td><td>‚ùå</td><td><code>null</code></td><td>Curseur opaque renvoy√© par l‚Äôappel pr√©c√©dent.</td></tr>
                <tr><td><code>p_lang_prefs</code></td><td><code>array&lt;string&gt;</code></td><td>‚ùå</td><td><code>["fr"]</code></td><td>Pr√©f√©rences de langue.</td></tr>
                <tr><td><code>p_page_size</code></td><td><code>number</code></td><td>‚ùå</td><td><code>50</code></td><td>1 √† 200.</td></tr>
                <tr><td><code>p_types</code></td><td><code>array&lt;enum&gt;</code></td><td>‚ùå</td><td><code>null</code></td><td>Restreindre aux types demand√©s (ex. <code>["ITI"]</code>).</td></tr>
                <tr><td><code>p_status</code></td><td><code>array&lt;enum&gt;</code></td><td>‚ùå</td><td><code>["published"]</code></td><td>Statuts accept√©s.</td></tr>
                <tr><td><code>p_search</code></td><td><code>string</code></td><td>‚ùå</td><td><code>null</code></td><td>Terme de recherche (nom normalis√© ; insensible aux accents & casse).</td></tr>
                <tr><td><code>p_track_format</code></td><td><code>"none" | "kml" | "gpx"</code></td><td>‚ùå</td><td><code>"none"</code></td><td></td></tr>
                <tr><td><code>p_include_stages</code></td><td><code>boolean</code></td><td>‚ùå</td><td><code>null</code></td><td>Si vous demandez un trac√© KML/GPX, inclure les √©tapes ?</td></tr>
                <tr><td><code>p_stage_color</code></td><td><code>string</code></td><td>‚ùå</td><td><code>null</code></td><td>Couleur des √©tapes (KML uniquement) si <code>include_stages=true</code>.</td></tr>
                <tr><td><code>p_omit_empty</code></td><td><code>boolean</code></td><td>‚ùå</td><td><code>false</code></td><td>Supprimer les tableaux/objets vides du niveau sup√©rieur (ex. <code>actors</code>, <code>legal_records</code>, <code>meeting_rooms</code>).</td></tr>
              </tbody>
            </table>

            <h3>R√©ponse</h3>
<pre>{
  "info": {
    "kind": "page",
    "language": "fr",
    "language_fallbacks": ["fr","en"],
    "page_size": 50,
    "offset": 0,
    "total": 1234,
    "cursor": "&lt;opaque&gt;",
    "next_cursor": "&lt;opaque or null&gt;"
  },
  "data": [ /* ressources */ ]
}</pre>

            <h3>Flux d‚Äôusage</h3>
            <ol>
              <li>Premier appel sans <code>p_cursor</code>.</li>
              <li>Lisez <code>info.next_cursor</code>.</li>
              <li>Rappelez en passant <code>p_cursor</code> pour la page suivante, etc.</li>
            </ol>

            <h3>Exemple (cURL)</h3>
            <div style="position:relative;">
              <button class="copy copy-floating" data-copy="#ex-page-curl">Copier</button>
<pre id="ex-page-curl">curl -X POST "{BASE_URL}/rpc/list_object_resources_page" \
  -H "Content-Type: application/json" \
  -H "Accept: application/json" \
  -H "apikey: {SUPABASE_ANON_KEY}" \
  -H "Authorization: Bearer {SUPABASE_ANON_KEY}" \
  -d '{
    "p_page_size": 20,
    "p_types": ["ITI"],
    "p_status": ["published"],
    "p_search": "cr√™tes",
    "p_track_format": "none"
  }'</pre>
            </div>

            <h3>Mode de nettoyage (omit_empty)</h3>
            <p>Le param√®tre <code>p_omit_empty</code> permet de r√©duire la taille des r√©ponses en supprimant automatiquement les blocs de donn√©es vides au niveau sup√©rieur de chaque ressource.</p>
            
            <h4>Comment l'utiliser</h4>
            <p>Passez <code>p_omit_empty: true</code> dans l'endpoint de pagination :</p>
            <div style="position:relative;">
              <button class="copy copy-floating" data-copy="#ex-omit-empty">Copier</button>
<pre id="ex-omit-empty">curl -X POST "{BASE_URL}/rpc/list_object_resources_page" \
  -H "Content-Type: application/json" \
  -H "Accept: application/json" \
  -H "apikey: {SUPABASE_ANON_KEY}" \
  -H "Authorization: Bearer {SUPABASE_ANON_KEY}" \
  -d '{
    "p_page_size": 2,
    "p_omit_empty": true
  }'</pre>
            </div>
            
            <p>Le param√®tre est √©galement pr√©serv√© dans le curseur et propag√© automatiquement aux appels suivants.</p>

            <h4>Ce qui est supprim√©</h4>
            <p>Quand <code>omit_empty</code> est activ√©, les blocs suivants sont supprim√©s s'ils sont vides :</p>
            <ul>
              <li><code>actors[]</code> ‚Äî Personnes li√©es √† l'objet</li>
              <li><code>legal_records[]</code> ‚Äî Documents l√©gaux</li>
              <li><code>meeting_rooms[]</code> ‚Äî Salles de r√©union</li>
              <li><code>fma[]</code> ‚Äî √âv√©nements FMA</li>
              <li><code>fma_occurrences[]</code> ‚Äî Occurrences d'√©v√©nements</li>
            </ul>
            
            <p><strong>Note :</strong> Les blocs <code>opening_times</code> et <code>render</code> sont toujours conserv√©s, m√™me s'ils sont vides.</p>
          </div>
        </details>

        <!-- 2.3 since keyset -->
        <details id="list_object_resources_since_fast">
          <summary>2.3 Lister depuis une date (keyset) : <code>list_object_resources_since_fast</code></summary>
          <div class="content">
            <p><b>But</b> ‚Äî Synchroniser <i>ce qui a chang√© depuis un instant T</i> (robuste pendant les mises √† jour).</p>

            <table>
              <thead><tr><th>Param√®tre</th><th>Type</th><th>Obligatoire</th><th>D√©faut</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>p_since</code></td><td><code>timestamp</code></td><td>‚úÖ</td><td>‚Äî</td><td>Point de d√©part (UTC).</td></tr>
                <tr><td><code>p_cursor</code></td><td><code>string</code></td><td>‚ùå</td><td><code>null</code></td><td>Curseur opaque.</td></tr>
                <tr><td><code>p_use_source</code></td><td><code>boolean</code></td><td>‚ùå</td><td><code>false</code></td><td>Utiliser la date de mise √† jour source plut√¥t que technique.</td></tr>
                <tr><td><code>p_lang_prefs</code></td><td><code>array&lt;string&gt;</code></td><td>‚ùå</td><td><code>["fr"]</code></td><td>Pr√©f√©rences de langue.</td></tr>
                <tr><td><code>p_limit</code></td><td><code>number</code></td><td>‚ùå</td><td><code>50</code></td><td>1 √† 200.</td></tr>
                <tr><td><code>p_types / p_status / p_search</code></td><td>‚Äî</td><td>‚ùå</td><td>‚Äî</td><td>Comme ¬ß2.2.</td></tr>
                <tr><td><code>p_track_format / p_include_stages / p_stage_color</code></td><td>‚Äî</td><td>‚ùå</td><td>‚Äî</td><td>Comme ¬ß2.2 (par d√©faut, pas de trac√©).</td></tr>
                <tr><td><code>p_omit_empty</code></td><td><code>boolean</code></td><td>‚ùå</td><td><code>false</code></td><td>Supprimer les tableaux/objets vides du niveau sup√©rieur (ex. <code>actors</code>, <code>legal_records</code>, <code>meeting_rooms</code>).</td></tr>
              </tbody>
            </table>

            <h3>R√©ponse</h3>
<pre>{
  "info": {
    "kind": "since",
    "language": "fr",
    "language_fallbacks": ["fr"],
    "since": "2024-04-01T00:00:00Z",
    "use_source": false,
    "limit": 50,
    "cursor": "&lt;opaque&gt;",
    "next_cursor": "&lt;opaque or null&gt;"
  },
  "data": [ /* ressources modifi√©es/ajout√©es depuis p_since */ ]
}</pre>

            <h3>Flux d‚Äôusage (sync incr√©mentale)</h3>
            <ol>
              <li>Appelez avec votre <code>p_since</code> (ex. derni√®re sync r√©ussie).</li>
              <li>Tant que <code>next_cursor</code> n‚Äôest pas <code>null</code>, cha√Ænez avec <code>p_cursor</code>.</li>
              <li>Enregistrez ensuite un nouveau ‚Äúsince‚Äù (ex. maintenant) pour la prochaine sync.</li>
            </ol>
          </div>
        </details>

        <!-- 2.4 filtered page -->
        <details id="list_object_resources_filtered_page">
          <summary>2.4 Lister avec filtres riches (page/offset) : <code>list_object_resources_filtered_page</code></summary>
          <div class="content">
            <p><b>But</b> ‚Äî M√™me id√©e que ¬ß2.2, mais avec un JSON de filtres riches <code>p_filters</code>.</p>

            <table>
              <thead><tr><th>Param√®tre</th><th>Type</th><th>Obligatoire</th><th>D√©faut</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>p_cursor / p_lang_prefs / p_page_size</code></td><td>‚Äî</td><td>‚ùå</td><td>‚Äî</td><td>Comme ¬ß2.2</td></tr>
                <tr><td><code>p_filters</code></td><td><code>object</code></td><td>‚ùå</td><td><code>{}</code></td><td>Filtres riches (voir ci-dessous).</td></tr>
                <tr><td><code>p_types / p_status / p_search</code></td><td>‚Äî</td><td>‚ùå</td><td>‚Äî</td><td>Comme ¬ß2.2</td></tr>
                <tr><td><code>p_track_format / p_include_stages / p_stage_color</code></td><td>‚Äî</td><td>‚ùå</td><td>‚Äî</td><td>Comme ¬ß2.2</td></tr>
                <tr><td><code>p_omit_empty</code></td><td><code>boolean</code></td><td>‚ùå</td><td><code>false</code></td><td>Supprimer les tableaux/objets vides du niveau sup√©rieur (ex. <code>actors</code>, <code>legal_records</code>, <code>meeting_rooms</code>).</td></tr>
              </tbody>
            </table>

            <details>
              <summary><b>p_filters</b> ‚Äî possibilit√©s & exemples</summary>
              <div class="content">
                <!-- Example in full width -->
                <div class="deck-example">
                  <h4>Exemple d'utilisation</h4>
                  <div style="position:relative;">
                    <button class="copy copy-floating" data-copy="#filters-example">Copier</button>
<pre id="filters-example">{
  "amenities_any": ["PARKING","WIFI"],
  "itinerary": { "is_loop": true, "distance_max_km": 15, "practices_any": ["hiking"] },
  "within_radius": { "lat": 45.76, "lon": 4.84, "radius_m": 20000 },
  "media_types_any": ["image"],
  "media_published_only": true,
  "media_must_have_main": true
}</pre>
                  </div>
                </div>
                
                <!-- Parameters on full width -->
                <div class="deck-parameters">
                  <h4>Param√®tres disponibles</h4>
                  <div class="filters-grid">
                    <div class="filter-category">
                      <h5>√âquipements & Services</h5>
                      <ul>
                        <li><code>amenities_any: string[]</code> ‚Äî au moins un √©quipement</li>
                        <li><code>amenities_all: string[]</code> ‚Äî tous ces √©quipements</li>
                        <li><code>amenity_families_any: string[]</code> ‚Äî au moins une famille</li>
                        <li><code>pet_accepted: boolean</code> ‚Äî animaux accept√©s</li>
                      <li><code>payment_methods_any: string[]</code></li>
                      <li><code>environment_tags_any: string[]</code></li>
                      <li><code>languages_any: string[]</code></li>
                      </ul>
                    </div>
                    
                    <div class="filter-category">
                      <h5>M√©dias</h5>
                      <ul>
                      <li><code>media_types_any: string[]</code> ‚Äî ex. <code>["image","video"]</code></li>
                      <li><code>media_published_only: boolean</code></li>
                      <li><code>media_must_have_main: boolean</code></li>
                      </ul>
                    </div>
                    
                    <div class="filter-category">
                      <h5>Capacit√© & Classement</h5>
                      <ul>
                      <li><code>capacity_filters: [{ code, min?, max? }]</code></li>
                      <li><code>classifications_any: [{ scheme_code, value_code }]</code></li>
                        <li><code>tags_any: string[]</code> ‚Äî slugs</li>
                        <li><code>meeting_room</code> : { <i>min_count, min_area_m2, min_cap_theatre, min_cap_u, min_cap_classroom, min_cap_boardroom, equipment_any, equipment_all</i> }</li>
                      </ul>
                    </div>
                    
                    <div class="filter-category">
                      <h5>G√©olocalisation</h5>
                      <ul>
                      <li><code>within_radius</code> : { <i>lat, lon, radius_m</i> }</li>
                      <li><code>bbox</code> : [minLon, minLat, maxLon, maxLat] (WGS84)</li>
                    </ul>
                  </div>
                    
                    <div class="filter-category">
                      <h5>Itin√©raires</h5>
                      <ul>
                        <li><code>itinerary</code> : { <i>is_loop, difficulty_min/max, distance_min/max_km, duration_min/max_h, practices_any[]</i> }</li>
                      </ul>
                    </div>
                    
                    <div class="filter-category">
                      <h5>Disponibilit√©</h5>
                      <ul>
                        <li><code>open_now: boolean</code> ‚Äî ouvert "maintenant"</li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </details>
          </div>
        </details>

        <!-- 2.5 filtered since -->
        <details id="list_object_resources_filtered_since_fast">
          <summary>2.5 Filtres + depuis une date (keyset) : <code>list_object_resources_filtered_since_fast</code></summary>
          <div class="content">
            <p><b>But</b> ‚Äî La combinaison de ¬ß2.3 (since/keyset) et ¬ß2.4 (filtres riches).</p>
            <table>
              <thead><tr><th>Param√®tre</th><th>Type</th><th>Oblig.</th><th>D√©faut</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>p_since</code></td><td><code>timestamp</code></td><td>‚úÖ</td><td>‚Äî</td><td>Point de d√©part (UTC).</td></tr>
                <tr><td><code>p_cursor</code></td><td><code>string</code></td><td>‚ùå</td><td><code>null</code></td><td>Curseur opaque.</td></tr>
                <tr><td><code>p_use_source</code></td><td><code>boolean</code></td><td>‚ùå</td><td><code>false</code></td><td>Comme ¬ß2.3.</td></tr>
                <tr><td><code>p_lang_prefs</code></td><td><code>array&lt;string&gt;</code></td><td>‚ùå</td><td><code>["fr"]</code></td><td>‚Äî</td></tr>
                <tr><td><code>p_limit</code></td><td><code>number</code></td><td>‚ùå</td><td><code>50</code></td><td>1 √† 200.</td></tr>
                <tr><td><code>p_filters</code></td><td><code>object</code></td><td>‚ùå</td><td><code>{}</code></td><td>Comme ¬ß2.4.</td></tr>
                <tr><td><code>p_types / p_status / p_search</code></td><td>‚Äî</td><td>‚ùå</td><td>‚Äî</td><td>‚Äî</td></tr>
                <tr><td><code>p_track_format / p_include_stages / p_stage_color</code></td><td>‚Äî</td><td>‚ùå</td><td>‚Äî</td><td>‚Äî</td></tr>
              </tbody>
            </table>
            <p>R√©ponse : m√™me forme que ¬ß2.3, avec <code>filters</code> propag√©s dans le curseur.</p>
          </div>
        </details>

        <!-- 2.6 Deep Data Functions -->
        <details id="deep_data_functions">
          <summary>2.6 Fonctions Deep Data : donn√©es enrichies en un appel</summary>
          <div class="content">
            <p><b>But</b> ‚Äî R√©cup√©rer des objets avec leurs donn√©es en profondeur : objets parents, acteurs, organisations et contacts associ√©s. Id√©al pour les applications n√©cessitant des informations compl√®tes.</p>

            <div class="card tip-card" style="margin-bottom: 20px;">
              <div class="pill tip-pill">Nouveau</div>
              <p class="lead tip-text">Ces fonctions incluent automatiquement les donn√©es des objets li√©s, √©vitant les appels multiples pour obtenir une vue compl√®te.</p>
            </div>

            <h3>2.6.1 R√©cup√©rer un objet avec Deep Data : <code>get_object_with_deep_data</code></h3>
            <table>
              <thead><tr><th>Param√®tre</th><th>Type</th><th>Obligatoire</th><th>D√©faut</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>p_object_id</code></td><td><code>string</code></td><td>‚úÖ</td><td>‚Äî</td><td>Identifiant de l'objet √† r√©cup√©rer.</td></tr>
              </tbody>
            </table>

            <h3>2.6.2 R√©cup√©rer plusieurs objets avec Deep Data : <code>get_objects_with_deep_data</code></h3>
            <table>
              <thead><tr><th>Param√®tre</th><th>Type</th><th>Obligatoire</th><th>D√©faut</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>p_object_ids</code></td><td><code>array&lt;string&gt;</code></td><td>‚úÖ</td><td>‚Äî</td><td>Liste des identifiants d'objets.</td></tr>
                <tr><td><code>p_languages</code></td><td><code>array&lt;string&gt;</code></td><td>‚ùå</td><td><code>["fr"]</code></td><td>Pr√©f√©rences de langue.</td></tr>
                <tr><td><code>p_include_media</code></td><td><code>string</code></td><td>‚ùå</td><td><code>"none"</code></td><td>Inclusion des m√©dias : "none", "basic", "full".</td></tr>
                <tr><td><code>p_filters</code></td><td><code>object</code></td><td>‚ùå</td><td><code>{}</code></td><td>Filtres optionnels.</td></tr>
              </tbody>
            </table>

            <h3>2.6.3 Lister par type avec Deep Data : <code>get_objects_by_type_with_deep_data</code></h3>
            <table>
              <thead><tr><th>Param√®tre</th><th>Type</th><th>Obligatoire</th><th>D√©faut</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>p_object_type</code></td><td><code>string</code></td><td>‚úÖ</td><td>‚Äî</td><td>Type d'objet ("HOT", "ORG", "RES", etc.).</td></tr>
                <tr><td><code>p_languages</code></td><td><code>array&lt;string&gt;</code></td><td>‚ùå</td><td><code>["fr"]</code></td><td>Pr√©f√©rences de langue.</td></tr>
                <tr><td><code>p_include_media</code></td><td><code>string</code></td><td>‚ùå</td><td><code>"none"</code></td><td>Inclusion des m√©dias.</td></tr>
                <tr><td><code>p_filters</code></td><td><code>object</code></td><td>‚ùå</td><td><code>{}</code></td><td>Filtres optionnels.</td></tr>
                <tr><td><code>p_limit</code></td><td><code>number</code></td><td>‚ùå</td><td><code>100</code></td><td>Nombre maximum d'objets.</td></tr>
                <tr><td><code>p_offset</code></td><td><code>number</code></td><td>‚ùå</td><td><code>0</code></td><td>D√©calage pour la pagination.</td></tr>
              </tbody>
            </table>

            <h3>2.6.4 Rechercher avec Deep Data : <code>search_objects_with_deep_data</code></h3>
            <table>
              <thead><tr><th>Param√®tre</th><th>Type</th><th>Obligatoire</th><th>D√©faut</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>p_search_term</code></td><td><code>string</code></td><td>‚úÖ</td><td>‚Äî</td><td>Terme de recherche.</td></tr>
                <tr><td><code>p_object_types</code></td><td><code>array&lt;string&gt;</code></td><td>‚ùå</td><td><code>null</code></td><td>Types d'objets √† inclure (null = tous).</td></tr>
                <tr><td><code>p_languages</code></td><td><code>array&lt;string&gt;</code></td><td>‚ùå</td><td><code>["fr"]</code></td><td>Pr√©f√©rences de langue.</td></tr>
                <tr><td><code>p_include_media</code></td><td><code>string</code></td><td>‚ùå</td><td><code>"none"</code></td><td>Inclusion des m√©dias.</td></tr>
                <tr><td><code>p_filters</code></td><td><code>object</code></td><td>‚ùå</td><td><code>{}</code></td><td>Filtres optionnels.</td></tr>
                <tr><td><code>p_limit</code></td><td><code>number</code></td><td>‚ùå</td><td><code>50</code></td><td>Nombre maximum d'objets.</td></tr>
                <tr><td><code>p_offset</code></td><td><code>number</code></td><td>‚ùå</td><td><code>0</code></td><td>D√©calage pour la pagination.</td></tr>
              </tbody>
            </table>

            <h3>2.6.5 Recherche sp√©cialis√©e restaurants : <code>search_restaurants_by_cuisine</code></h3>
            <table>
              <thead><tr><th>Param√®tre</th><th>Type</th><th>Obligatoire</th><th>D√©faut</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>p_cuisine_types</code></td><td><code>array&lt;string&gt;</code></td><td>‚úÖ</td><td>‚Äî</td><td>Types de cuisine recherch√©s (ex. ["local", "veggie"]).</td></tr>
                <tr><td><code>p_languages</code></td><td><code>array&lt;string&gt;</code></td><td>‚ùå</td><td><code>["fr"]</code></td><td>Pr√©f√©rences de langue.</td></tr>
                <tr><td><code>p_limit</code></td><td><code>number</code></td><td>‚ùå</td><td><code>50</code></td><td>Nombre maximum de r√©sultats.</td></tr>
                <tr><td><code>p_offset</code></td><td><code>number</code></td><td>‚ùå</td><td><code>0</code></td><td>D√©calage pour la pagination.</td></tr>
              </tbody>
            </table>

            <h3>2.6.6 Recherche √©v√©nements par cuisine : <code>search_events_by_restaurant_cuisine</code></h3>
            <table>
              <thead><tr><th>Param√®tre</th><th>Type</th><th>Obligatoire</th><th>D√©faut</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>p_cuisine_types</code></td><td><code>array&lt;string&gt;</code></td><td>‚úÖ</td><td>‚Äî</td><td>Types de cuisine des restaurants associ√©s.</td></tr>
                <tr><td><code>p_languages</code></td><td><code>array&lt;string&gt;</code></td><td>‚ùå</td><td><code>["fr"]</code></td><td>Pr√©f√©rences de langue.</td></tr>
                <tr><td><code>p_limit</code></td><td><code>number</code></td><td>‚ùå</td><td><code>50</code></td><td>Nombre maximum de r√©sultats.</td></tr>
                <tr><td><code>p_offset</code></td><td><code>number</code></td><td>‚ùå</td><td><code>0</code></td><td>D√©calage pour la pagination.</td></tr>
              </tbody>
            </table>

            <h3>Structure de r√©ponse Deep Data</h3>
            <p>Les fonctions Deep Data retournent une structure enrichie :</p>
            <pre>{
  "object": {
    // Donn√©es compl√®tes de l'objet principal (comme get_object_resource)
    "id": "HOT123",
    "name": "H√¥tel Example",
    "type": "HOT",
    "contacts": [...],
    "media": [...],
    // ... toutes les autres donn√©es de l'objet
  },
  "parent_objects": [
    {
      "id": "ORG456",
      "type": "ORG", 
      "name": "Organisation Parent",
      "status": "published",
      "relation_type": {
        "id": "uuid-relation-type",
        "name": "Gestionnaire"
      },
      "distance_m": 100,
      "note": "Relation de gestion",
      "basic_info": {
        "id": "ORG456",
        "type": "ORG",
        "name": "Organisation Parent",
        "status": "published"
      }
    }
  ],
  "actors": [
    {
      "id": "actor-uuid",
      "display_name": "Jean Dupont",
      "first_name": "Jean",
      "last_name": "Dupont",
      "role": {
        "id": "role-uuid",
        "code": "manager",
        "name": "Gestionnaire"
      },
      "is_primary": true,
      "valid_from": "2024-01-01",
      "valid_to": "2024-12-31",
      "contacts": [...]
    }
  ],
  "organizations": [
    {
      "id": "ORG789",
      "type": "ORG",
      "name": "Agence de Conciergerie",
      "status": "published",
      "role": {
        "id": "org-role-uuid",
        "code": "concierge",
        "name": "Conciergerie"
      },
      "contacts": [...]
    }
  ]
}</pre>
          </div>
        </details>
      </section>

      <!-- 3) Dictionnaire de donn√©es -->
      <section class="card" id="dictionary">
        <h2>3) Dictionnaire de donn√©es : contenu d‚Äôune ressource</h2>

        <p>Une ressource (un √©l√©ment de <code>data[]</code>) est un objet JSON avec des blocs th√©matiques. Tous les blocs ne sont pas pr√©sents pour tous les objets.</p>

        <details open id="data-architecture">
          <summary>3.0 Architecture des donn√©es (coulisses PostgreSQL)</summary>
          <div class="content">
            <p>Chaque r√©ponse de l‚ÄôAPI provient d‚Äôun mod√®le relationnel unifi√©. Les blocs ci-dessous sont assembl√©s √† partir des tables et vues principales&nbsp;:</p>
            <ul>
              <li><strong>Objets touristiques</strong> <code>object</code> ‚Äî entit√© c≈ìur pour tous les types (h√©bergements, itin√©raires, √©v√©nements, etc.) avec les m√©tadonn√©es communes (statut, dates de publication, indicateurs d‚Äô√©dition en cours).</li>
              <li><strong>Localisation unifi√©e</strong> <code>object_location</code> ‚Äî regroupe adresse postale, coordonn√©es g√©ographiques et rattachements territoriaux via <code>object_zone</code>.</li>
              <li><strong>Contenus multilingues</strong> <code>object_description</code> et colonnes <code>*_i18n</code> ‚Äî textes publics, chap√¥s, infos mobiles stock√©s soit en JSONB, soit via la table g√©n√©rique <code>i18n_translation</code> expos√©e dans les vues <code>api.*</code>.</li>
              <li><strong>Contacts &amp; m√©dias</strong> <code>object_contact</code>, <code>media</code> ‚Äî t√©l√©phones, e-mails, r√©seaux sociaux et ressources m√©dias, y compris les m√©dias sp√©cifiques √† un lieu via <code>media.place_id</code>.</li>
              <li><strong>R√©f√©rentiels</strong> <code>ref_code</code>, <code>ref_classification_scheme</code>, <code>ref_classification_value</code> ‚Äî types, labels, classements et tags reli√©s aux objets par <code>object_classification</code> et <code>object_capacity</code>.</li>
              <li><strong>Accessibilit√© &amp; labels handicap</strong> ‚Äî entr√©es <code>object_classification</code> avec <code>scheme_code = "HANDICAP_LABEL"</code>, valeurs et sous-valeurs (<code>subvalue_ids</code>) pour chaque handicap couvert (moteur, visuel, auditif, mental), justificatifs optionnels via <code>ref_document</code>.</li>
              <li><strong>Horaires d‚Äôouverture</strong> <code>opening_period</code>, <code>opening_schedule</code>, <code>opening_time_period</code> ‚Äî structure hi√©rarchique permettant de d√©crire des plages complexes et leurs exceptions.</li>
              <li><strong>Mod√©ration</strong> <code>pending_change</code>, <code>object_version</code> ‚Äî suivi des propositions de modification et historisation avant/apr√®s pour audit.</li>
              <li><strong>API JSON</strong> ‚Äî vues et fonctions du sch√©ma <code>api</code> (ex. <code>api.v_hot</code>, <code>api.v_objects</code>, <code>api.v_needed</code>, <code>api.get_object_resource</code>) qui orchestrent les blocs ci-dessus.</li>
            </ul>
            <p>Les sections du dictionnaire (¬ß3.x) d√©crivent comment ces blocs sont agr√©g√©s pour produire chaque champ. Pour une vision exhaustive, consultez le sch√©ma SQL&nbsp;: <a href="../Base%20de%20donn%C3%A9e%20DLL%20et%20API/schema_unified.sql">schema_unified.sql</a>.</p>
          </div>
        </details>

        <details open>
          <summary>3.1 Vue d‚Äôensemble</summary>
          <div class="content">
            <table>
              <thead><tr><th>Bloc</th><th>Type</th><th>√Ä quoi √ßa sert</th><th>Exemple</th></tr></thead>
              <tbody>
                <tr><td><code>id</code></td><td><code>string</code></td><td>Identifiant unique m√©tier</td><td><code>"OBJ_000123"</code></td></tr>
                <tr><td><code>type</code></td><td><code>enum</code></td><td>Type d‚Äôobjet (ex. itin√©raire)</td><td><code>"ITI"</code></td></tr>
                <tr><td><code>status</code></td><td><code>enum</code></td><td>Statut de publication</td><td><code>"published"</code></td></tr>
                <tr><td><code>name</code></td><td><code>string</code></td><td>Nom affich√©</td><td><code>"Boucle des Cr√™tes"</code></td></tr>
                <tr><td><code>region_code</code></td><td><code>string</code></td><td>Code r√©gion/source m√©tier</td><td><code>"FR-ARA"</code></td></tr>
                <tr><td><code>created_at / updated_at / updated_at_source / published_at</code></td><td><code>timestamp</code></td><td>Suivi de vie (technique + source amont)</td><td><code>"2024-03-18T09:30:00Z"</code></td></tr>
                <tr><td><code>address</code></td><td><code>object</code></td><td>Adresse postale (si connue)</td><td><code>{ "street": "...", "city": "..." }</code></td></tr>
                <tr><td><code>location</code></td><td><code>object</code></td><td>Position WGS84</td><td><code>{ "latitude": 45.76, "longitude": 4.84, "altitude_m": 250 }</code></td></tr>
                <tr><td><code>descriptions</code></td><td><code>object</code></td><td>Descriptions multilingues enrichies (description, description_chapo, description_mobile, description_edition, description_offre_hors_zone, sanitary_measures)</td><td>voir ¬ß3.2</td></tr>
                <tr><td><code>external_ids</code></td><td><code>array&lt;object&gt;</code></td><td>Identifiants externes (SIT, DMS‚Ä¶)</td><td><code>[{ "system":"X", "value":"1234" }]</code></td></tr>
                <tr><td><code>contacts</code></td><td><code>array&lt;object&gt;</code></td><td>Moyens de contact enrichis</td><td>voir ¬ß3.3</td></tr>
                <tr><td><code>languages</code></td><td><code>array&lt;object&gt;</code></td><td>Langues parl√©es</td><td><code>[{ "code":"fr", "name":"Fran√ßais" }]</code></td></tr>
                <tr><td><code>media</code></td><td><code>array&lt;object&gt;</code></td><td>M√©dias publi√©s</td><td>voir ¬ß3.5</td></tr>
                <tr><td><code>capacity</code></td><td><code>array&lt;object&gt;</code></td><td>Capacit√©s</td><td>voir ¬ß3.6</td></tr>
                <tr><td><code>amenities</code></td><td><code>array&lt;object&gt;</code></td><td>√âquipements/Services</td><td>voir ¬ß3.7</td></tr>
                <tr><td><code>environment_tags</code></td><td><code>array&lt;object&gt;</code></td><td>Tags environnement (√©co)</td><td>voir ¬ß3.8</td></tr>
                <tr><td><code>payment_methods</code></td><td><code>array&lt;object&gt;</code></td><td>Moyens de paiement</td><td>voir ¬ß3.8</td></tr>
                <tr><td><code>pet_policy</code></td><td><code>object</code></td><td>Politique animaux</td><td><code>{ "accepted": true, ... }</code></td></tr>
                <tr><td><code>prices</code></td><td><code>array&lt;object&gt;</code></td><td>Tarifs (+ p√©riodes)</td><td>voir ¬ß3.9</td></tr>
                <tr><td><code>classifications</code></td><td><code>array&lt;object&gt;</code></td><td>Labels/Classements (√©toiles h√¥tels, certifications, etc.)</td><td>voir ¬ß3.10</td></tr>
                <tr><td><code>handicap_labels</code></td><td><code>array&lt;object&gt;</code></td><td>Labellisation Tourisme &amp; Handicap</td><td>voir ¬ß3.11</td></tr>
                <tr><td><code>tags</code></td><td><code>array&lt;object&gt;</code></td><td>Tags libres</td><td>voir ¬ß3.12</td></tr>
                <tr><td><code>discounts</code></td><td><code>array&lt;object&gt;</code></td><td>R√©ductions et offres sp√©ciales</td><td>voir ¬ß3.23</td></tr>
                <tr><td><code>group_policies</code></td><td><code>array&lt;object&gt;</code></td><td>Politiques de groupe</td><td>voir ¬ß3.24</td></tr>
                <tr><td><code>origins / org_links</code></td><td><code>array&lt;object&gt;</code></td><td>Blocs transparents</td><td>‚Äî</td></tr>
                <tr><td><code>actors</code></td><td><code>array&lt;object&gt;</code></td><td>Acteurs (personnes) li√©s √† l'objet</td><td>voir ¬ß3.25</td></tr>
                <tr><td><code>legal_records</code></td><td><code>array&lt;object&gt;</code></td><td>Enregistrements l√©gaux unifi√©s</td><td>voir ¬ß3.26</td></tr>
                <tr><td><code>meeting_rooms</code></td><td><code>array&lt;object&gt;</code></td><td>Salles de r√©union</td><td>voir ¬ß3.13</td></tr>
                <tr><td><code>fma / fma_occurrences</code></td><td><code>array&lt;object&gt;</code></td><td>Occurrences d'√©v√©nements/activit√©s</td><td>‚Äî</td></tr>
                <tr><td><code>opening_times</code></td><td><code>object</code></td><td>Horaires d'ouverture (structure temporelle)</td><td>voir ¬ß3.14</td></tr>
                <tr><td><code>menus</code></td><td><code>array&lt;object&gt;</code></td><td>Menus (restaurants/√©v√©nements)</td><td>voir ¬ß3.15</td></tr>
                <tr><td><code>places</code></td><td><code>array&lt;object&gt;</code></td><td>Lieux internes</td><td>voir ¬ß3.16</td></tr>
                <tr><td><code>sustainability_action_labels</code></td><td><code>array&lt;object&gt;</code></td><td>Actions RSE + labels</td><td>voir ¬ß3.17</td></tr>
                <tr><td><code>incoming_relations / outgoing_relations</code></td><td><code>array&lt;object&gt;</code></td><td>Relations entrantes/sortantes</td><td>voir ¬ß3.18</td></tr>
                <tr><td><code>render</code></td><td><code>object</code></td><td>Donn√©es format√©es pour l'affichage</td><td>voir ¬ß3.27</td></tr>
                <tr><td><code>legal_records</code></td><td><code>array&lt;object&gt;</code></td><td>Enregistrements l√©gaux et certifications</td><td>voir ¬ß3.26</td></tr>
                <tr><td><code>documents</code></td><td><code>array&lt;object&gt;</code></td><td>Pi√®ces justificatives publiables (r√©f√©rentiel commun)</td><td>voir ¬ß3.21</td></tr>
                <tr><td><code>document_requests</code></td><td><code>array&lt;object&gt;</code></td><td>Suivi des demandes/remises de documents</td><td>voir ¬ß3.22</td></tr>
                <tr><td><code>associated_restaurants_cuisine_types</code> (si <code>type="FMA"</code>)</td><td><code>array&lt;object&gt;</code></td><td>Types de cuisine agr√©g√©s via les restaurants li√©s</td><td>voir ¬ß3.20</td></tr>
                <tr><td><code>itinerary_details</code> (si <code>type="ITI"</code>)</td><td><code>object</code></td><td>D√©tails ITI</td><td>voir ¬ß3.19</td></tr>
                <tr><td><code>itinerary</code> (si <code>type="ITI"</code>)</td><td><code>object</code></td><td>R√©sum√© ITI (+ track si demand√©)</td><td>voir ¬ß3.19</td></tr>
              </tbody>
            </table>
          </div>
        </details>

        <details>
          <summary>3.2 <code>descriptions</code> (descriptions multilingues enrichies)</summary>
          <div class="content">
            <p>Bloc contenant toutes les descriptions multilingues de l'objet, avec support pour diff√©rents contextes d'affichage et mesures sanitaires.</p>
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th><th>Exemple</th></tr></thead>
              <tbody>
                <tr><td><code>description</code></td><td><code>string</code></td><td>Description principale multilingue</td><td><code>"Restaurant gastronomique avec vue sur mer..."</code></td></tr>
                <tr><td><code>description_chapo</code></td><td><code>string</code></td><td>Chap√¥/accroche multilingue</td><td><code>"Une exp√©rience culinaire unique..."</code></td></tr>
                <tr><td><code>description_mobile</code></td><td><code>string</code></td><td>Description optimis√©e pour mobile</td><td><code>"Resto vue mer, sp√©cialit√©s locales"</code></td></tr>
                <tr><td><code>description_edition</code></td><td><code>string</code></td><td>Description pour √©dition papier</td><td><code>"√âtablissement familial depuis 1950..."</code></td></tr>
                <tr><td><code>description_offre_hors_zone</code></td><td><code>string</code></td><td>Description pour offres hors zone g√©ographique</td><td><code>"D√©couvrez nos sp√©cialit√©s cr√©oles..."</code></td></tr>
                <tr><td><code>sanitary_measures</code></td><td><code>string</code></td><td>Mesures sanitaires et protocoles</td><td><code>"Gel hydroalcoolique disponible, masques fournis"</code></td></tr>
              </tbody>
            </table>
            <div class="card tip-card" style="margin-top: 16px;">
              <div class="pill tip-pill">Multilingue</div>
              <p>Tous les champs de description supportent la gestion multilingue via les param√®tres <code>p_lang_prefs</code> de l'API. La langue de fallback est le fran√ßais.</p>
            </div>
            <div class="card info-card" style="margin-top: 16px;">
              <div class="pill info-pill">Contexte</div>
              <p><strong>description_mobile</strong> : Version courte pour affichage mobile<br/>
              <strong>description_edition</strong> : Version pour supports imprim√©s<br/>
              <strong>description_offre_hors_zone</strong> : Version pour communication externe<br/>
              <strong>sanitary_measures</strong> : Informations sanitaires obligatoires</p>
            </div>
          </div>
        </details>

        <details>
          <summary>3.3 <code>contacts[]</code> (moyens de contact enrichis)</summary>
          <div class="content">
            <p>Le bloc <code>contacts[]</code> regroupe tous les moyens de contact disponibles pour un √©tablissement : t√©l√©phone, email, site web, r√©seaux sociaux, etc. Chaque contact inclut des m√©tadonn√©es pour l'affichage et la priorisation.</p>
            
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th><th>Exemple</th></tr></thead>
              <tbody>
                <tr><td><code>kind_code</code></td><td><code>string</code></td><td>Type de contact (r√©f√©rentiel <code>contact_kind</code>)</td><td><code>"email"</code></td></tr>
                <tr><td><code>kind_name</code></td><td><code>string</code></td><td>Libell√© humain du type</td><td><code>"E-mail"</code></td></tr>
                <tr><td><code>kind_description</code></td><td><code>string</code></td><td>Description du type</td><td><code>"Adresse √©lectronique"</code></td></tr>
                <tr><td><code>icon_url</code></td><td><code>string (URL)</code></td><td>Ic√¥ne du type</td><td><code>"https://cdn.example.com/email.svg"</code></td></tr>
                <tr><td><code>value</code></td><td><code>string</code></td><td>Adresse/num√©ro/URL de contact</td><td><code>"contact@hotel-exemple.fr"</code></td></tr>
                <tr><td><code>is_public</code></td><td><code>boolean</code></td><td>Visible publiquement ?</td><td><code>true</code></td></tr>
                <tr><td><code>is_primary</code></td><td><code>boolean</code></td><td>Canal prioritaire ?</td><td><code>true</code></td></tr>
                <tr><td><code>role</code></td><td><code>string</code></td><td>R√¥le (code : <code>booking</code>, <code>info</code>, ‚Ä¶)</td><td><code>"booking"</code></td></tr>
                <tr><td><code>position</code></td><td><code>number</code></td><td>Ordre d'affichage conseill√©</td><td><code>1</code></td></tr>
              </tbody>
            </table>

            <h4>Types de contacts disponibles</h4>
            <p>Le syst√®me supporte plusieurs types de contacts via le r√©f√©rentiel <code>contact_kind</code> :</p>
            
            <table>
              <thead><tr><th>Code</th><th>Nom</th><th>Description</th><th>Format attendu</th></tr></thead>
              <tbody>
                <tr><td><code>email</code></td><td>E-mail</td><td>Adresse √©lectronique</td><td>email@domain.com</td></tr>
                <tr><td><code>phone</code></td><td>T√©l√©phone</td><td>Num√©ro de t√©l√©phone</td><td>+262 262 12 34 56</td></tr>
                <tr><td><code>mobile</code></td><td>Mobile</td><td>Num√©ro de mobile</td><td>+262 692 12 34 56</td></tr>
                <tr><td><code>website</code></td><td>Site web</td><td>URL du site internet</td><td>https://www.hotel-exemple.fr</td></tr>
                <tr><td><code>facebook</code></td><td>Facebook</td><td>Page Facebook</td><td>https://facebook.com/hotel-exemple</td></tr>
                <tr><td><code>instagram</code></td><td>Instagram</td><td>Compte Instagram</td><td>https://instagram.com/hotel_exemple</td></tr>
                <tr><td><code>whatsapp</code></td><td>WhatsApp</td><td>Contact WhatsApp</td><td>+262 692 12 34 56</td></tr>
                <tr><td><code>booking</code></td><td>R√©servation</td><td>Lien de r√©servation</td><td>https://booking.com/hotel-exemple</td></tr>
              </tbody>
            </table>

            <h4>Exemple concret : Contacts d'un h√¥tel</h4>
            <div class="card tip-card" style="margin-top: 16px;">
              <div class="pill tip-pill">Exemple</div>
              <pre style="background: var(--code-bg); color: var(--code); padding: 12px; border-radius: 8px; margin: 8px 0; overflow-x: auto;"><code>{
  "contacts": [
    {
      "kind_code": "phone",
      "kind_name": "T√©l√©phone",
      "kind_description": "Num√©ro de t√©l√©phone",
      "icon_url": "https://cdn.example.com/phone.svg",
      "value": "+262 262 12 34 56",
      "is_public": true,
      "is_primary": true,
      "role": "booking",
      "position": 1
    },
    {
      "kind_code": "email",
      "kind_name": "E-mail",
      "kind_description": "Adresse √©lectronique",
      "icon_url": "https://cdn.example.com/email.svg",
      "value": "contact@hotel-exemple.fr",
      "is_public": true,
      "is_primary": false,
      "role": "info",
      "position": 2
    },
    {
      "kind_code": "website",
      "kind_name": "Site web",
      "kind_description": "Site internet",
      "icon_url": "https://cdn.example.com/website.svg",
      "value": "https://www.hotel-exemple.fr",
      "is_public": true,
      "is_primary": false,
      "role": "info",
      "position": 3
    },
    {
      "kind_code": "whatsapp",
      "kind_name": "WhatsApp",
      "kind_description": "Contact WhatsApp",
      "icon_url": "https://cdn.example.com/whatsapp.svg",
      "value": "+262 692 12 34 56",
      "is_public": true,
      "is_primary": false,
      "role": "booking",
      "position": 4
    }
  ]
}</code></pre>
            </div>

            <h4>Utilisation pratique</h4>
            <div class="card info-card" style="margin-top: 16px;">
              <div class="pill info-pill">Affichage</div>
              <p><strong>Priorit√© :</strong> Affichez d'abord les contacts avec <code>is_primary: true</code>, puis les autres par <code>position</code>.</p>
              <p><strong>Types :</strong> Utilisez <code>kind_code</code> et <code>kind_name</code> pour identifier le type de contact.</p>
              <p><strong>R√¥les :</strong> Utilisez <code>role</code> (code) pour grouper par usage (booking, info, commercial).</p>
              <p><strong>Public :</strong> Filtrez avec <code>is_public: true</code> pour n'afficher que les contacts publics.</p>
            </div>

            <div class="card tip-card" style="margin-top: 16px;">
              <div class="pill tip-pill">Note sur les variantes</div>
              <p>Dans <code>actors[].contacts[]</code> et les contacts d'organisations, la structure est <strong>imbriqu√©e</strong> : <code>kind { code, name, description, icon_url }</code> et <code>role { code, name }</code>. Au niveau <strong>objet</strong>, le bloc <code>contacts[]</code> utilise les champs <code>kind_code</code>/<code>kind_name</code> et un <code>role</code> simple (code).</p>
            </div>

            <div class="card warning-card" style="margin-top: 16px;">
              <div class="pill warning-pill">Important</div>
              <p>Les contacts sont <strong>v√©rifi√©s et valid√©s</strong>. Respectez les pr√©f√©rences de contact de l'√©tablissement (horaires, langue, etc.).</p>
            </div>
          </div>
        </details>

        <details>
          <summary>3.4 <code>languages[]</code> (langues parl√©es)</summary>
          <div class="content">
            <p>Le bloc <code>languages[]</code> indique les langues parl√©es par le personnel de l'√©tablissement. Cette information est cruciale pour l'accessibilit√© et l'exp√©rience client.</p>
            
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th><th>Exemple</th></tr></thead>
              <tbody>
                <tr><td><code>code</code></td><td><code>string</code></td><td>Code ISO 639-1 de la langue</td><td><code>"fr"</code></td></tr>
                <tr><td><code>name</code></td><td><code>string</code></td><td>Nom de la langue</td><td><code>"Fran√ßais"</code></td></tr>
              </tbody>
            </table>

            <h4>Langues support√©es</h4>
            <p>Le syst√®me supporte les principales langues via le r√©f√©rentiel <code>ref_language</code> :</p>
            
            <table>
              <thead><tr><th>Code</th><th>Nom</th><th>Description</th><th>Usage typique</th></tr></thead>
              <tbody>
                <tr><td><code>fr</code></td><td>Fran√ßais</td><td>Langue officielle de La R√©union</td><td>Langue principale</td></tr>
                <tr><td><code>en</code></td><td>Anglais</td><td>Langue internationale</td><td>Tourisme international</td></tr>
                <tr><td><code>es</code></td><td>Espagnol</td><td>Langue latine</td><td>Tourisme hispanophone</td></tr>
                <tr><td><code>de</code></td><td>Allemand</td><td>Langue germanique</td><td>Tourisme germanophone</td></tr>
                <tr><td><code>it</code></td><td>Italien</td><td>Langue latine</td><td>Tourisme italophone</td></tr>
                <tr><td><code>pt</code></td><td>Portugais</td><td>Langue lusophone</td><td>Tourisme br√©silien</td></tr>
                <tr><td><code>zh</code></td><td>Chinois</td><td>Langue asiatique</td><td>Tourisme chinois</td></tr>
                <tr><td><code>ja</code></td><td>Japonais</td><td>Langue asiatique</td><td>Tourisme japonais</td></tr>
              </tbody>
            </table>

            <h4>Exemple concret : Langues d'un h√¥tel</h4>
            <div class="card tip-card" style="margin-top: 16px;">
              <div class="pill tip-pill">Exemple</div>
              <pre style="background: var(--code-bg); color: var(--code); padding: 12px; border-radius: 8px; margin: 8px 0; overflow-x: auto;"><code>{
  "languages": [
    {
      "code": "fr",
      "name": "Fran√ßais"
    },
    {
      "code": "en",
      "name": "Anglais"
    },
    {
      "code": "de",
      "name": "Allemand"
    },
    {
      "code": "es",
      "name": "Espagnol"
    }
  ]
}</code></pre>
            </div>

            <h4>Utilisation pratique</h4>
            <div class="card info-card" style="margin-top: 16px;">
              <div class="pill info-pill">Filtrage</div>
              <p><strong>Filtrer par langue :</strong> Utilisez <code>p_filters.languages_any: ["fr", "en"]</code> pour trouver les √©tablissements parlant fran√ßais ou anglais.</p>
              <p><strong>Affichage :</strong> Affichez les langues disponibles pour informer les clients de l'accessibilit√© linguistique.</p>
            </div>

            <div class="card warning-card" style="margin-top: 16px;">
              <div class="pill warning-pill">Important</div>
              <p>Les langues indiqu√©es correspondent aux <strong>capacit√©s r√©elles du personnel</strong>. V√©rifiez la disponibilit√© selon les horaires et les √©quipes pr√©sentes.</p>
            </div>
          </div>
        </details>

        <details>
          <summary>3.5 <code>media[]</code> (m√©dias publi√©s)</summary>
          <div class="content">
            <p>Le bloc <code>media[]</code> contient tous les m√©dias publi√©s associ√©s √† l'√©tablissement : photos, vid√©os, documents PDF, etc. La r√©ponse n'inclut que les m√©dias <strong>publi√©s</strong>.</p>
            
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th><th>Exemple</th></tr></thead>
              <tbody>
                <tr><td><code>id</code></td><td><code>string</code></td><td>Identifiant unique du m√©dia</td><td><code>"media_123"</code></td></tr>
                <tr><td><code>type_code</code></td><td><code>string</code></td><td>Type de m√©dia (r√©f√©rentiel <code>media_type</code>)</td><td><code>"image"</code></td></tr>
                <tr><td><code>type_name</code></td><td><code>string</code></td><td>Nom du type de m√©dia</td><td><code>"Image"</code></td></tr>
                <tr><td><code>type_description</code></td><td><code>string</code></td><td>Description du type de m√©dia</td><td><code>"Photos et illustrations"</code></td></tr>
                <tr><td><code>icon_url</code></td><td><code>string (URL)</code></td><td>Ic√¥ne repr√©sentant le type</td><td><code>"https://cdn.example.com/image.svg"</code></td></tr>
                <tr><td><code>title</code></td><td><code>string</code></td><td>Titre/l√©gende du m√©dia</td><td><code>"Vue panoramique de l'h√¥tel"</code></td></tr>
                <tr><td><code>credit</code></td><td><code>string</code></td><td>Cr√©dit photo/vid√©o</td><td><code>"¬© H√¥tel Exemple"</code></td></tr>
                <tr><td><code>url</code></td><td><code>string (URL)</code></td><td>URL directe du fichier</td><td><code>"https://cdn.example.com/hotel-view.jpg"</code></td></tr>
                <tr><td><code>is_main</code></td><td><code>boolean</code></td><td>M√©dia principal de l'√©tablissement ?</td><td><code>true</code></td></tr>
                <tr><td><code>visibility</code></td><td><code>string</code></td><td>Niveau de visibilit√©</td><td><code>"public"</code></td></tr>
                <tr><td><code>position</code></td><td><code>number</code></td><td>Ordre d'affichage</td><td><code>1</code></td></tr>
                <tr><td><code>width</code></td><td><code>number</code></td><td>Largeur en pixels (si connue)</td><td><code>1920</code></td></tr>
                <tr><td><code>height</code></td><td><code>number</code></td><td>Hauteur en pixels (si connue)</td><td><code>1080</code></td></tr>
              </tbody>
            </table>

            <h4>Types de m√©dias disponibles</h4>
            <p>Le syst√®me supporte plusieurs types de m√©dias via le r√©f√©rentiel <code>media_type</code> :</p>
            
            <table>
              <thead><tr><th>Code</th><th>Nom</th><th>Description</th><th>Formats typiques</th></tr></thead>
              <tbody>
                <tr><td><code>image</code></td><td>Image</td><td>Photos et illustrations</td><td>JPG, PNG, WebP</td></tr>
                <tr><td><code>video</code></td><td>Vid√©o</td><td>Vid√©os promotionnelles</td><td>MP4, WebM</td></tr>
                <tr><td><code>logo</code></td><td>Logo</td><td>Logo de l'√©tablissement</td><td>PNG, SVG</td></tr>
                <tr><td><code>brochure_pdf</code></td><td>Brochure PDF</td><td>Documentation imprimable</td><td>PDF</td></tr>
                <tr><td><code>menu_pdf</code></td><td>Menu PDF</td><td>Menu au format PDF</td><td>PDF</td></tr>
                <tr><td><code>audio</code></td><td>Audio</td><td>Fichiers audio</td><td>MP3, WAV</td></tr>
                <tr><td><code>document</code></td><td>Document</td><td>Autres documents</td><td>PDF, DOC</td></tr>
              </tbody>
            </table>

            <h4>Exemple concret : M√©dias d'un h√¥tel</h4>
            <div class="card tip-card" style="margin-top: 16px;">
              <div class="pill tip-pill">Exemple</div>
              <pre style="background: var(--code-bg); color: var(--code); padding: 12px; border-radius: 8px; margin: 8px 0; overflow-x: auto;"><code>{
  "media": [
    {
      "id": "media_001",
      "type_code": "image",
      "type_name": "Image",
      "icon_url": "https://cdn.example.com/image.svg",
      "title": "Vue panoramique de l'h√¥tel",
      "credit": "¬© H√¥tel Exemple",
      "url": "https://cdn.example.com/hotel-panorama.jpg",
      "is_main": true,
      "visibility": "public",
      "position": 1,
      "width": 1920,
      "height": 1080
    },
    {
      "id": "media_002",
      "type_code": "video",
      "type_name": "Vid√©o",
      "icon_url": "https://cdn.example.com/video.svg",
      "title": "Visite virtuelle de l'h√¥tel",
      "credit": "¬© H√¥tel Exemple",
      "url": "https://cdn.example.com/hotel-tour.mp4",
      "is_main": false,
      "visibility": "public",
      "position": 2,
      "width": 1920,
      "height": 1080
    },
    {
      "id": "media_003",
      "type_code": "brochure_pdf",
      "type_name": "Brochure PDF",
      "icon_url": "https://cdn.example.com/pdf.svg",
      "title": "Brochure compl√®te 2024",
      "credit": "¬© H√¥tel Exemple",
      "url": "https://cdn.example.com/brochure-2024.pdf",
      "is_main": false,
      "visibility": "public",
      "position": 3,
      "width": null,
      "height": null
    }
  ]
}</code></pre>
            </div>

            <div class="card tip-card" style="margin-top: 16px;">
              <div class="pill tip-pill">Variante menus</div>
              <p>Dans <code>menus[].items[].media[]</code>, la structure utilise un objet imbriqu√© <code>media_type { id, code, name }</code> et inclut le champ <code>is_published</code>. Au niveau <strong>objet</strong>, le bloc <code>media[]</code> expose <code>type_code</code>/<code>type_name</code> et n'inclut pas <code>is_published</code>.</p>
            </div>

            <h4>Utilisation pratique</h4>
            <div class="card info-card" style="margin-top: 16px;">
              <div class="pill info-pill">Affichage</div>
              <p><strong>M√©dia principal :</strong> Affichez d'abord le m√©dia avec <code>is_main: true</code> comme image de couverture.</p>
              <p><strong>Tri :</strong> Triez par <code>position</code> pour respecter l'ordre souhait√© par l'√©tablissement.</p>
              <p><strong>Filtrage :</strong> Utilisez <code>p_filters.media_types_any: ["image"]</code> pour ne r√©cup√©rer que les images.</p>
            </div>

            <div class="card warning-card" style="margin-top: 16px;">
              <div class="pill warning-pill">Important</div>
              <p>Les m√©dias sont <strong>publi√©s et v√©rifi√©s</strong>. Respectez les droits d'auteur et les cr√©dits mentionn√©s. Les URLs sont directes et ne n√©cessitent pas d'authentification.</p>
            </div>
          </div>
        </details>

        <details>
          <summary>3.6 <code>capacity[]</code> (capacit√©s d'accueil)</summary>
          <div class="content">
            <p>Le bloc <code>capacity[]</code> d√©finit les capacit√©s d'accueil de l'√©tablissement selon diff√©rentes m√©triques : nombre de lits, couverts, chambres, etc. Ces informations sont essentielles pour la planification et la r√©servation.</p>
            
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th><th>Exemple</th></tr></thead>
              <tbody>
                <tr><td><code>metric_code</code></td><td><code>string</code></td><td>Code de la m√©trique (r√©f√©rentiel <code>ref_capacity_metric</code>)</td><td><code>"beds"</code></td></tr>
                <tr><td><code>metric_name</code></td><td><code>string</code></td><td>Nom de la m√©trique</td><td><code>"Lits"</code></td></tr>
                <tr><td><code>icon_url</code></td><td><code>string (URL)</code></td><td>Ic√¥ne repr√©sentant la m√©trique</td><td><code>"https://cdn.example.com/bed.svg"</code></td></tr>
                <tr><td><code>value</code></td><td><code>number</code></td><td>Valeur num√©rique de la capacit√©</td><td><code>50</code></td></tr>
                <tr><td><code>unit</code></td><td><code>string</code></td><td>Unit√© de mesure (si applicable)</td><td><code>"personnes"</code></td></tr>
              </tbody>
            </table>

            <h4>M√©triques de capacit√© disponibles</h4>
            <p>Le syst√®me supporte plusieurs m√©triques via le r√©f√©rentiel <code>ref_capacity_metric</code> :</p>
            
            <table>
              <thead><tr><th>Code</th><th>Nom</th><th>Description</th><th>Usage typique</th></tr></thead>
              <tbody>
                <tr><td><code>beds</code></td><td>Lits</td><td>Nombre total de lits</td><td>H√¥tels, g√Ætes</td></tr>
                <tr><td><code>rooms</code></td><td>Chambres</td><td>Nombre de chambres</td><td>H√¥tels, meubl√©s</td></tr>
                <tr><td><code>covers</code></td><td>Couverts</td><td>Capacit√© restaurant</td><td>Restaurants, caf√©s</td></tr>
                <tr><td><code>seats</code></td><td>Places assises</td><td>Places en salle</td><td>Restaurants, salles</td></tr>
                <tr><td><code>max_capacity</code></td><td>Capacit√© max</td><td>Capacit√© maximale totale</td><td>√âv√©nements, salles</td></tr>
                <tr><td><code>parking_spaces</code></td><td>Places parking</td><td>Nombre de places de parking</td><td>Tous √©tablissements</td></tr>
                <tr><td><code>pools</code></td><td>Piscines</td><td>Nombre de piscines</td><td>H√¥tels, campings</td></tr>
                <tr><td><code>tennis_courts</code></td><td>Courts de tennis</td><td>Nombre de courts</td><td>Complexes sportifs</td></tr>
              </tbody>
            </table>

            <h4>Exemple concret : Capacit√©s d'un h√¥tel</h4>
            <div class="card tip-card" style="margin-top: 16px;">
              <div class="pill tip-pill">Exemple</div>
              <pre style="background: var(--code-bg); color: var(--code); padding: 12px; border-radius: 8px; margin: 8px 0; overflow-x: auto;"><code>{
  "capacity": [
    {
      "metric_code": "rooms",
      "metric_name": "Chambres",
      "icon_url": "https://cdn.example.com/room.svg",
      "value": 25,
      "unit": "chambres"
    },
    {
      "metric_code": "beds",
      "metric_name": "Lits",
      "icon_url": "https://cdn.example.com/bed.svg",
      "value": 50,
      "unit": "lits"
    },
    {
      "metric_code": "covers",
      "metric_name": "Couverts",
      "icon_url": "https://cdn.example.com/restaurant.svg",
      "value": 80,
      "unit": "couverts"
    },
    {
      "metric_code": "parking_spaces",
      "metric_name": "Places parking",
      "icon_url": "https://cdn.example.com/parking.svg",
      "value": 30,
      "unit": "places"
    }
  ]
}</code></pre>
            </div>

            <h4>Utilisation pratique</h4>
            <div class="card info-card" style="margin-top: 16px;">
              <div class="pill info-pill">Filtrage</div>
              <p><strong>Filtrer par capacit√© :</strong> Utilisez <code>p_filters.capacity_filters: [{"metric": "beds", "min": 20, "max": 100}]</code> pour trouver les √©tablissements avec 20 √† 100 lits.</p>
              <p><strong>Affichage :</strong> Affichez les capacit√©s pertinentes selon le type d'√©tablissement (lits pour h√¥tels, couverts pour restaurants).</p>
            </div>

            <div class="card warning-card" style="margin-top: 16px;">
              <div class="pill warning-pill">Important</div>
              <p>Les capacit√©s indiquent le <strong>maximum th√©orique</strong>. La disponibilit√© r√©elle d√©pend des r√©servations et de la configuration des chambres/salles.</p>
            </div>
          </div>
        </details>

        <details>
          <summary>3.7 <code>amenities[]</code> (√©quipements et services)</summary>
          <div class="content">
            <p>Le bloc <code>amenities[]</code> liste tous les √©quipements et services disponibles dans l'√©tablissement : WiFi, piscine, parking, restaurant, etc. Ces informations sont cruciales pour l'exp√©rience client et les filtres de recherche.</p>
            
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th><th>Exemple</th></tr></thead>
              <tbody>
                <tr><td><code>code</code></td><td><code>string</code></td><td>Code de l'√©quipement (r√©f√©rentiel <code>amenity</code>)</td><td><code>"WIFI"</code></td></tr>
                <tr><td><code>name</code></td><td><code>string</code></td><td>Nom de l'√©quipement</td><td><code>"WiFi gratuit"</code></td></tr>
                <tr><td><code>icon_url</code></td><td><code>string (URL)</code></td><td>Ic√¥ne repr√©sentant l'√©quipement</td><td><code>"https://cdn.example.com/wifi.svg"</code></td></tr>
                <tr><td><code>family</code></td><td><code>object</code></td><td>Famille d'√©quipements : { code, name, icon_url }</td><td><code>{"code": "connectivity", "name": "Connectivit√©"}</code></td></tr>
              </tbody>
            </table>

            <h4>Familles d'√©quipements disponibles</h4>
            <p>Les √©quipements sont organis√©s en familles via le r√©f√©rentiel <code>amenity_family</code> :</p>
            
            <table>
              <thead><tr><th>Code</th><th>Nom</th><th>Description</th><th>√âquipements typiques</th></tr></thead>
              <tbody>
                <tr><td><code>connectivity</code></td><td>Connectivit√©</td><td>Services internet et communication</td><td>WiFi, 4G, t√©l√©phone</td></tr>
                <tr><td><code>comfort</code></td><td>Confort</td><td>√âquipements de confort</td><td>Climatisation, chauffage, minibar</td></tr>
                <tr><td><code>outdoor</code></td><td>Ext√©rieur</td><td>Espaces et activit√©s ext√©rieures</td><td>Piscine, jardin, terrasse</td></tr>
                <tr><td><code>wellness</code></td><td>Bien-√™tre</td><td>Services de bien-√™tre</td><td>Spa, sauna, fitness</td></tr>
                <tr><td><code>dining</code></td><td>Restauration</td><td>Services de restauration</td><td>Restaurant, bar, petit-d√©jeuner</td></tr>
                <tr><td><code>business</code></td><td>Business</td><td>Services professionnels</td><td>Salle de r√©union, photocopieur</td></tr>
                <tr><td><code>accessibility</code></td><td>Accessibilit√©</td><td>√âquipements d'accessibilit√©</td><td>Ascenseur, rampe, chambre adapt√©e</td></tr>
                <tr><td><code>transport</code></td><td>Transport</td><td>Services de transport</td><td>Parking, navette, location v√©lo</td></tr>
              </tbody>
            </table>

            <h4>√âquipements populaires</h4>
            <p>Voici quelques √©quipements couramment utilis√©s :</p>
            
            <table>
              <thead><tr><th>Code</th><th>Nom</th><th>Famille</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>WIFI</code></td><td>WiFi gratuit</td><td>connectivity</td><td>Acc√®s internet sans fil</td></tr>
                <tr><td><code>PARKING</code></td><td>Parking</td><td>transport</td><td>Place de stationnement</td></tr>
                <tr><td><code>POOL</code></td><td>Piscine</td><td>outdoor</td><td>Bassin de natation</td></tr>
                <tr><td><code>RESTAURANT</code></td><td>Restaurant</td><td>dining</td><td>Service de restauration</td></tr>
                <tr><td><code>AC</code></td><td>Climatisation</td><td>comfort</td><td>Air conditionn√©</td></tr>
                <tr><td><code>SPA</code></td><td>Spa</td><td>wellness</td><td>Centre de bien-√™tre</td></tr>
                <tr><td><code>ELEVATOR</code></td><td>Ascenseur</td><td>accessibility</td><td>√âquipement d'accessibilit√©</td></tr>
                <tr><td><code>MEETING_ROOM</code></td><td>Salle de r√©union</td><td>business</td><td>Espace de travail</td></tr>
              </tbody>
            </table>

            <h4>Exemple concret : √âquipements d'un h√¥tel</h4>
            <div class="card tip-card" style="margin-top: 16px;">
              <div class="pill tip-pill">Exemple</div>
              <pre style="background: var(--code-bg); color: var(--code); padding: 12px; border-radius: 8px; margin: 8px 0; overflow-x: auto;"><code>{
  "amenities": [
    {
      "code": "WIFI",
      "name": "WiFi gratuit",
      "icon_url": "https://cdn.example.com/wifi.svg",
      "family": {
        "code": "connectivity",
        "name": "Connectivit√©",
        "icon_url": "https://cdn.example.com/connectivity.svg"
      }
    },
    {
      "code": "PARKING",
      "name": "Parking",
      "icon_url": "https://cdn.example.com/parking.svg",
      "family": {
        "code": "transport",
        "name": "Transport",
        "icon_url": "https://cdn.example.com/transport.svg"
      }
    },
    {
      "code": "POOL",
      "name": "Piscine",
      "icon_url": "https://cdn.example.com/pool.svg",
      "family": {
        "code": "outdoor",
        "name": "Ext√©rieur",
        "icon_url": "https://cdn.example.com/outdoor.svg"
      }
    },
    {
      "code": "RESTAURANT",
      "name": "Restaurant",
      "icon_url": "https://cdn.example.com/restaurant.svg",
      "family": {
        "code": "dining",
        "name": "Restauration",
        "icon_url": "https://cdn.example.com/dining.svg"
      }
    },
    {
      "code": "SPA",
      "name": "Spa",
      "icon_url": "https://cdn.example.com/spa.svg",
      "family": {
        "code": "wellness",
        "name": "Bien-√™tre",
        "icon_url": "https://cdn.example.com/wellness.svg"
      }
    }
  ]
}</code></pre>
            </div>

            <h4>Utilisation pratique</h4>
            <div class="card info-card" style="margin-top: 16px;">
              <div class="pill info-pill">Filtrage</div>
              <p><strong>Filtrer par √©quipements :</strong> Utilisez <code>p_filters.amenities_any: ["WIFI", "POOL"]</code> pour trouver les √©tablissements avec WiFi et piscine.</p>
              <p><strong>Filtrer par famille :</strong> Utilisez <code>p_filters.amenity_families_any: ["wellness", "outdoor"]</code> pour les √©quipements de bien-√™tre et ext√©rieurs.</p>
              <p><strong>Affichage :</strong> Groupez par <code>family</code> pour une meilleure organisation visuelle.</p>
            </div>

            <div class="card warning-card" style="margin-top: 16px;">
              <div class="pill warning-pill">Important</div>
              <p>Les √©quipements indiqu√©s sont <strong>disponibles sur place</strong>. V√©rifiez les conditions d'acc√®s (horaires, restrictions, co√ªts suppl√©mentaires) directement avec l'√©tablissement.</p>
            </div>
          </div>
        </details>

        <details>
          <summary>3.8 <code>environment_tags[]</code> & <code>payment_methods[]</code> (tags environnementaux et moyens de paiement)</summary>
          <div class="content">
            <p>Ces deux blocs partagent la m√™me structure simple mais servent des objectifs diff√©rents : <code>environment_tags[]</code> d√©crit l'environnement de l'√©tablissement, tandis que <code>payment_methods[]</code> liste les moyens de paiement accept√©s.</p>
            
            <h4>Structure commune</h4>
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th><th>Exemple</th></tr></thead>
              <tbody>
                <tr><td><code>code</code></td><td><code>string</code></td><td>Code de r√©f√©rence</td><td><code>"beach"</code></td></tr>
                <tr><td><code>name</code></td><td><code>string</code></td><td>Nom affich√©</td><td><code>"Plage"</code></td></tr>
                <tr><td><code>icon_url</code></td><td><code>string (URL)</code></td><td>Ic√¥ne repr√©sentative</td><td><code>"https://cdn.example.com/beach.svg"</code></td></tr>
              </tbody>
            </table>

            <h4>Tags environnementaux disponibles</h4>
            <p>Le syst√®me supporte plusieurs tags environnementaux via le r√©f√©rentiel <code>environment_tag</code> :</p>
            
            <table>
              <thead><tr><th>Code</th><th>Nom</th><th>Description</th><th>Usage typique</th></tr></thead>
              <tbody>
                <tr><td><code>beach</code></td><td>Plage</td><td>Proximit√© de la plage</td><td>H√¥tels c√¥tiers</td></tr>
                <tr><td><code>mountain</code></td><td>Montagne</td><td>Environnement montagnard</td><td>G√Ætes, refuges</td></tr>
                <tr><td><code>forest</code></td><td>For√™t</td><td>Proximit√© de for√™ts</td><td>Campings, g√Ætes</td></tr>
                <tr><td><code>city_center</code></td><td>Centre-ville</td><td>En centre-ville</td><td>H√¥tels urbains</td></tr>
                <tr><td><code>heritage</code></td><td>Patrimoine</td><td>Proche de sites patrimoniaux</td><td>H√¥tels historiques</td></tr>
                <tr><td><code>volcano</code></td><td>Volcan</td><td>Proximit√© volcanique</td><td>Sp√©cifique √† La R√©union</td></tr>
                <tr><td><code>lagoon</code></td><td>Lagon</td><td>Proximit√© du lagon</td><td>H√¥tels tropicaux</td></tr>
                <tr><td><code>garden</code></td><td>Jardin</td><td>Jardin priv√©</td><td>G√Ætes, maisons d'h√¥te</td></tr>
              </tbody>
            </table>

            <h4>Moyens de paiement disponibles</h4>
            <p>Le syst√®me supporte plusieurs moyens de paiement via le r√©f√©rentiel <code>payment_method</code> :</p>
            
            <table>
              <thead><tr><th>Code</th><th>Nom</th><th>Description</th><th>Usage typique</th></tr></thead>
              <tbody>
                <tr><td><code>cash</code></td><td>Esp√®ces</td><td>Paiement en liquide</td><td>Petits √©tablissements</td></tr>
                <tr><td><code>card</code></td><td>Carte bancaire</td><td>Paiement par carte</td><td>Standard</td></tr>
                <tr><td><code>check</code></td><td>Ch√®que</td><td>Paiement par ch√®que</td><td>R√©servations longues</td></tr>
                <tr><td><code>transfer</code></td><td>Virement</td><td>Virement bancaire</td><td>Groupes, entreprises</td></tr>
                <tr><td><code>paypal</code></td><td>PayPal</td><td>Paiement en ligne</td><td>R√©servations web</td></tr>
                <tr><td><code>apple_pay</code></td><td>Apple Pay</td><td>Paiement mobile Apple</td><td>Clients Apple</td></tr>
                <tr><td><code>google_pay</code></td><td>Google Pay</td><td>Paiement mobile Google</td><td>Clients Android</td></tr>
                <tr><td><code>voucher</code></td><td>Bon cadeau</td><td>Paiement par bon</td><td>Offres sp√©ciales</td></tr>
              </tbody>
            </table>

            <h4>Exemple concret : H√¥tel c√¥tier</h4>
            <div class="card tip-card" style="margin-top: 16px;">
              <div class="pill tip-pill">Exemple</div>
              <pre style="background: var(--code-bg); color: var(--code); padding: 12px; border-radius: 8px; margin: 8px 0; overflow-x: auto;"><code>{
  "environment_tags": [
    {
      "code": "beach",
      "name": "Plage",
      "icon_url": "https://cdn.example.com/beach.svg"
    },
    {
      "code": "lagoon",
      "name": "Lagon",
      "icon_url": "https://cdn.example.com/lagoon.svg"
    },
    {
      "code": "volcano",
      "name": "Volcan",
      "icon_url": "https://cdn.example.com/volcano.svg"
    }
  ],
  "payment_methods": [
    {
      "code": "card",
      "name": "Carte bancaire",
      "icon_url": "https://cdn.example.com/card.svg"
    },
    {
      "code": "cash",
      "name": "Esp√®ces",
      "icon_url": "https://cdn.example.com/cash.svg"
    },
    {
      "code": "paypal",
      "name": "PayPal",
      "icon_url": "https://cdn.example.com/paypal.svg"
    }
  ]
}</code></pre>
            </div>

            <h4>Utilisation pratique</h4>
            <div class="card info-card" style="margin-top: 16px;">
              <div class="pill info-pill">Filtrage</div>
              <p><strong>Filtrer par environnement :</strong> Utilisez <code>p_filters.environment_tags_any: ["beach", "mountain"]</code> pour trouver les √©tablissements en bord de plage ou en montagne.</p>
              <p><strong>Filtrer par paiement :</strong> Utilisez <code>p_filters.payment_methods_any: ["card", "paypal"]</code> pour les √©tablissements acceptant carte ou PayPal.</p>
              <p><strong>Affichage :</strong> Affichez les tags environnementaux pour l'orientation g√©ographique et les moyens de paiement pour la planification.</p>
            </div>

            <div class="card warning-card" style="margin-top: 16px;">
              <div class="pill warning-pill">Important</div>
              <p>Les moyens de paiement indiqu√©s sont <strong>g√©n√©ralement accept√©s</strong>. V√©rifiez les conditions sp√©cifiques (montants minimums, devises, etc.) directement avec l'√©tablissement.</p>
            </div>
          </div>
        </details>

        <details>
          <summary>3.9 <code>prices[]</code> (tarification complexe avec p√©riodes)</summary>
          <div class="content">
            <p>Le bloc <code>prices[]</code> g√®re la tarification complexe des √©tablissements avec des prix variables selon les p√©riodes, les types de clients, et les unit√©s de facturation. Il supporte les fourchettes de prix, les conditions sp√©ciales, et les cr√©neaux horaires d√©taill√©s.</p>
            
            <h4>Structure principale d'un tarif</h4>
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th><th>Exemple</th></tr></thead>
              <tbody>
                <tr><td><code>kind</code></td><td><code>object</code></td><td>Type de tarif enrichi : { id, code, name, position, icon_url }</td><td><code>{"code": "adult", "name": "Adulte"}</code></td></tr>
                <tr><td><code>unit</code></td><td><code>object</code></td><td>Unit√© enrichie : { id, code, name, position, icon_url }</td><td><code>{"code": "per_night", "name": "Par nuit"}</code></td></tr>
                <tr><td><code>amount</code></td><td><code>number</code></td><td>Montant de base (optionnel si fourchette)</td><td><code>120.00</code></td></tr>
                <tr><td><code>amount_max</code></td><td><code>number</code></td><td>Montant maximum (pour fourchettes de prix)</td><td><code>180.00</code></td></tr>
                <tr><td><code>currency</code></td><td><code>string</code></td><td>Devise (ISO 4217)</td><td><code>"EUR"</code></td></tr>
                <tr><td><code>valid_from</code></td><td><code>date</code></td><td>Date de d√©but de validit√© du tarif</td><td><code>"2024-01-01"</code></td></tr>
                <tr><td><code>valid_to</code></td><td><code>date</code></td><td>Date de fin de validit√© du tarif</td><td><code>"2024-12-31"</code></td></tr>
                <tr><td><code>conditions</code></td><td><code>string</code></td><td>Conditions, notes, restrictions</td><td><code>"Petit-d√©jeuner inclus"</code></td></tr>
                <tr><td><code>periods</code></td><td><code>array&lt;object&gt;</code></td><td>P√©riodes d√©taill√©es imbriqu√©es</td><td>Voir structure ci-dessous</td></tr>
              </tbody>
            </table>

            <h4>Types de tarifs disponibles</h4>
            <p>Le syst√®me supporte plusieurs types de tarifs via le r√©f√©rentiel <code>price_kind</code> :</p>
            
            <table>
              <thead><tr><th>Code</th><th>Nom</th><th>Description</th><th>Usage typique</th></tr></thead>
              <tbody>
                <tr><td><code>adult</code></td><td>Adulte</td><td>Tarif adulte standard</td><td>H√¥tels, restaurants</td></tr>
                <tr><td><code>child</code></td><td>Enfant</td><td>Tarif enfant (g√©n√©ralement r√©duit)</td><td>H√¥tels, activit√©s</td></tr>
                <tr><td><code>senior</code></td><td>S√©nior</td><td>Tarif senior (g√©n√©ralement r√©duit)</td><td>H√¥tels, mus√©es</td></tr>
                <tr><td><code>group</code></td><td>Groupe</td><td>Tarif de groupe (g√©n√©ralement r√©duit)</td><td>H√¥tels, restaurants</td></tr>
                <tr><td><code>package</code></td><td>Forfait</td><td>Forfait tout inclus</td><td>H√¥tels, agences</td></tr>
                <tr><td><code>student</code></td><td>√âtudiant</td><td>Tarif √©tudiant</td><td>Mus√©es, activit√©s</td></tr>
                <tr><td><code>free</code></td><td>Gratuit</td><td>Acc√®s gratuit</td><td>Mus√©es, parcs</td></tr>
                <tr><td><code>local</code></td><td>R√©sident</td><td>Tarif r√©sident local</td><td>Activit√©s, parcs</td></tr>
              </tbody>
            </table>

            <h4>Unit√©s de tarification disponibles</h4>
            <p>Le syst√®me supporte plusieurs unit√©s via le r√©f√©rentiel <code>price_unit</code> :</p>
            
            <table>
              <thead><tr><th>Code</th><th>Nom</th><th>Description</th><th>Usage typique</th></tr></thead>
              <tbody>
                <tr><td><code>per_night</code></td><td>Par nuit</td><td>Tarif par nuit√©e</td><td>H√¥tels, g√Ætes</td></tr>
                <tr><td><code>per_person</code></td><td>Par personne</td><td>Tarif par personne</td><td>Restaurants, activit√©s</td></tr>
                <tr><td><code>per_group</code></td><td>Par groupe</td><td>Tarif forfaitaire groupe</td><td>Guides, activit√©s</td></tr>
                <tr><td><code>per_entry</code></td><td>Par entr√©e</td><td>Tarif d'entr√©e unique</td><td>Mus√©es, parcs</td></tr>
                <tr><td><code>per_hour</code></td><td>Par heure</td><td>Tarif horaire</td><td>Location, services</td></tr>
                <tr><td><code>per_day</code></td><td>Par jour</td><td>Tarif journalier</td><td>Location v√©hicules</td></tr>
                <tr><td><code>per_week</code></td><td>Par semaine</td><td>Tarif hebdomadaire</td><td>Location longue dur√©e</td></tr>
                <tr><td><code>per_month</code></td><td>Par mois</td><td>Tarif mensuel</td><td>Location tr√®s longue dur√©e</td></tr>
              </tbody>
            </table>
            
            <h4>P√©riodes imbriqu√©es (<code>periods[]</code>)</h4>
            <p>Chaque tarif peut avoir des p√©riodes sp√©cifiques avec des cr√©neaux horaires et des conditions particuli√®res :</p>
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th><th>Exemple</th></tr></thead>
              <tbody>
                <tr><td><code>id</code></td><td><code>string</code></td><td>Identifiant unique de la p√©riode</td><td><code>"uuid-period-1"</code></td></tr>
                <tr><td><code>start_date</code></td><td><code>date</code></td><td>Date de d√©but de la p√©riode</td><td><code>"2024-07-01"</code></td></tr>
                <tr><td><code>end_date</code></td><td><code>date</code></td><td>Date de fin de la p√©riode</td><td><code>"2024-08-31"</code></td></tr>
                <tr><td><code>start_time</code></td><td><code>time</code></td><td>Heure de d√©but (format HH:MM)</td><td><code>"15:00"</code></td></tr>
                <tr><td><code>end_time</code></td><td><code>time</code></td><td>Heure de fin (format HH:MM)</td><td><code>"11:00"</code></td></tr>
                <tr><td><code>note</code></td><td><code>string</code></td><td>Note sp√©cifique √† la p√©riode</td><td><code>"Haute saison"</code></td></tr>
              </tbody>
            </table>
            
            <h4>Exemple concret : Tarification h√¥tel complexe</h4>
            <div class="card tip-card" style="margin-top: 16px;">
              <div class="pill tip-pill">Exemple</div>
              <pre style="background: var(--code-bg); color: var(--code); padding: 12px; border-radius: 8px; margin: 8px 0; overflow-x: auto;"><code>{
  "prices": [
    {
      "kind": {
        "id": "uuid-kind-1",
        "code": "adult",
        "name": "Adulte",
        "position": 1,
        "icon_url": "https://cdn.example.com/adult.svg"
      },
      "unit": {
        "id": "uuid-unit-1", 
        "code": "per_night",
        "name": "Par nuit",
        "position": 1,
        "icon_url": "https://cdn.example.com/night.svg"
      },
      "amount": 120.00,
      "amount_max": null,
      "currency": "EUR",
      "valid_from": "2024-01-01",
      "valid_to": "2024-12-31",
      "conditions": "Petit-d√©jeuner inclus, TVA comprise",
      "periods": [
        {
          "id": "uuid-period-1",
          "start_date": "2024-07-01",
          "end_date": "2024-08-31",
          "start_time": "15:00",
          "end_time": "11:00",
          "note": "Haute saison - Prix major√©"
        },
        {
          "id": "uuid-period-2",
          "start_date": "2024-09-01",
          "end_date": "2024-10-31",
          "start_time": "16:00",
          "end_time": "10:00",
          "note": "Saison interm√©diaire"
        }
      ]
    },
    {
      "kind": {
        "id": "uuid-kind-2",
        "code": "child",
        "name": "Enfant",
        "position": 2,
        "icon_url": "https://cdn.example.com/child.svg"
      },
      "unit": {
        "id": "uuid-unit-1", 
        "code": "per_night",
        "name": "Par nuit",
        "position": 1,
        "icon_url": "https://cdn.example.com/night.svg"
      },
      "amount": 60.00,
      "amount_max": null,
      "currency": "EUR",
      "valid_from": "2024-01-01",
      "valid_to": "2024-12-31",
      "conditions": "Enfant de 3 √† 12 ans, petit-d√©jeuner inclus",
      "periods": []
    },
    {
      "kind": {
        "id": "uuid-kind-3",
        "code": "group",
        "name": "Groupe",
        "position": 3,
        "icon_url": "https://cdn.example.com/group.svg"
      },
      "unit": {
        "id": "uuid-unit-2", 
        "code": "per_person",
        "name": "Par personne",
        "position": 2,
        "icon_url": "https://cdn.example.com/person.svg"
      },
      "amount": 80.00,
      "amount_max": 100.00,
      "currency": "EUR",
      "valid_from": "2024-01-01",
      "valid_to": "2024-12-31",
      "conditions": "Minimum 10 personnes, petit-d√©jeuner inclus",
      "periods": []
    }
  ]
}</code></pre>
            </div>
            
            <h4>Utilisation pratique</h4>
            <div class="card info-card" style="margin-top: 16px;">
              <div class="pill info-pill">Calcul de prix</div>
              <p><strong>Prix fixe :</strong> Utilisez <code>amount</code> quand le prix est fixe.</p>
              <p><strong>Fourchette :</strong> Utilisez <code>amount</code> et <code>amount_max</code> pour les fourchettes de prix.</p>
              <p><strong>P√©riodes :</strong> V√©rifiez les <code>periods[]</code> pour les tarifs saisonniers et les cr√©neaux horaires.</p>
              <p><strong>Conditions :</strong> Affichez les <code>conditions</code> pour informer les clients des inclusions/exclusions.</p>
            </div>

            <div class="card warning-card" style="margin-top: 16px;">
              <div class="pill warning-pill">Important</div>
              <p>Les prix indiqu√©s sont <strong>indicatifs</strong> et peuvent varier selon la disponibilit√©, les promotions, et les conditions particuli√®res. V√©rifiez toujours les prix finaux lors de la r√©servation.</p>
            </div>
          </div>
        </details>

        <details>
          <summary>3.10 <code>classifications[]</code> (labels, classements, certifications)</summary>
          <div class="content">
            <p>Le bloc <code>classifications[]</code> regroupe tous les labels, classements et certifications attribu√©s √† un objet touristique. C'est ici que sont stock√©es les <strong>√©toiles d'h√¥tel</strong>, les <strong>labels environnementaux</strong>, les <strong>certifications d'accessibilit√©</strong> et autres reconnaissances officielles.</p>
            
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th><th>Exemple</th></tr></thead>
              <tbody>
                <tr><td><code>scheme</code></td><td><code>string</code></td><td>Code du sch√©ma de classification</td><td><code>"hot_stars"</code></td></tr>
                <tr><td><code>scheme_name</code></td><td><code>string</code></td><td>Nom du sch√©ma/organisme</td><td><code>"Classement h√¥telier"</code></td></tr>
                <tr><td><code>value</code></td><td><code>string</code></td><td>Code de la valeur/grade</td><td><code>"4"</code></td></tr>
                <tr><td><code>value_name</code></td><td><code>string</code></td><td>Libell√© de la valeur</td><td><code>"4 √©toiles"</code></td></tr>
                <tr><td><code>awarded_at</code></td><td><code>date</code></td><td>Date d'obtention</td><td><code>"2024-01-15"</code></td></tr>
                <tr><td><code>valid_until</code></td><td><code>date</code></td><td>Date d'expiration (si applicable)</td><td><code>"2025-01-15"</code></td></tr>
                <tr><td><code>status</code></td><td><code>enum</code></td><td>Statut de la classification</td><td><code>"active"</code></td></tr>
              </tbody>
            </table>

            <h4>Types de classifications disponibles</h4>
            <p>Le syst√®me supporte plusieurs types de classifications via le r√©f√©rentiel <code>ref_classification_scheme</code> :</p>
            
            <table>
              <thead><tr><th>Code</th><th>Nom</th><th>Description</th><th>Valeurs possibles</th></tr></thead>
              <tbody>
                <tr><td><code>hot_stars</code></td><td>Classement h√¥telier</td><td>√âtoiles officielles h√¥tels</td><td>1 √† 5 √©toiles</td></tr>
                <tr><td><code>camp_stars</code></td><td>Classement camping</td><td>√âtoiles officielles campings</td><td>1 √† 5 √©toiles</td></tr>
                <tr><td><code>meuble_stars</code></td><td>Classement meubl√©s</td><td>√âtoiles meubl√©s de tourisme</td><td>1 √† 5 √©toiles</td></tr>
                <tr><td><code>gites_epics</code></td><td>G√Ætes de France (√©pis)</td><td>Niveau G√Ætes de France</td><td>1 √† 5 √©pis</td></tr>
                <tr><td><code>clevacances_keys</code></td><td>Cl√©vacances (cl√©s)</td><td>Niveau Cl√©vacances</td><td>1 √† 5 cl√©s</td></tr>
                <tr><td><code>green_key</code></td><td>La Clef Verte</td><td>Label environnemental</td><td>Certifi√© / Non certifi√©</td></tr>
                <tr><td><code>eu_ecolabel</code></td><td>√âcolabel Europ√©en</td><td>Label environnemental UE</td><td>Certifi√© / Non certifi√©</td></tr>
                <tr><td><code>tourisme_handicap</code></td><td>Tourisme & Handicap</td><td>Accessibilit√© (multi-s√©lection)</td><td>Moteur, Visuel, Auditif, Mental</td></tr>
              </tbody>
            </table>

            <h4>Exemple concret : H√¥tel 4 √©toiles</h4>
            <div class="card tip-card" style="margin-top: 16px;">
              <div class="pill tip-pill">Exemple</div>
              <pre style="background: var(--code-bg); color: var(--code); padding: 12px; border-radius: 8px; margin: 8px 0; overflow-x: auto;"><code>{
  "classifications": [
    {
      "scheme": "hot_stars",
      "scheme_name": "Classement h√¥telier",
      "value": "4",
      "value_name": "4 √©toiles",
      "awarded_at": "2024-01-15",
      "valid_until": "2025-01-15",
      "status": "active"
    },
    {
      "scheme": "green_key",
      "scheme_name": "La Clef Verte",
      "value": "certified",
      "value_name": "Certifi√©",
      "awarded_at": "2024-03-01",
      "valid_until": "2025-03-01",
      "status": "active"
    }
  ]
}</code></pre>
            </div>

            <h4>Utilisation pratique</h4>
            <div class="card info-card" style="margin-top: 16px;">
              <div class="pill info-pill">Filtrage</div>
              <p><strong>Filtrer par √©toiles :</strong> Utilisez <code>p_filters.classifications_any: ["hot_stars:4"]</code> pour trouver les h√¥tels 4 √©toiles.</p>
              <p><strong>Filtrer par label :</strong> Utilisez <code>p_filters.classifications_any: ["green_key:certified"]</code> pour les √©tablissements √©colabellis√©s.</p>
            </div>

            <div class="card warning-card" style="margin-top: 16px;">
              <div class="pill warning-pill">Important</div>
              <p>Les classifications sont <strong>officielles et v√©rifi√©es</strong>. Elles ne peuvent √™tre modifi√©es que par les organismes comp√©tents via le syst√®me de gestion des labels.</p>
            </div>
          </div>
        </details>

        <details>
          <summary>3.11 <code>handicap_labels[]</code> (accessibilit√©)</summary>
          <div class="content">
            <p>Expose la labellisation ¬´&nbsp;Tourisme &amp; Handicap&nbsp;¬ª pour chaque objet. Les entr√©es sont issues de <code>object_classification</code> avec le sch√©ma <code>HANDICAP_LABEL</code>, les sous-valeurs (<code>subvalue_ids</code>) repr√©sentant les handicaps couverts.</p>
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>scheme</code></td><td><code>object</code></td><td>{ code, name } ‚Äî devrait valoir <code>HANDICAP_LABEL</code> / ¬´&nbsp;Tourisme &amp; Handicap&nbsp;¬ª.</td></tr>
                <tr><td><code>value</code></td><td><code>object</code></td><td>Niveau obtenu { code, name, position } (ex. ¬´&nbsp;Labellis√© 4 handicaps&nbsp;¬ª).</td></tr>
                <tr><td><code>dimensions[]</code></td><td><code>array&lt;object&gt;</code></td><td>Handicaps couverts (moteur, visuel, auditif, mental) r√©solus depuis <code>subvalue_ids</code>.</td></tr>
                <tr><td><code>awarded_at / valid_until</code></td><td><code>date</code></td><td>Dates d‚Äôobtention et d‚Äô√©ch√©ance.</td></tr>
                <tr><td><code>status</code></td><td><code>enum</code></td><td>requested, granted, suspended, expired (suivi cycle de vie).</td></tr>
                <tr><td><code>document</code></td><td><code>object | null</code></td><td>Justificatif { id, title, url } r√©f√©renc√© via <code>ref_document</code>.</td></tr>
                <tr><td><code>source / note</code></td><td><code>string | null</code></td><td>M√©tadonn√©es internes optionnelles.</td></tr>
              </tbody>
            </table>
            <div class="card tip-card" style="margin-top:16px;">
              <div class="pill tip-pill">Exemple</div>
              <pre style="background: var(--code-bg); color: var(--code); padding: 12px; border-radius: 8px; margin: 8px 0; overflow-x: auto;"><code>{
  "handicap_labels": [
    {
      "scheme": { "code": "HANDICAP_LABEL", "name": "Tourisme & Handicap" },
      "value": { "code": "th_level_4", "name": "Labellis√© 4 handicaps", "position": 4 },
      "dimensions": [
        { "code": "HANDICAP_MOTOR", "name": "Moteur" },
        { "code": "HANDICAP_VISUAL", "name": "Visuel" },
        { "code": "HANDICAP_AUDITORY", "name": "Auditif" },
        { "code": "HANDICAP_MENTAL", "name": "Mental" }
      ],
      "awarded_at": "2023-06-15",
      "valid_until": "2026-06-14",
      "status": "granted",
      "document": { "id": "uuid-doc-1", "title": "Attestation 2023", "url": "https://‚Ä¶/attestation.pdf" },
      "note": "Renouvellement 2023"
    }
  ]
}</code></pre>
            </div>
          </div>
        </details>

        <details>
          <summary>3.12 <code>tags[]</code> (√©tiquettes th√©matiques)</summary>
          <div class="content">
            <p>Le bloc <code>tags[]</code> contient des √©tiquettes th√©matiques personnalis√©es pour caract√©riser l'√©tablissement : "romantique", "familial", "luxe", "authentique", etc. Ces tags permettent un filtrage et une cat√©gorisation fine des √©tablissements.</p>
            
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th><th>Exemple</th></tr></thead>
              <tbody>
                <tr><td><code>slug</code></td><td><code>string</code></td><td>Identifiant lisible (URL-friendly)</td><td><code>"romantique"</code></td></tr>
                <tr><td><code>name</code></td><td><code>string</code></td><td>Libell√© affich√©</td><td><code>"Romantique"</code></td></tr>
                <tr><td><code>color</code></td><td><code>string</code></td><td>Couleur d'affichage (CSS/hex)</td><td><code>"#FF6B6B"</code></td></tr>
                <tr><td><code>icon</code></td><td><code>string</code></td><td>Nom/code de l'ic√¥ne</td><td><code>"heart"</code></td></tr>
                <tr><td><code>icon_url</code></td><td><code>string (URL)</code></td><td>URL de l'ic√¥ne</td><td><code>"https://cdn.example.com/heart.svg"</code></td></tr>
              </tbody>
            </table>

            <h4>Types de tags populaires</h4>
            <p>Voici quelques exemples de tags couramment utilis√©s :</p>
            
            <table>
              <thead><tr><th>Slug</th><th>Nom</th><th>Description</th><th>Couleur typique</th></tr></thead>
              <tbody>
                <tr><td><code>romantique</code></td><td>Romantique</td><td>Id√©al pour couples</td><td>#FF6B6B (rose)</td></tr>
                <tr><td><code>familial</code></td><td>Familial</td><td>Adapt√© aux familles</td><td>#4ECDC4 (turquoise)</td></tr>
                <tr><td><code>luxe</code></td><td>Luxe</td><td>√âtablissement haut de gamme</td><td>#FFD93D (dor√©)</td></tr>
                <tr><td><code>authentique</code></td><td>Authentique</td><td>Exp√©rience locale authentique</td><td>#6BCF7F (vert)</td></tr>
                <tr><td><code>ecologique</code></td><td>√âcologique</td><td>Engagement environnemental</td><td>#4D96FF (bleu)</td></tr>
                <tr><td><code>historique</code></td><td>Historique</td><td>Patrimoine historique</td><td>#8B4513 (marron)</td></tr>
                <tr><td><code>moderne</code></td><td>Moderne</td><td>Design contemporain</td><td>#9B59B6 (violet)</td></tr>
                <tr><td><code>tranquille</code></td><td>Tranquille</td><td>Environnement calme</td><td>#95A5A6 (gris)</td></tr>
              </tbody>
            </table>

            <h4>Exemple concret : Tags d'un h√¥tel de charme</h4>
            <div class="card tip-card" style="margin-top: 16px;">
              <div class="pill tip-pill">Exemple</div>
              <pre style="background: var(--code-bg); color: var(--code); padding: 12px; border-radius: 8px; margin: 8px 0; overflow-x: auto;"><code>{
  "tags": [
    {
      "slug": "romantique",
      "name": "Romantique",
      "color": "#FF6B6B",
      "icon": "heart",
      "icon_url": "https://cdn.example.com/heart.svg"
    },
    {
      "slug": "authentique",
      "name": "Authentique",
      "color": "#6BCF7F",
      "icon": "leaf",
      "icon_url": "https://cdn.example.com/leaf.svg"
    },
    {
      "slug": "historique",
      "name": "Historique",
      "color": "#8B4513",
      "icon": "castle",
      "icon_url": "https://cdn.example.com/castle.svg"
    },
    {
      "slug": "tranquille",
      "name": "Tranquille",
      "color": "#95A5A6",
      "icon": "peace",
      "icon_url": "https://cdn.example.com/peace.svg"
    }
  ]
}</code></pre>
            </div>

            <h4>Utilisation pratique</h4>
            <div class="card info-card" style="margin-top: 16px;">
              <div class="pill info-pill">Filtrage</div>
              <p><strong>Filtrer par tags :</strong> Utilisez <code>p_filters.tags_any: ["romantique", "luxe"]</code> pour trouver les √©tablissements romantiques ou de luxe.</p>
              <p><strong>Affichage :</strong> Affichez les tags avec leurs couleurs et ic√¥nes pour une identification visuelle rapide.</p>
              <p><strong>Recherche :</strong> Utilisez les <code>slug</code> pour les URLs et la recherche textuelle.</p>
            </div>

            <div class="card warning-card" style="margin-top: 16px;">
              <div class="pill warning-pill">Important</div>
              <p>Les tags sont <strong>subjectifs et qualitatifs</strong>. Ils refl√®tent l'ambiance et le positionnement de l'√©tablissement plut√¥t que des caract√©ristiques objectives mesurables.</p>
            </div>
          </div>
        </details>

        <details>
          <summary>3.13 <code>meeting_rooms[]</code> (salles de r√©union et √©quipements)</summary>
          <div class="content">
            <p>Le bloc <code>meeting_rooms[]</code> d√©crit les salles de r√©union, de conf√©rence et d'√©v√©nements disponibles dans l'√©tablissement, avec leurs capacit√©s selon diff√©rents formats d'organisation et leurs √©quipements techniques.</p>
            
            <h4>Structure d'une salle de r√©union</h4>
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th><th>Exemple</th></tr></thead>
              <tbody>
                <tr><td><code>name</code></td><td><code>string</code></td><td>Nom de la salle</td><td><code>"Salle des Palmiers"</code></td></tr>
                <tr><td><code>surface</code></td><td><code>number</code></td><td>Surface en m¬≤</td><td><code>120</code></td></tr>
                <tr><td><code>cap_theatre</code></td><td><code>number</code></td><td>Capacit√© en format th√©√¢tre</td><td><code>80</code></td></tr>
                <tr><td><code>cap_u</code></td><td><code>number</code></td><td>Capacit√© en format U</td><td><code>24</code></td></tr>
                <tr><td><code>cap_classroom</code></td><td><code>number</code></td><td>Capacit√© en format classe</td><td><code>40</code></td></tr>
                <tr><td><code>cap_boardroom</code></td><td><code>number</code></td><td>Capacit√© en format conseil</td><td><code>16</code></td></tr>
                <tr><td><code>cap_cocktail</code></td><td><code>number</code></td><td>Capacit√© en format cocktail</td><td><code>100</code></td></tr>
                <tr><td><code>cap_banquet</code></td><td><code>number</code></td><td>Capacit√© en format banquet</td><td><code>60</code></td></tr>
                <tr><td><code>equipment</code></td><td><code>array&lt;object&gt;</code></td><td>√âquipements disponibles</td><td>Voir structure ci-dessous</td></tr>
              </tbody>
            </table>

            <h4>Formats de salle expliqu√©s</h4>
            <p>Les diff√©rentes capacit√©s correspondent aux formats d'organisation d'√©v√©nements :</p>
            
            <table>
              <thead><tr><th>Format</th><th>Description</th><th>Usage typique</th><th>Densit√©</th></tr></thead>
              <tbody>
                <tr><td><code>cap_theatre</code></td><td>Th√©√¢tre (toutes les chaises face √† la sc√®ne)</td><td>Pr√©sentations, conf√©rences</td><td>La plus √©lev√©e</td></tr>
                <tr><td><code>cap_classroom</code></td><td>Classe (tables individuelles face √† l'avant)</td><td>Formations, cours</td><td>√âlev√©e</td></tr>
                <tr><td><code>cap_u</code></td><td>U (tables en forme de U)</td><td>R√©unions interactives</td><td>Moyenne</td></tr>
                <tr><td><code>cap_boardroom</code></td><td>Conseil (table rectangulaire)</td><td>R√©unions de direction</td><td>Faible</td></tr>
                <tr><td><code>cap_cocktail</code></td><td>Cocktail (debout, circulation libre)</td><td>R√©seautage, ap√©ritifs</td><td>Tr√®s √©lev√©e</td></tr>
                <tr><td><code>cap_banquet</code></td><td>Banquet (tables rondes)</td><td>Repas, galas</td><td>Moyenne</td></tr>
              </tbody>
            </table>

            <h4>√âquipements disponibles</h4>
            <p>Le syst√®me supporte plusieurs types d'√©quipements via le r√©f√©rentiel <code>meeting_equipment</code> :</p>
            
            <table>
              <thead><tr><th>Code</th><th>Nom</th><th>Description</th><th>Usage typique</th></tr></thead>
              <tbody>
                <tr><td><code>projector</code></td><td>Vid√©oprojecteur</td><td>Projection d'√©cran</td><td>Pr√©sentations</td></tr>
                <tr><td><code>screen</code></td><td>√âcran de projection</td><td>√âcran fixe ou mobile</td><td>Pr√©sentations</td></tr>
                <tr><td><code>sound_system</code></td><td>Syst√®me audio</td><td>Sonorisation</td><td>Conf√©rences</td></tr>
                <tr><td><code>microphone</code></td><td>Microphone</td><td>Micro fixe ou mobile</td><td>Pr√©sentations</td></tr>
                <tr><td><code>whiteboard</code></td><td>Tableau blanc</td><td>Tableau effa√ßable</td><td>Formations</td></tr>
                <tr><td><code>flipchart</code></td><td>Paperboard</td><td>Tableau √† feuilles</td><td>Brainstorming</td></tr>
                <tr><td><code>wifi</code></td><td>WiFi</td><td>Acc√®s internet</td><td>Connectivit√©</td></tr>
                <tr><td><code>air_conditioning</code></td><td>Climatisation</td><td>Contr√¥le temp√©rature</td><td>Confort</td></tr>
                <tr><td><code>natural_light</code></td><td>√âclairage naturel</td><td>Fen√™tres, lumi√®re du jour</td><td>Confort</td></tr>
                <tr><td><code>catering</code></td><td>Restauration</td><td>Service traiteur</td><td>√âv√©nements</td></tr>
              </tbody>
            </table>

            <h4>Exemple concret : Salle de conf√©rence</h4>
            <div class="card tip-card" style="margin-top: 16px;">
              <div class="pill tip-pill">Exemple</div>
              <pre style="background: var(--code-bg); color: var(--code); padding: 12px; border-radius: 8px; margin: 8px 0; overflow-x: auto;"><code>{
  "meeting_rooms": [
    {
      "name": "Salle des Palmiers",
      "surface": 120,
      "cap_theatre": 80,
      "cap_u": 24,
      "cap_classroom": 40,
      "cap_boardroom": 16,
      "cap_cocktail": 100,
      "cap_banquet": 60,
      "equipment": [
        {
          "code": "projector",
          "name": "Vid√©oprojecteur",
          "icon_url": "https://cdn.example.com/projector.svg"
        },
        {
          "code": "screen",
          "name": "√âcran de projection",
          "icon_url": "https://cdn.example.com/screen.svg"
        },
        {
          "code": "sound_system",
          "name": "Syst√®me audio",
          "icon_url": "https://cdn.example.com/sound.svg"
        },
        {
          "code": "wifi",
          "name": "WiFi",
          "icon_url": "https://cdn.example.com/wifi.svg"
        },
        {
          "code": "air_conditioning",
          "name": "Climatisation",
          "icon_url": "https://cdn.example.com/ac.svg"
        }
      ]
    }
  ]
}</code></pre>
            </div>

            <h4>Utilisation pratique</h4>
            <div class="card info-card" style="margin-top: 16px;">
              <div class="pill info-pill">S√©lection de salle</div>
              <p><strong>Capacit√© :</strong> Choisissez le format selon le type d'√©v√©nement (th√©√¢tre pour pr√©sentation, U pour r√©union interactive).</p>
              <p><strong>√âquipements :</strong> V√©rifiez la disponibilit√© des √©quipements n√©cessaires (projecteur, son, etc.).</p>
              <p><strong>Surface :</strong> Consid√©rez l'espace n√©cessaire pour la circulation et les √©quipements.</p>
            </div>

            <div class="card warning-card" style="margin-top: 16px;">
              <div class="pill warning-pill">Important</div>
              <p>Les capacit√©s indiqu√©es sont <strong>th√©oriques</strong>. La capacit√© r√©elle peut varier selon la configuration, les √©quipements, et les normes de s√©curit√© en vigueur.</p>
            </div>
          </div>
        </details>

        <details>
          <summary>3.14 <code>opening_times</code></summary>
          <div class="content">
            <p>Structure d'horaires d'ouverture organis√©e en deux groupes temporels :</p>
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>PeriodeOuvertures</code></td><td><code>array&lt;object&gt;</code></td><td>P√©riodes d'ouverture pour l'ann√©e courante et suivante</td></tr>
                <tr><td><code>PeriodeOuverturesAnneeSuivantes</code></td><td><code>array&lt;object&gt;</code></td><td>P√©riodes d'ouverture pour les ann√©es suivantes</td></tr>
              </tbody>
            </table>
            
            <h4>Structure d'une p√©riode d'ouverture</h4>
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>ID</code></td><td><code>string</code></td><td>Identifiant unique de la p√©riode</td></tr>
                <tr><td><code>Ordre</code></td><td><code>number</code></td><td>Ordre d'affichage</td></tr>
                <tr><td><code>SyndicObjectId</code></td><td><code>string</code></td><td>Identifiant de l'objet</td></tr>
                <tr><td><code>Datedebut</code></td><td><code>date</code></td><td>Date de d√©but de la p√©riode</td></tr>
                <tr><td><code>Datefin</code></td><td><code>date</code></td><td>Date de fin de la p√©riode</td></tr>
                <tr><td><code>Joursfermeture</code></td><td><code>array&lt;string&gt;</code></td><td>Jours de fermeture (codes des jours)</td></tr>
                <tr><td><code>[jour]heuredebut1/2</code></td><td><code>string</code></td><td>Heures de d√©but des cr√©neaux (ex. "lundiheuredebut1")</td></tr>
                <tr><td><code>[jour]heurefin1/2</code></td><td><code>string</code></td><td>Heures de fin des cr√©neaux (ex. "lundiheurefin1")</td></tr>
              </tbody>
            </table>
            
            <h4>Jours de la semaine</h4>
            <p>Pour chaque jour (lundi, mardi, mercredi, jeudi, vendredi, samedi, dimanche), jusqu'√† 2 cr√©neaux horaires peuvent √™tre d√©finis :</p>
            <ul>
              <li><code>[jour]heuredebut1</code> / <code>[jour]heurefin1</code> : Premier cr√©neau</li>
              <li><code>[jour]heuredebut2</code> / <code>[jour]heurefin2</code> : Deuxi√®me cr√©neau (optionnel)</li>
            </ul>
            
            <div class="card tip-card" style="margin-top: 16px;">
              <div class="pill tip-pill">Exemple</div>
              <pre style="background: var(--code-bg); color: var(--code); padding: 12px; border-radius: 8px; margin: 8px 0; overflow-x: auto;"><code>{
  "PeriodeOuvertures": [
    {
      "ID": "uuid-period-1",
      "Ordre": 1,
      "SyndicObjectId": "OBJ_001",
      "Datedebut": "2024-01-01",
      "Datefin": "2024-12-31",
      "Joursfermeture": [],
      "lundiheuredebut1": "09:00",
      "lundiheurefin1": "18:00",
      "mardiheuredebut1": "09:00",
      "mardiheurefin1": "18:00",
      "mercrediheuredebut1": "09:00",
      "mercrediheurefin1": "12:00",
      "mercrediheuredebut2": "14:00",
      "mercrediheurefin2": "18:00",
      "dimancheheuredebut1": null,
      "dimancheheurefin1": null
    }
  ],
  "PeriodeOuverturesAnneeSuivantes": []
}</code></pre>
            </div>
          </div>
        </details>

        <details>
          <summary>3.15 <code>menus[]</code> (restaurants/√©v√©nements)</summary>
          <div class="content">
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>id</code></td><td><code>string</code></td><td>Identifiant du menu</td></tr>
                <tr><td><code>name</code></td><td><code>string</code></td><td>Nom du menu (ex. "Menu d√©jeuner")</td></tr>
                <tr><td><code>description</code></td><td><code>string</code></td><td>Description du menu</td></tr>
                <tr><td><code>position</code></td><td><code>number</code></td><td>Ordre d'affichage</td></tr>
                <tr><td><code>is_active</code></td><td><code>boolean</code></td><td>Menu actif ?</td></tr>
                <tr><td><code>valid_from / valid_to</code></td><td><code>date</code></td><td>P√©riode de validit√©</td></tr>
                <tr><td><code>items[]</code></td><td><code>array&lt;object&gt;</code></td><td>Articles du menu</td></tr>
              </tbody>
            </table>
            <h4>Articles de menu (<code>items[]</code>)</h4>
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>id</code></td><td><code>string</code></td><td>Identifiant de l'article</td></tr>
                <tr><td><code>name</code></td><td><code>string</code></td><td>Nom du plat</td></tr>
                <tr><td><code>description</code></td><td><code>string</code></td><td>Description du plat</td></tr>
                <tr><td><code>position</code></td><td><code>number</code></td><td>Ordre dans le menu</td></tr>
                <tr><td><code>price_amount / price_amount_max</code></td><td><code>number</code></td><td>Prix (ou fourchette)</td></tr>
                <tr><td><code>price_currency</code></td><td><code>string</code></td><td>Devise (ex. "EUR")</td></tr>
                <tr><td><code>category</code></td><td><code>object</code></td><td>{ id, code, name } (ex. "Entr√©e", "Plat principal")</td></tr>
                <tr><td><code>unit</code></td><td><code>object</code></td><td>{ id, code, name } (ex. "par personne", "par portion")</td></tr>
                <tr><td><code>dietary_tags[]</code></td><td><code>array&lt;object&gt;</code></td><td>Tags alimentaires (v√©g√©tarien, vegan, halal...)</td></tr>
                <tr><td><code>allergens[]</code></td><td><code>array&lt;object&gt;</code></td><td>Allerg√®nes (gluten, arachides, lait...)</td></tr>
                <tr><td><code>media[]</code></td><td><code>array&lt;object&gt;</code></td><td>M√©dias associ√©s au plat (photos, vid√©os...)</td></tr>
              </tbody>
            </table>
            <p><b>Tags & Allerg√®nes</b> : structure <code>{ id, code, name, icon_url }</code></p>
            
            <h4>M√©dias des articles (<code>media[]</code>)</h4>
            <p>Chaque article de menu peut avoir des m√©dias associ√©s (photos, vid√©os, etc.) via la table de liaison <code>object_menu_item_media</code>.</p>
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th><th>Exemple</th></tr></thead>
              <tbody>
                <tr><td><code>id</code></td><td><code>string</code></td><td>Identifiant du m√©dia</td><td><code>"media_123"</code></td></tr>
                <tr><td><code>title</code></td><td><code>string</code></td><td>Titre du m√©dia</td><td><code>"Photo du plat principal"</code></td></tr>
                <tr><td><code>description</code></td><td><code>string</code></td><td>Description du m√©dia</td><td><code>"Vue rapproch√©e du plat"</code></td></tr>
                <tr><td><code>url</code></td><td><code>string (URL)</code></td><td>URL du fichier m√©dia</td><td><code>"https://cdn.example.com/plat.jpg"</code></td></tr>
                <tr><td><code>credit</code></td><td><code>string</code></td><td>Cr√©dit photo/vid√©o</td><td><code>"¬© Restaurant XYZ"</code></td></tr>
                <tr><td><code>width / height</code></td><td><code>number</code></td><td>Dimensions (si connues)</td><td><code>1920, 1080</code></td></tr>
                <tr><td><code>is_main</code></td><td><code>boolean</code></td><td>M√©dia principal de l'article ?</td><td><code>true</code></td></tr>
                <tr><td><code>is_published</code></td><td><code>boolean</code></td><td>M√©dia publi√© ?</td><td><code>true</code></td></tr>
                <tr><td><code>position</code></td><td><code>number</code></td><td>Ordre d'affichage</td><td><code>1</code></td></tr>
                <tr><td><code>media_type</code></td><td><code>object</code></td><td>Type de m√©dia</td><td><code>{ "id": "1", "code": "image", "name": "Image" }</code></td></tr>
              </tbody>
            </table>
            <div class="card tip-card" style="margin-top: 16px;">
              <div class="pill tip-pill">Affichage</div>
              <p>Les m√©dias sont tri√©s par <code>position</code> puis par <code>created_at</code>. Seuls les m√©dias avec <code>is_published: true</code> sont inclus.</p>
            </div>
          </div>
        </details>

        <details>
          <summary>3.16 <code>places[]</code> (+ <code>descriptions[]</code>)</summary>
          <div class="content">
            <p>Colonnes du lieu (id, nom, position, ‚Ä¶).</p>
            <p><code>descriptions[]</code> : multilingue ‚Äî structure transparente (ex. <code>language</code>, <code>text</code>, <code>position</code>, ‚Ä¶).</p>
          </div>
        </details>

        <details>
          <summary>3.17 <code>sustainability_action_labels[]</code></summary>
          <div class="content">
            <p>Associe les actions de durabilit√© et les labels obtenus.</p>
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>object_action_id</code></td><td><code>string</code></td><td>Identifiant de l‚Äôaction</td></tr>
                <tr><td><code>action</code></td><td><code>object</code></td><td>{ code, label, description, icon_url, category{‚Ä¶}, position }</td></tr>
                <tr><td><code>label</code></td><td><code>object</code></td><td>{ scheme_code, scheme_name, value_code, value_name, awarded_at, valid_until, status }</td></tr>
              </tbody>
            </table>
          </div>
        </details>

        <details>
          <summary>3.18 <code>incoming_relations[]</code> & <code>outgoing_relations[]</code></summary>
          <div class="content">
            <p>Les relations sont expos√©es par <strong>sens</strong> pour plus de clart√©¬†: <code>outgoing_relations[]</code> (liens sortants) et <code>incoming_relations[]</code> (liens entrants). Chaque entr√©e fournit le type de relation et les m√©tadonn√©es n√©cessaires.</p>
            <ul>
              <li><b>outgoing_relations[]</b>¬†: l'objet courant pointe vers une autre ressource expos√©e sous <code>target: { id, type, name }</code>.</li>
              <li><b>incoming_relations[]</b>¬†: une autre ressource r√©f√©rence l'objet courant, expos√©e sous <code>source: { id, type, name }</code>.</li>
            </ul>
            <p>Chaque enregistrement conserve les m√©tadonn√©es du lien (<code>id</code>, <code>relation_type_id</code>, <code>distance_m</code>, <code>note</code>, <code>position</code>, <code>created_at</code>, <code>updated_at</code>) et ajoute le n≈ìud oppos√© d√©j√† r√©solu (<code>target</code> ou <code>source</code>).</p>
            <p>Pour interpr√©ter le type de relation, mappez <code>relation_type_id</code> avec la table de r√©f√©rence <code>ref_object_relation_type</code> (code, libell√©, description). Les champs <code>distance_m</code> et <code>note</code> restent optionnels et peuvent √™tre utilis√©s pour afficher une distance ou un commentaire √©ditorial.</p>
            <div class="card tip-card" style="margin-top: 16px;">
              <div class="pill tip-pill">Exemple</div>
              <pre style="background: var(--code-bg); color: var(--code); padding: 12px; border-radius: 8px; margin: 8px 0; overflow-x: auto;"><code>{
  "outgoing_relations": [
    {
  "id": "uuid-relation-1",
  "relation_type_id": "uuid-type-restaurant",
  "position": 1,
  "note": null,
  "distance_m": 120.0,
  "created_at": "2024-03-12T09:15:00Z",
  "updated_at": "2024-03-12T09:15:00Z",
  "target": { "id": "RES-001", "type": "RES", "name": "Restaurant Chez L√©on" }
    }
  ],
  "incoming_relations": [
    {
      "id": "uuid-relation-2",
      "relation_type_id": "uuid-type-managed-by",
      "position": 1,
      "note": null,
      "distance_m": null,
      "created_at": "2024-03-12T09:15:00Z",
      "updated_at": "2024-03-12T09:15:00Z",
      "source": { "id": "ORG-456", "type": "ORG", "name": "Organisation Parent" }
    }
  ]
}</code></pre>
            </div>
            <p class="inline-help">Les objets li√©s ne sont pas √©tendus‚ÄØ: interrogez s√©par√©ment l'identifiant fourni si vous avez besoin de leurs contacts, adresses ou m√©dias.</p>
            <p class="inline-help"><b>Cas d'usage :</b> un objet ¬´¬†Restaurant¬†¬ª rattach√© √† un ¬´¬†H√¥tel¬†¬ª aura un enregistrement dans <code>outgoing_relations[]</code> pointant vers l'h√¥tel. Inversement, l'h√¥tel verra ce restaurant appara√Ætre dans <code>incoming_relations[]</code>.</p>
          </div>
        </details>

        <details>
          <summary>3.19 <code>discounts[]</code></summary>
          <div class="content">
            <p>Liste des r√©ductions et offres sp√©ciales propos√©es par l'objet.</p>
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>id</code></td><td><code>string</code></td><td>Identifiant unique de la r√©duction</td></tr>
                <tr><td><code>name</code></td><td><code>string</code></td><td>Nom de l'offre</td></tr>
                <tr><td><code>description</code></td><td><code>string</code></td><td>Description d√©taill√©e</td></tr>
                <tr><td><code>discount_percent</code></td><td><code>number</code></td><td>Pourcentage de r√©duction (0-100)</td></tr>
                <tr><td><code>discount_amount</code></td><td><code>number</code></td><td>Montant de r√©duction fixe</td></tr>
                <tr><td><code>currency</code></td><td><code>string</code></td><td>Devise (ISO 4217)</td></tr>
                <tr><td><code>conditions</code></td><td><code>string</code></td><td>Conditions d'application</td></tr>
                <tr><td><code>valid_from / valid_to</code></td><td><code>date</code></td><td>P√©riode de validit√©</td></tr>
                <tr><td><code>is_active</code></td><td><code>boolean</code></td><td>Offre active ?</td></tr>
                <tr><td><code>position</code></td><td><code>number</code></td><td>Ordre d'affichage</td></tr>
              </tbody>
            </table>
            <div class="card tip-card" style="margin-top: 16px;">
              <div class="pill tip-pill">Exemple</div>
              <pre style="background: var(--code-bg); color: var(--code); padding: 12px; border-radius: 8px; margin: 8px 0; overflow-x: auto;"><code>{
  "discounts": [
    {
      "id": "discount-1",
      "name": "R√©duction s√©niors",
      "description": "10% de r√©duction pour les plus de 65 ans",
      "discount_percent": 10.0,
      "discount_amount": null,
      "currency": "EUR",
      "conditions": "Sur pr√©sentation d'une pi√®ce d'identit√©",
      "valid_from": "2024-01-01",
      "valid_to": "2024-12-31",
      "is_active": true,
      "position": 1
    }
  ]
}</code></pre>
            </div>
          </div>
        </details>

        <details>
          <summary>3.20 <code>group_policies[]</code></summary>
          <div class="content">
            <p>Politiques et conditions sp√©cifiques aux groupes.</p>
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>id</code></td><td><code>string</code></td><td>Identifiant unique de la politique</td></tr>
                <tr><td><code>name</code></td><td><code>string</code></td><td>Nom de la politique</td></tr>
                <tr><td><code>description</code></td><td><code>string</code></td><td>Description d√©taill√©e</td></tr>
                <tr><td><code>min_size</code></td><td><code>number</code></td><td>Taille minimale du groupe</td></tr>
                <tr><td><code>max_size</code></td><td><code>number</code></td><td>Taille maximale du groupe</td></tr>
                <tr><td><code>notes</code></td><td><code>string</code></td><td>Notes et conditions particuli√®res</td></tr>
                <tr><td><code>is_active</code></td><td><code>boolean</code></td><td>Politique active ?</td></tr>
                <tr><td><code>position</code></td><td><code>number</code></td><td>Ordre d'affichage</td></tr>
              </tbody>
            </table>
            <div class="card tip-card" style="margin-top: 16px;">
              <div class="pill tip-pill">Exemple</div>
              <pre style="background: var(--code-bg); color: var(--code); padding: 12px; border-radius: 8px; margin: 8px 0; overflow-x: auto;"><code>{
  "group_policies": [
    {
      "id": "policy-1",
      "name": "Groupes scolaires",
      "description": "Tarifs pr√©f√©rentiels pour les groupes scolaires",
      "min_size": 15,
      "max_size": 50,
      "notes": "R√©servation obligatoire 48h √† l'avance",
      "is_active": true,
      "position": 1
    }
  ]
}</code></pre>
            </div>
          </div>
        </details>

        <details>
          <summary>3.21 <code>actors[]</code></summary>
          <div class="content">
            <p>Acteurs (personnes physiques) li√©s √† l'objet avec leurs r√¥les et contacts. <strong>Important :</strong> Les r√¥les sont d√©finis par le r√©f√©rentiel <code>ref_actor_role</code> qui d√©termine les codes et libell√©s des fonctions (director, receptionist, guide, etc.).</p>
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>id</code></td><td><code>string</code></td><td>Identifiant unique de l'acteur</td></tr>
                <tr><td><code>display_name</code></td><td><code>string</code></td><td>Nom d'affichage complet</td></tr>
                <tr><td><code>first_name</code></td><td><code>string</code></td><td>Pr√©nom</td></tr>
                <tr><td><code>last_name</code></td><td><code>string</code></td><td>Nom de famille</td></tr>
                <tr><td><code>gender</code></td><td><code>enum</code></td><td>Genre (M, F, O)</td></tr>
                <tr><td><code>role</code></td><td><code>object</code></td><td>R√¥le de l'acteur : { id, code, name } - Le <code>code</code> correspond √† <code>ref_actor_role.code</code></td></tr>
                <tr><td><code>is_primary</code></td><td><code>boolean</code></td><td>Acteur principal ?</td></tr>
                <tr><td><code>valid_from / valid_to</code></td><td><code>date</code></td><td>P√©riode de validit√© du r√¥le</td></tr>
                <tr><td><code>visibility</code></td><td><code>enum</code></td><td>Visibilit√© (public, private)</td></tr>
                <tr><td><code>note</code></td><td><code>string</code></td><td>Note ou commentaire</td></tr>
                <tr><td><code>contacts</code></td><td><code>array&lt;object&gt;</code></td><td>Canaux de contact de l'acteur</td></tr>
              </tbody>
            </table>
            
            <h4>R√¥les d'acteurs (<code>ref_actor_role</code>)</h4>
            <p>Le champ <code>role.code</code> fait r√©f√©rence au r√©f√©rentiel <code>ref_actor_role</code> qui d√©finit les types de r√¥les disponibles dans le syst√®me.</p>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th><th>Usage typique</th></tr></thead>
              <tbody>
                <tr><td><code>director</code></td><td>Directeur</td><td>Responsable de l'√©tablissement</td><td>H√¥tels, restaurants, attractions</td></tr>
                <tr><td><code>receptionist</code></td><td>R√©ceptionniste</td><td>Accueil et service client</td><td>H√¥tels, offices de tourisme</td></tr>
                <tr><td><code>guide</code></td><td>Guide</td><td>Guide touristique ou accompagnateur</td><td>Agences, sites touristiques</td></tr>
                <tr><td><code>manager</code></td><td>Gestionnaire</td><td>Responsable op√©rationnel</td><td>√âtablissements divers</td></tr>
                <tr><td><code>chef</code></td><td>Chef</td><td>Chef de cuisine</td><td>Restaurants, h√¥tels</td></tr>
                <tr><td><code>owner</code></td><td>Propri√©taire</td><td>Propri√©taire de l'√©tablissement</td><td>Petits commerces, g√Ætes</td></tr>
              </tbody>
            </table>
            <div class="card info-card" style="margin-top: 16px;">
              <div class="pill info-pill">R√©f√©rentiel</div>
              <p>Le r√©f√©rentiel <code>ref_actor_role</code> est consultable via l'API pour obtenir la liste compl√®te des r√¥les disponibles et leurs libell√©s multilingues.</p>
            </div>
            
            <div class="card tip-card" style="margin-top: 16px;">
              <div class="pill tip-pill">Exemple</div>
              <pre style="background: var(--code-bg); color: var(--code); padding: 12px; border-radius: 8px; margin: 8px 0; overflow-x: auto;"><code>{
  "actors": [
    {
      "id": "actor-123",
      "display_name": "Marie Martin",
      "first_name": "Marie",
      "last_name": "Martin",
      "gender": "F",
      "role": {
        "id": "role-director",
        "code": "director",
        "name": "Directeur"
      },
      "is_primary": true,
      "valid_from": "2024-01-01",
      "valid_to": "2024-12-31",
      "visibility": "public",
      "note": "Responsable principal",
      "contacts": [
        {
          "id": "contact-1",
          "kind": {
            "code": "email",
            "name": "Email"
          },
          "value": "marie.martin@hotel.com",
          "is_primary": true,
          "role": {
            "code": "work",
            "name": "Professionnel"
          }
        }
      ]
    }
  ]
}</code></pre>
            </div>
          </div>
        </details>

        <details>
          <summary>3.22 <code>legal_records[]</code></summary>
          <div class="content">
            <p>Enregistrements l√©gaux et certifications officielles de l'√©tablissement.</p>
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>id</code></td><td><code>string</code></td><td>Identifiant unique de l'enregistrement</td></tr>
                <tr><td><code>type</code></td><td><code>object</code></td><td>Type de document : { id, code, name, category }</td></tr>
                <tr><td><code>value</code></td><td><code>string</code></td><td>Valeur du document (num√©ro, r√©f√©rence)</td></tr>
                <tr><td><code>status</code></td><td><code>enum</code></td><td>Statut (active, expired, pending, suspended)</td></tr>
                <tr><td><code>valid_from / valid_to</code></td><td><code>date</code></td><td>P√©riode de validit√©</td></tr>
                <tr><td><code>validity_mode</code></td><td><code>enum</code></td><td>Mode de validit√© (fixed_end_date, tacit_renewal, forever)</td></tr>
                <tr><td><code>issuer</code></td><td><code>string</code></td><td>Organisme √©metteur</td></tr>
                <tr><td><code>document</code></td><td><code>object</code></td><td>Justificatif : { id, url, title, visibility }</td></tr>
                <tr><td><code>notes</code></td><td><code>string</code></td><td>Notes et commentaires</td></tr>
                <tr><td><code>created_at / updated_at</code></td><td><code>timestamp</code></td><td>Horodatage</td></tr>
              </tbody>
            </table>
            <div class="card tip-card" style="margin-top: 16px;">
              <div class="pill tip-pill">Exemple</div>
              <pre style="background: var(--code-bg); color: var(--code); padding: 12px; border-radius: 8px; margin: 8px 0; overflow-x: auto;"><code>{
  "legal_records": [
    {
      "id": "legal-1",
      "type": {
        "id": "type-siret",
        "code": "SIRET",
        "name": "SIRET",
        "category": "business"
      },
      "value": "12345678901234",
      "status": "active",
      "valid_from": "2024-01-01",
      "valid_to": null,
      "validity_mode": "forever",
      "issuer": "INSEE",
      "document": {
        "id": "doc-1",
        "url": "https://.../siret.pdf",
        "title": "Extrait SIRET",
        "visibility": "private"
      },
      "notes": "Mise √† jour 2024",
      "created_at": "2024-01-15T10:30:00Z",
      "updated_at": "2024-01-15T10:30:00Z"
    }
  ]
}</code></pre>
            </div>
          </div>
        </details>

        <details>
          <summary>3.23 <code>render</code> (donn√©es format√©es)</summary>
          <div class="content">
            <p>Bloc contenant des donn√©es format√©es pr√™tes √† l'affichage, g√©n√©r√© quand <code>p_options.render: true</code>.</p>
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>lang</code></td><td><code>string</code></td><td>Code langue (ex. "fr")</td></tr>
                <tr><td><code>locale</code></td><td><code>string</code></td><td>Locale compl√®te (ex. "fr-FR")</td></tr>
                <tr><td><code>timezone</code></td><td><code>string</code></td><td>Fuseau horaire (ex. "UTC")</td></tr>
                <tr><td><code>version</code></td><td><code>string</code></td><td>Version du formatage (ex. "1.0")</td></tr>
                <tr><td><code>contact_lines</code></td><td><code>array&lt;string&gt;</code></td><td>Lignes de contact format√©es</td></tr>
                <tr><td><code>media_lines</code></td><td><code>array&lt;string&gt;</code></td><td>Lignes de m√©dias format√©es</td></tr>
                <tr><td><code>capacity_lines</code></td><td><code>array&lt;string&gt;</code></td><td>Lignes de capacit√© format√©es</td></tr>
                <tr><td><code>amenity_lines</code></td><td><code>array&lt;string&gt;</code></td><td>Lignes d'√©quipements format√©es</td></tr>
                <tr><td><code>price_lines</code></td><td><code>array&lt;string&gt;</code></td><td>Lignes de tarifs format√©es</td></tr>
                <tr><td><code>classification_lines</code></td><td><code>array&lt;string&gt;</code></td><td>Lignes de classements format√©es</td></tr>
                <tr><td><code>discount_lines</code></td><td><code>array&lt;string&gt;</code></td><td>Lignes de r√©ductions format√©es</td></tr>
                <tr><td><code>group_policy_lines</code></td><td><code>array&lt;string&gt;</code></td><td>Lignes de politiques de groupe format√©es</td></tr>
                <tr><td><code>actor_lines</code></td><td><code>array&lt;string&gt;</code></td><td>Lignes d'acteurs format√©es</td></tr>
                <tr><td><code>legal_record_lines</code></td><td><code>array&lt;string&gt;</code></td><td>Lignes d'enregistrements l√©gaux format√©es</td></tr>
                <tr><td><code>menu_item_lines</code></td><td><code>array&lt;string&gt;</code></td><td>Lignes d'articles de menu format√©es</td></tr>
              </tbody>
            </table>
            <div class="card tip-card" style="margin-top: 16px;">
              <div class="pill tip-pill">Exemple</div>
              <pre style="background: var(--code-bg); color: var(--code); padding: 12px; border-radius: 8px; margin: 8px 0; overflow-x: auto;"><code>{
  "render": {
    "lang": "fr",
    "locale": "fr-FR",
    "timezone": "UTC",
    "version": "1.0",
    "contact_lines": [
      "T√©l√©phone : +262 123 456 789",
      "Email : contact@hotel.com"
    ],
    "media_lines": [
      "Photo principale : Vue de la plage",
      "Vid√©o : Pr√©sentation de l'h√¥tel"
    ],
    "capacity_lines": [
      "Chambres : 42",
      "Lits : 84"
    ],
    "amenity_lines": [
      "Piscine, WiFi, Parking"
    ],
    "price_lines": [
      "Adulte - Par nuit : 120,00 ‚Ç¨",
      "Enfant - Par nuit : 60,00 ‚Ç¨"
    ]
  }
}</code></pre>
            </div>
          </div>
        </details>

        <details>
          <summary>3.24 Sp√©cifique Itin√©raire (<code>type="ITI"</code>)</summary>
          <div class="content">
            <h3><code>itinerary_details</code></h3>
            <ul>
              <li><code>info</code> : m√©ta (ex. conseils, profils altim√©triques d√©taill√©s‚Ä¶)</li>
              <li><code>profiles[]</code> : variantes / tron√ßons alternatifs</li>
              <li><code>practices[]</code> : { code, name, icon_url } (ex. "hiking", "mtb")</li>
              <li><code>sections[]</code> : segments/tron√ßons</li>
              <li><code>stages[]</code> : √©tapes (avec leur propre <code>media[]</code>)</li>
              <li><code>associated_objects[]</code> : voir ci-dessous pour la structure d√©taill√©e</li>
            </ul>

            <h4 style="margin-top: 18px;"><code>associated_objects[]</code></h4>
            <p>Liste les ressources li√©es √† l‚Äôitin√©raire (h√©bergements, points d‚Äôint√©r√™t, services‚Ä¶) avec le r√¥le attribu√© dans l‚Äô√©tape de production.</p>
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>associated_object_id</code></td><td><code>string</code></td><td>Identifiant de l‚Äôobjet li√© (identique √† <code>target.id</code>, conserv√© pour compatibilit√©)</td></tr>
                <tr><td><code>target</code></td><td><code>object | null</code></td><td>{ <code>id</code>, <code>type</code>, <code>name</code> } r√©solu automatiquement ; peut √™tre <code>null</code> si l‚Äôobjet n‚Äôest plus publi√©</td></tr>
                <tr><td><code>role_id</code></td><td><code>uuid</code></td><td>R√¥le √©ditorial attribu√© (mapper via <code>ref_iti_assoc_role</code> pour r√©cup√©rer code/libell√©)</td></tr>
                <tr><td><code>note</code></td><td><code>string | null</code></td><td>Commentaire libre (ex. conseil d‚Äô√©tape)</td></tr>
                <tr><td><code>created_at</code></td><td><code>timestamp</code></td><td>Date de cr√©ation du lien</td></tr>
                <tr><td><code>updated_at</code></td><td><code>timestamp</code></td><td>Derni√®re mise √† jour du lien</td></tr>
              </tbody>
            </table>
            <p class="inline-help">Les √©l√©ments sont tri√©s par nom d‚Äôobjet puis date de cr√©ation. Si l‚Äôobjet cible a √©t√© supprim√©, <code>target</code> vaut <code>null</code> mais l‚Äôidentifiant brut reste disponible pour diagnostic.</p>
            <p class="inline-help">Le r√©f√©rentiel <code>ref_iti_assoc_role</code> expose les colonnes <code>{ id, code, name, description, position }</code> : utilisez-le pour afficher un libell√© utilisateur.</p>
            <div class="card tip-card" style="margin-top: 16px;">
              <div class="pill tip-pill">Exemple</div>
              <pre style="background: var(--code-bg); color: var(--code); padding: 12px; border-radius: 8px; margin: 8px 0; overflow-x: auto;"><code>"associated_objects": [
  {
    "associated_object_id": "LODGE-42",
    "role_id": "0ab5d76a-55f9-4bdc-9219-6a962fbf9c5d",
    "note": "H√©bergement recommand√© pour la nuit 2",
    "created_at": "2024-05-06T08:12:11Z",
    "updated_at": "2024-05-14T10:33:02Z",
    "target": { "id": "LODGE-42", "type": "HOT", "name": "Lodge des Cimes" }
  }
]</code></pre>
            </div>
            <h3><code>itinerary</code></h3>
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>distance_km</code></td><td><code>number</code></td><td>Distance totale (km)</td></tr>
                <tr><td><code>duration_hours</code></td><td><code>number</code></td><td>Dur√©e moyenne (h)</td></tr>
                <tr><td><code>difficulty_level</code></td><td><code>number</code></td><td>Niveau (√©chelle interne)</td></tr>
                <tr><td><code>elevation_gain</code></td><td><code>number</code></td><td>D√©nivel√© + (m)</td></tr>
                <tr><td><code>is_loop</code></td><td><code>boolean</code></td><td>Boucle ?</td></tr>
                <tr><td><code>track</code></td><td><code>string | null</code></td><td>KML/GPX (XML texte) ‚Äî uniquement si demand√©</td></tr>
                <tr><td><code>track_format</code></td><td><code>"kml" | "gpx" | null</code></td><td>Format du trac√© si pr√©sent</td></tr>
              </tbody>
            </table>
            <p class="inline-help"><b>Rappels trac√©</b> ‚Äî Par d√©faut <code>track=null</code>. Pour obtenir un trac√©, d√©finissez <code>p_track_format</code> √† <code>"kml"</code> ou <code>"gpx"</code>. <b>KML</b> : utilisez <code>p_options.stage_color</code> si vous incluez des √©tapes. <b>GPX</b> : <code>stage_color</code> ignor√©e.</p>
          </div>
        </details>

        <details>
          <summary>3.25 Sp√©cifique √âv√©nement (<code>type="FMA"</code>)</summary>
          <div class="content">
            <p>Les √©v√©nements peuvent agr√©ger les types de cuisine propos√©s par leurs restaurants partenaires via le bloc <code>associated_restaurants_cuisine_types[]</code>.</p>
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>id</code></td><td><code>string</code></td><td>Identifiant du type de cuisine</td></tr>
                <tr><td><code>code</code></td><td><code>string</code></td><td>Code fonctionnel (ex. <code>"veggie"</code>)</td></tr>
                <tr><td><code>name</code></td><td><code>string</code></td><td>Libell√© affich√©</td></tr>
                <tr><td><code>description</code></td><td><code>string | null</code></td><td>Description optionnelle</td></tr>
                <tr><td><code>position</code></td><td><code>number | null</code></td><td>Ordre conseill√© du r√©f√©rentiel</td></tr>
              </tbody>
            </table>
            <p>Le tableau est d√©dupliqu√© et ne contient que les types pr√©sents dans au moins un menu actif d'un restaurant li√© via la relation <code>has_restaurant</code>. Les √©l√©ments sont tri√©s selon le r√©f√©rentiel (position puis nom/code).</p>
            <div class="card tip-card" style="margin-top: 16px;">
              <div class="pill tip-pill">Exemple</div>
              <pre style="background: var(--code-bg); color: var(--code); padding: 12px; border-radius: 8px; margin: 8px 0; overflow-x: auto;"><code>"associated_restaurants_cuisine_types": [
  { "id": "uuid-ct-1", "code": "local", "name": "Cuisine locale", "description": null, "position": 10 },
  { "id": "uuid-ct-2", "code": "veggie", "name": "Option v√©g√©tarienne", "description": null, "position": 40 }
]</code></pre>
            </div>
            <p class="inline-help">Si aucun restaurant associ√© ne publie de menu actif, le tableau est vide.</p>
          </div>
        </details>


        <details>
          <summary>3.26 <code>documents[]</code> (r√©f√©rentiel partag√©)</summary>
          <div class="content">
            <p>Ce tableau regroupe l‚Äôensemble des pi√®ces justificatives expos√©es par l‚ÄôAPI (qu‚Äôelles soient li√©es √† la fiche l√©gale, √† une classification ou √† une action RSE). Chaque entr√©e correspond √† un enregistrement de <code>ref_document</code> reli√© √† l‚Äôobjet.</p>
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>id</code></td><td><code>string</code></td><td>Identifiant unique du document</td></tr>
                <tr><td><code>url</code></td><td><code>string</code></td><td>URL de t√©l√©chargement (soumise aux contr√¥les de visibilit√©)</td></tr>
                <tr><td><code>title</code></td><td><code>string|null</code></td><td>Titre humain affichable</td></tr>
                <tr><td><code>issuer</code></td><td><code>string|null</code></td><td>Source officielle</td></tr>
                <tr><td><code>description</code></td><td><code>string|null</code></td><td>Notes compl√©mentaires</td></tr>
                <tr><td><code>valid_from / valid_to</code></td><td><code>date|null</code></td><td>P√©riode de validit√©</td></tr>
                <tr><td><code>visibility</code></td><td><code>enum</code></td><td><code>"public"</code> ou <code>"private"</code></td></tr>
                <tr><td><code>position</code></td><td><code>number|null</code></td><td>Ordre d‚Äôaffichage sugg√©r√©</td></tr>
                <tr><td><code>tags</code></td><td><code>array&lt;string&gt;</code></td><td>Raccourcis m√©tiers (ex. <code>["legal", "rse"]</code>)</td></tr>
              </tbody>
            </table>

            <div class="card tip-card" style="margin-top: 16px;">
              <div class="pill tip-pill">Exemple</div>
              <pre style="background: var(--code-bg); color: var(--code); padding: 12px; border-radius: 8px; margin: 8px 0; overflow-x: auto;"><code>"documents": [
  {
    "id": "0518c3c1-6f35-40f0-bd26-19ccaf7bc93a",
    "url": "https://cdn.example.tld/docs/certificat-accessibilite.pdf",
    "title": "Certificat accessibilit√© 2025",
    "issuer": "Pr√©fecture",
    "description": "Valable jusqu'au 31/12/2025",
    "valid_from": "2024-01-01",
    "valid_to": "2025-12-31",
    "visibility": "public",
    "position": 1,
    "tags": ["legal", "handicap"]
  }
]</code></pre>
            </div>

            <div class="card info-card" style="margin-top: 12px;">
              <div class="pill info-pill">Agr√©gation</div>
              <p>Le tableau est d√©dupliqu√© c√¥t√© SQL afin d‚Äô√©viter d‚Äôexposer plusieurs fois la m√™me ressource lorsqu‚Äôelle est utilis√©e √† la fois pour un classement et pour la fiche l√©gale. Les doublons sont fusionn√©s sur l‚Äôidentifiant de document.</p>
            </div>
          </div>
        </details>

        <details>
          <summary>3.27 <code>document_requests[]</code> (suivi des pi√®ces)</summary>
          <div class="content">
            <p>Ce bloc retrace la vie des demandes de documents m√©tiers : qui a demand√© quoi, quand l‚Äôobjet a fourni la pi√®ce et si la visibilit√© est publique ou r√©serv√©e. Les informations proviennent du module de suivi <code>document_request</code>.</p>
            <table>
              <thead><tr><th>Champ</th><th>Type</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>id</code></td><td><code>string</code></td><td>Identifiant unique de la demande</td></tr>
                <tr><td><code>document_id</code></td><td><code>string</code></td><td>R√©f√©rence vers <code>documents[]</code> / <code>ref_document</code></td></tr>
                <tr><td><code>status</code></td><td><code>enum</code></td><td><code>"requested"</code>, <code>"received"</code>, <code>"expired"</code>, <code>"rejected"</code>‚Ä¶</td></tr>
                <tr><td><code>requested_at</code></td><td><code>timestamp</code></td><td>Date/heure de la demande</td></tr>
                <tr><td><code>due_at</code></td><td><code>timestamp|null</code></td><td>√âch√©ance attendue (optionnelle)</td></tr>
                <tr><td><code>delivered_at</code></td><td><code>timestamp|null</code></td><td>Date de r√©ception de la pi√®ce</td></tr>
                <tr><td><code>visibility</code></td><td><code>enum</code></td><td>Align√©e sur la visibilit√© du document remis</td></tr>
                <tr><td><code>requested_by</code></td><td><code>string|null</code></td><td>Identit√© (email ou service) √† l‚Äôorigine de la demande</td></tr>
                <tr><td><code>notes</code></td><td><code>string|null</code></td><td>Commentaire interne sur la demande</td></tr>
              </tbody>
            </table>

            <div class="card tip-card" style="margin-top: 16px;">
              <div class="pill tip-pill">Exemple</div>
              <pre style="background: var(--code-bg); color: var(--code); padding: 12px; border-radius: 8px; margin: 8px 0; overflow-x: auto;"><code>"document_requests": [
  {
    "id": "dreq-2025-04",
    "document_id": "0518c3c1-6f35-40f0-bd26-19ccaf7bc93a",
    "status": "received",
    "requested_at": "2025-02-01T08:15:00Z",
    "due_at": "2025-03-01T00:00:00Z",
    "delivered_at": "2025-02-10T14:22:11Z",
    "visibility": "public",
    "requested_by": "legal@oti-sud.fr",
    "notes": "Document contr√¥l√© et valid√©"
  }
]</code></pre>
            </div>

            <div class="card info-card" style="margin-top: 12px;">
              <div class="pill info-pill">Usage</div>
              <p>Les applications clientes peuvent exploiter ce flux pour relancer automatiquement les partenaires ou afficher l‚Äôhistorique des justificatifs attendus. Les statuts et horodatages sont mis √† jour par les fonctions SQL d√©di√©es au module documentaire.</p>
            </div>
          </div>
        </details>
      </section>

      <!-- 4) Types de r√©f√©rence -->
      <section class="card" id="reference-types">
        <h2>4) Types de r√©f√©rence</h2>
        <div class="content">
          <p>R√©f√©rentiels utilis√©s pour les filtres et l'interpr√©tation des donn√©es de sortie.</p>
            
            <h4><code>accommodation_type</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>hotel</code></td><td>H√¥tel</td><td>√âtablissement h√¥telier classique</td></tr>
                <tr><td><code>gite</code></td><td>G√Æte</td><td>G√Æte rural, g√Æte d'√©tape</td></tr>
                <tr><td><code>camping</code></td><td>Camping</td><td>Camping, aire de camping-car</td></tr>
                <tr><td><code>chambre_hote</code></td><td>Chambre d'h√¥te</td><td>Chambre d'h√¥te, B&B</td></tr>
                <tr><td><code>residence</code></td><td>R√©sidence</td><td>R√©sidence de tourisme</td></tr>
                <tr><td><code>auberge</code></td><td>Auberge</td><td>Auberge de jeunesse</td></tr>
              </tbody>
            </table>

            <h4><code>room_type</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>single</code></td><td>Chambre simple</td><td>1 lit simple</td></tr>
                <tr><td><code>double</code></td><td>Chambre double</td><td>1 lit double</td></tr>
                <tr><td><code>twin</code></td><td>Chambre twin</td><td>2 lits simples</td></tr>
                <tr><td><code>triple</code></td><td>Chambre triple</td><td>3 lits</td></tr>
                <tr><td><code>family</code></td><td>Chambre familiale</td><td>4+ lits</td></tr>
                <tr><td><code>suite</code></td><td>Suite</td><td>Suite de luxe</td></tr>
              </tbody>
            </table>

            <h4><code>tourism_type</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>cultural</code></td><td>Culturel</td><td>Mus√©es, monuments, patrimoine</td></tr>
                <tr><td><code>nature</code></td><td>Nature</td><td>Parcs, randonn√©es, observation</td></tr>
                <tr><td><code>adventure</code></td><td>Aventure</td><td>Sports extr√™mes, activit√©s</td></tr>
                <tr><td><code>wellness</code></td><td>Bien-√™tre</td><td>Spa, relaxation, thermalisme</td></tr>
                <tr><td><code>gastronomy</code></td><td>Gastronomie</td><td>D√©gustation, cuisine locale</td></tr>
                <tr><td><code>business</code></td><td>Affaires</td><td>Congr√®s, s√©minaires</td></tr>
              </tbody>
            </table>

            <h4><code>ref_legal_type</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Cat√©gorie</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>SIRET</code></td><td>SIRET</td><td>business</td><td>Num√©ro SIRET de l'entreprise</td></tr>
                <tr><td><code>SIREN</code></td><td>SIREN</td><td>business</td><td>Num√©ro SIREN de l'entreprise</td></tr>
                <tr><td><code>VAT</code></td><td>N¬∞ TVA</td><td>business</td><td>Num√©ro de TVA intracommunautaire</td></tr>
                <tr><td><code>LICENSE</code></td><td>Licence</td><td>accommodation</td><td>Licence d'exploitation</td></tr>
                <tr><td><code>TAX_SEJOUR</code></td><td>Taxe de s√©jour</td><td>accommodation</td><td>Enregistrement taxe de s√©jour</td></tr>
                <tr><td><code>INSURANCE</code></td><td>Assurance</td><td>business</td><td>Police d'assurance</td></tr>
                <tr><td><code>PERMIT</code></td><td>Autorisation</td><td>business</td><td>Permis d'exploitation</td></tr>
              </tbody>
            </table>

            <h4><code>legal_validity_mode</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>fixed_end_date</code></td><td>Date de fin fixe</td><td>Le document expire √† une date pr√©cise</td></tr>
                <tr><td><code>tacit_renewal</code></td><td>Renouvellement tacite</td><td>Le document se renouvelle automatiquement</td></tr>
                <tr><td><code>forever</code></td><td>Permanent</td><td>Le document n'a pas de date d'expiration</td></tr>
              </tbody>
            </table>

            <h4><code>ref_capacity_metric</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>beds</code></td><td>Lits</td><td>Nombre de lits disponibles</td></tr>
                <tr><td><code>rooms</code></td><td>Chambres</td><td>Nombre de chambres</td></tr>
                <tr><td><code>max_capacity</code></td><td>Capacit√© max</td><td>Capacit√© maximale d'accueil</td></tr>
                <tr><td><code>seats</code></td><td>Places assises</td><td>Nombre de places assises (restaurants)</td></tr>
                <tr><td><code>parking_spaces</code></td><td>Places de parking</td><td>Nombre de places de stationnement</td></tr>
                <tr><td><code>meeting_rooms</code></td><td>Salles de r√©union</td><td>Nombre de salles de r√©union</td></tr>
              </tbody>
            </table>

            <h4><code>ref_actor_role</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>director</code></td><td>Directeur</td><td>Directeur de l'√©tablissement</td></tr>
                <tr><td><code>manager</code></td><td>Gestionnaire</td><td>Gestionnaire, responsable</td></tr>
                <tr><td><code>receptionist</code></td><td>R√©ceptionniste</td><td>Accueil, r√©ception</td></tr>
                <tr><td><code>guide</code></td><td>Guide</td><td>Guide touristique, accompagnateur</td></tr>
                <tr><td><code>chef</code></td><td>Chef</td><td>Chef de cuisine</td></tr>
                <tr><td><code>waiter</code></td><td>Serveur</td><td>Serveur, personnel de salle</td></tr>
                <tr><td><code>maintenance</code></td><td>Maintenance</td><td>Personnel de maintenance</td></tr>
                <tr><td><code>security</code></td><td>S√©curit√©</td><td>Agent de s√©curit√©</td></tr>
              </tbody>
            </table>

            <h4><code>client_type</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>individual</code></td><td>Individuel</td><td>Client individuel</td></tr>
                <tr><td><code>family</code></td><td>Famille</td><td>Famille avec enfants</td></tr>
                <tr><td><code>business_traveler</code></td><td>Voyageur d'affaires</td><td>Client professionnel</td></tr>
                <tr><td><code>group</code></td><td>Groupe</td><td>Groupe organis√©</td></tr>
                <tr><td><code>senior</code></td><td>S√©nior</td><td>Personne √¢g√©e</td></tr>
                <tr><td><code>student</code></td><td>√âtudiant</td><td>√âtudiant/jeune</td></tr>
              </tbody>
            </table>

            <h4><code>service_type</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>accommodation</code></td><td>H√©bergement</td><td>Services d'h√©bergement</td></tr>
                <tr><td><code>restaurant</code></td><td>Restauration</td><td>Services de restauration</td></tr>
                <tr><td><code>transport</code></td><td>Transport</td><td>Services de transport</td></tr>
                <tr><td><code>activity</code></td><td>Activit√©</td><td>Activit√©s touristiques</td></tr>
                <tr><td><code>entertainment</code></td><td>Divertissement</td><td>Services de divertissement</td></tr>
                <tr><td><code>wellness</code></td><td>Bien-√™tre</td><td>Services de bien-√™tre</td></tr>
              </tbody>
            </table>

            <h4><code>transport_type</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>airplane</code></td><td>Avion</td><td>Transport a√©rien</td></tr>
                <tr><td><code>train</code></td><td>Train</td><td>Transport ferroviaire</td></tr>
                <tr><td><code>bus</code></td><td>Bus</td><td>Transport par bus</td></tr>
                <tr><td><code>car</code></td><td>Voiture</td><td>Transport automobile</td></tr>
                <tr><td><code>boat</code></td><td>Bateau</td><td>Transport maritime</td></tr>
                <tr><td><code>walking</code></td><td>Marche</td><td>D√©placement √† pied</td></tr>
              </tbody>
            </table>

            <h4><code>activity_type</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>hiking</code></td><td>Randonn√©e</td><td>Randonn√©e p√©destre</td></tr>
                <tr><td><code>diving</code></td><td>Plong√©e</td><td>Plong√©e sous-marine</td></tr>
                <tr><td><code>museum_visit</code></td><td>Visite mus√©e</td><td>Visite de mus√©e</td></tr>
                <tr><td><code>beach</code></td><td>Plage</td><td>Activit√©s de plage</td></tr>
                <tr><td><code>cultural</code></td><td>Culturel</td><td>Activit√©s culturelles</td></tr>
                <tr><td><code>adventure</code></td><td>Aventure</td><td>Sports d'aventure</td></tr>
              </tbody>
            </table>

            <h4><code>destination_type</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>urban</code></td><td>Urbain</td><td>Destination urbaine</td></tr>
                <tr><td><code>coastal</code></td><td>C√¥tier</td><td>Destination c√¥ti√®re</td></tr>
                <tr><td><code>mountain</code></td><td>Montagne</td><td>Destination montagnarde</td></tr>
                <tr><td><code>rural</code></td><td>Rural</td><td>Destination rurale</td></tr>
                <tr><td><code>island</code></td><td>√éle</td><td>Destination insulaire</td></tr>
                <tr><td><code>desert</code></td><td>D√©sert</td><td>Destination d√©sertique</td></tr>
              </tbody>
            </table>

            <h4><code>price_kind</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>adulte</code></td><td>Adulte</td><td>Tarif adulte</td></tr>
                <tr><td><code>enfant</code></td><td>Enfant</td><td>Tarif enfant</td></tr>
                <tr><td><code>groupe</code></td><td>Groupe</td><td>Tarif de groupe</td></tr>
                <tr><td><code>gratuit</code></td><td>Gratuit</td><td>Entr√©e gratuite</td></tr>
                <tr><td><code>senior</code></td><td>S√©nior</td><td>Tarif s√©nior</td></tr>
                <tr><td><code>etudiant</code></td><td>√âtudiant</td><td>Tarif √©tudiant</td></tr>
              </tbody>
            </table>

            <h4><code>price_unit</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>par_personne</code></td><td>Par personne</td><td>Prix par personne</td></tr>
                <tr><td><code>par_nuit</code></td><td>Par nuit</td><td>Prix par nuit√©e</td></tr>
                <tr><td><code>par_heure</code></td><td>Par heure</td><td>Prix par heure</td></tr>
                <tr><td><code>par_jour</code></td><td>Par jour</td><td>Prix par jour</td></tr>
                <tr><td><code>forfait</code></td><td>Forfait</td><td>Prix forfaitaire</td></tr>
                <tr><td><code>gratuit</code></td><td>Gratuit</td><td>Entr√©e gratuite</td></tr>
              </tbody>
            </table>

            <h4><code>season_type</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>high_season</code></td><td>Haute saison</td><td>P√©riode de haute saison</td></tr>
                <tr><td><code>low_season</code></td><td>Basse saison</td><td>P√©riode de basse saison</td></tr>
                <tr><td><code>winter</code></td><td>Hiver</td><td>Saison hivernale</td></tr>
                <tr><td><code>summer</code></td><td>√ât√©</td><td>Saison estivale</td></tr>
                <tr><td><code>cyclone_season</code></td><td>Saison cyclonique</td><td>P√©riode cyclonique</td></tr>
                <tr><td><code>shoulder_season</code></td><td>Mi-saison</td><td>P√©riode interm√©diaire</td></tr>
              </tbody>
            </table>

            <h4><code>promotion_type</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>early_booking</code></td><td>R√©servation anticip√©e</td><td>R√©duction r√©servation anticip√©e</td></tr>
                <tr><td><code>last_minute</code></td><td>Derni√®re minute</td><td>Offre derni√®re minute</td></tr>
                <tr><td><code>loyalty</code></td><td>Fid√©lit√©</td><td>R√©duction fid√©lit√©</td></tr>
                <tr><td><code>group</code></td><td>Groupe</td><td>R√©duction groupe</td></tr>
                <tr><td><code>seasonal</code></td><td>Saisonni√®re</td><td>Offre saisonni√®re</td></tr>
                <tr><td><code>package</code></td><td>Forfait</td><td>R√©duction forfait</td></tr>
              </tbody>
            </table>

            <h4><code>package_type</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>all_inclusive</code></td><td>Tout inclus</td><td>Forfait tout inclus</td></tr>
                <tr><td><code>half_board</code></td><td>Demi-pension</td><td>H√©bergement + petit-d√©jeuner + d√Æner</td></tr>
                <tr><td><code>full_board</code></td><td>Pension compl√®te</td><td>H√©bergement + tous les repas</td></tr>
                <tr><td><code>flight_hotel</code></td><td>Vol + H√¥tel</td><td>Forfait transport + h√©bergement</td></tr>
                <tr><td><code>activity_package</code></td><td>Forfait activit√©</td><td>H√©bergement + activit√©s</td></tr>
                <tr><td><code>romantic</code></td><td>Romantique</td><td>Forfait romantique</td></tr>
              </tbody>
            </table>

            <h4><code>cuisine_type</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>creole</code></td><td>Cr√©ole</td><td>Cuisine cr√©ole locale</td></tr>
                <tr><td><code>metropolitan</code></td><td>M√©tropolitaine</td><td>Cuisine fran√ßaise m√©tropolitaine</td></tr>
                <tr><td><code>vegan</code></td><td>V√©gan</td><td>Cuisine v√©g√©talienne</td></tr>
                <tr><td><code>vegetarian</code></td><td>V√©g√©tarienne</td><td>Cuisine v√©g√©tarienne</td></tr>
                <tr><td><code>seafood</code></td><td>Fruits de mer</td><td>Cuisine de fruits de mer</td></tr>
                <tr><td><code>local</code></td><td>Locale</td><td>Cuisine locale traditionnelle</td></tr>
              </tbody>
            </table>

            <h4><code>menu_category</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>entree</code></td><td>Entr√©e</td><td>Plats d'entr√©e</td></tr>
                <tr><td><code>main</code></td><td>Plat principal</td><td>Plats principaux</td></tr>
                <tr><td><code>dessert</code></td><td>Dessert</td><td>Desserts</td></tr>
                <tr><td><code>drink</code></td><td>Boisson</td><td>Boissons</td></tr>
                <tr><td><code>appetizer</code></td><td>Amuse-bouche</td><td>Amuse-bouches</td></tr>
                <tr><td><code>side</code></td><td>Accompagnement</td><td>Accompagnements</td></tr>
              </tbody>
            </table>

            <h4><code>dietary_tag</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>vegetarian</code></td><td>V√©g√©tarien</td><td>Convient aux v√©g√©tariens</td></tr>
                <tr><td><code>vegan</code></td><td>V√©gan</td><td>Convient aux v√©gans</td></tr>
                <tr><td><code>halal</code></td><td>Halal</td><td>Certifi√© halal</td></tr>
                <tr><td><code>kosher</code></td><td>Casher</td><td>Certifi√© casher</td></tr>
                <tr><td><code>gluten_free</code></td><td>Sans gluten</td><td>Sans gluten</td></tr>
                <tr><td><code>lactose_free</code></td><td>Sans lactose</td><td>Sans lactose</td></tr>
              </tbody>
            </table>

            <h4><code>allergen</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>gluten</code></td><td>Gluten</td><td>Contient du gluten</td></tr>
                <tr><td><code>dairy</code></td><td>Lait</td><td>Contient des produits laitiers</td></tr>
                <tr><td><code>nuts</code></td><td>Noix</td><td>Contient des noix</td></tr>
                <tr><td><code>eggs</code></td><td>≈íufs</td><td>Contient des ≈ìufs</td></tr>
                <tr><td><code>soy</code></td><td>Soja</td><td>Contient du soja</td></tr>
                <tr><td><code>shellfish</code></td><td>Crustac√©s</td><td>Contient des crustac√©s</td></tr>
              </tbody>
            </table>

            <h4><code>event_type</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>festival</code></td><td>Festival</td><td>Festival culturel</td></tr>
                <tr><td><code>conference</code></td><td>Conf√©rence</td><td>Conf√©rence professionnelle</td></tr>
                <tr><td><code>wedding</code></td><td>Mariage</td><td>C√©r√©monie de mariage</td></tr>
                <tr><td><code>exhibition</code></td><td>Exposition</td><td>Exposition artistique</td></tr>
                <tr><td><code>concert</code></td><td>Concert</td><td>Concert musical</td></tr>
                <tr><td><code>sport</code></td><td>Sport</td><td>√âv√©nement sportif</td></tr>
              </tbody>
            </table>

            <h4><code>iti_practice</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>randonnee_pedestre</code></td><td>Randonn√©e p√©destre</td><td>Randonn√©e √† pied</td></tr>
                <tr><td><code>velo_vtt</code></td><td>V√©lo/VTT</td><td>Cyclisme et VTT</td></tr>
                <tr><td><code>equitation</code></td><td>√âquitation</td><td>Randonn√©e √©questre</td></tr>
                <tr><td><code>kayak</code></td><td>Kayak</td><td>Navigation en kayak</td></tr>
                <tr><td><code>plongee</code></td><td>Plong√©e</td><td>Plong√©e sous-marine</td></tr>
                <tr><td><code>escalade</code></td><td>Escalade</td><td>Escalade et varappe</td></tr>
              </tbody>
            </table>

            <h4><code>contact_kind</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>phone</code></td><td>T√©l√©phone</td><td>Num√©ro de t√©l√©phone</td></tr>
                <tr><td><code>email</code></td><td>Email</td><td>Adresse email</td></tr>
                <tr><td><code>whatsapp</code></td><td>WhatsApp</td><td>Contact WhatsApp</td></tr>
                <tr><td><code>website</code></td><td>Site web</td><td>Site internet</td></tr>
                <tr><td><code>address</code></td><td>Adresse</td><td>Adresse physique</td></tr>
                <tr><td><code>fax</code></td><td>Fax</td><td>Num√©ro de fax</td></tr>
              </tbody>
            </table>

            <h4><code>social_network</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>facebook</code></td><td>Facebook</td><td>Page Facebook</td></tr>
                <tr><td><code>instagram</code></td><td>Instagram</td><td>Compte Instagram</td></tr>
                <tr><td><code>youtube</code></td><td>YouTube</td><td>Cha√Æne YouTube</td></tr>
                <tr><td><code>twitter</code></td><td>Twitter</td><td>Compte Twitter</td></tr>
                <tr><td><code>linkedin</code></td><td>LinkedIn</td><td>Page LinkedIn</td></tr>
                <tr><td><code>tiktok</code></td><td>TikTok</td><td>Compte TikTok</td></tr>
              </tbody>
            </table>

            <h4><code>media_type</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>photo</code></td><td>Photo</td><td>Image photographique</td></tr>
                <tr><td><code>video</code></td><td>Vid√©o</td><td>Vid√©o</td></tr>
                <tr><td><code>logo</code></td><td>Logo</td><td>Logo de l'√©tablissement</td></tr>
                <tr><td><code>brochure_pdf</code></td><td>Brochure PDF</td><td>Document PDF</td></tr>
                <tr><td><code>audio</code></td><td>Audio</td><td>Fichier audio</td></tr>
                <tr><td><code>panorama</code></td><td>Panorama</td><td>Image panoramique</td></tr>
              </tbody>
            </table>

            <h4><code>environment_tag</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>plage</code></td><td>Plage</td><td>Environnement de plage</td></tr>
                <tr><td><code>montagne</code></td><td>Montagne</td><td>Environnement montagnard</td></tr>
                <tr><td><code>patrimoine</code></td><td>Patrimoine</td><td>Site patrimonial</td></tr>
                <tr><td><code>foret</code></td><td>For√™t</td><td>Environnement forestier</td></tr>
                <tr><td><code>urbain</code></td><td>Urbain</td><td>Environnement urbain</td></tr>
                <tr><td><code>rural</code></td><td>Rural</td><td>Environnement rural</td></tr>
              </tbody>
            </table>

            <h4><code>amenity_family</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>comforts</code></td><td>Conforts</td><td>√âquipements de confort</td></tr>
                <tr><td><code>services</code></td><td>Services</td><td>Services propos√©s</td></tr>
                <tr><td><code>outdoor</code></td><td>Ext√©rieur</td><td>√âquipements ext√©rieurs</td></tr>
                <tr><td><code>sports</code></td><td>Sports</td><td>√âquipements sportifs</td></tr>
                <tr><td><code>wellness</code></td><td>Bien-√™tre</td><td>√âquipements bien-√™tre</td></tr>
                <tr><td><code>business</code></td><td>Affaires</td><td>√âquipements professionnels</td></tr>
              </tbody>
            </table>

            <h4><code>ref_object_relation_type</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>parent_of</code></td><td>Parent de</td><td>Relation parent-enfant</td></tr>
                <tr><td><code>part_of</code></td><td>Partie de</td><td>Fait partie de</td></tr>
                <tr><td><code>partner_of</code></td><td>Partenaire de</td><td>Partenariat commercial</td></tr>
                <tr><td><code>near_to</code></td><td>Pr√®s de</td><td>Proximit√© g√©ographique</td></tr>
                <tr><td><code>managed_by</code></td><td>G√©r√© par</td><td>Gestion administrative</td></tr>
                <tr><td><code>owned_by</code></td><td>Propri√©t√© de</td><td>Propri√©t√©</td></tr>
              </tbody>
            </table>

            <h4><code>ref_classification_scheme</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>hot_stars</code></td><td>√âtoiles h√¥tel</td><td>Classification h√¥teli√®re</td></tr>
                <tr><td><code>tourisme_handicap</code></td><td>Tourisme & Handicap</td><td>Label accessibilit√©</td></tr>
                <tr><td><code>eco_label</code></td><td>√âcolabel</td><td>Certification environnementale</td></tr>
                <tr><td><code>quality_label</code></td><td>Label qualit√©</td><td>Label de qualit√©</td></tr>
                <tr><td><code>heritage</code></td><td>Patrimoine</td><td>Classification patrimoniale</td></tr>
                <tr><td><code>gastronomy</code></td><td>Gastronomie</td><td>Label gastronomique</td></tr>
              </tbody>
            </table>

            <h4><code>insurance_type</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>travel</code></td><td>Voyage</td><td>Assurance voyage</td></tr>
                <tr><td><code>medical</code></td><td>M√©dicale</td><td>Assurance m√©dicale</td></tr>
                <tr><td><code>cancellation</code></td><td>Annulation</td><td>Assurance annulation</td></tr>
                <tr><td><code>liability</code></td><td>Responsabilit√©</td><td>Assurance responsabilit√©</td></tr>
                <tr><td><code>property</code></td><td>Biens</td><td>Assurance des biens</td></tr>
                <tr><td><code>activity</code></td><td>Activit√©</td><td>Assurance activit√©</td></tr>
              </tbody>
            </table>

            <h4><code>assistance_type</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>customer_service</code></td><td>Service client</td><td>Assistance client√®le</td></tr>
                <tr><td><code>emergency</code></td><td>Urgence</td><td>Assistance d'urgence</td></tr>
                <tr><td><code>legal</code></td><td>L√©gale</td><td>Assistance juridique</td></tr>
                <tr><td><code>medical</code></td><td>M√©dicale</td><td>Assistance m√©dicale</td></tr>
                <tr><td><code>technical</code></td><td>Technique</td><td>Assistance technique</td></tr>
                <tr><td><code>concierge</code></td><td>Conciergerie</td><td>Service de conciergerie</td></tr>
              </tbody>
            </table>

            <h4><code>feedback_type</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>online_review</code></td><td>Avis en ligne</td><td>Avis client en ligne</td></tr>
                <tr><td><code>complaint</code></td><td>Plainte</td><td>Plainte client</td></tr>
                <tr><td><code>suggestion</code></td><td>Suggestion</td><td>Suggestion d'am√©lioration</td></tr>
                <tr><td><code>compliment</code></td><td>Compliment</td><td>F√©licitation client</td></tr>
                <tr><td><code>rating</code></td><td>Note</td><td>√âvaluation num√©rique</td></tr>
                <tr><td><code>survey</code></td><td>Enqu√™te</td><td>Enqu√™te de satisfaction</td></tr>
              </tbody>
            </table>

            <h4><code>partnership_type</code></h4>
            <table>
              <thead><tr><th>Code</th><th>Libell√©</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>hotel</code></td><td>H√¥tel</td><td>Partenariat h√¥telier</td></tr>
                <tr><td><code>airline</code></td><td>Compagnie a√©rienne</td><td>Partenariat a√©rien</td></tr>
                <tr><td><code>local_business</code></td><td>Commerce local</td><td>Partenariat local</td></tr>
                <tr><td><code>tour_operator</code></td><td>Tour-op√©rateur</td><td>Partenariat tour-op√©rateur</td></tr>
                <tr><td><code>restaurant</code></td><td>Restaurant</td><td>Partenariat restauration</td></tr>
                <tr><td><code>activity_provider</code></td><td>Prestataire d'activit√©s</td><td>Partenariat activit√©s</td></tr>
              </tbody>
            </table>
        </div>
      </section>

      <!-- 5) Exemples pratiques (HTTP) -->
      <section class="card" id="examples">
        <h2>5) Exemples pratiques (HTTP)</h2>

        <details open>
          <summary>5.1 Un objet ITI sans trac√© (l√©ger)</summary>
          <div class="content">
            <div style="position:relative;">
              <button class="copy copy-floating" data-copy="#ex-41">Copier</button>
<pre id="ex-41">curl -X POST "{BASE_URL}/rpc/get_object_resource" \
  -H "Content-Type: application/json" \
  -H "Accept: application/json" \
  -H "apikey: {SUPABASE_ANON_KEY}" \
  -H "Authorization: Bearer {SUPABASE_ANON_KEY}" \
  -d '{ "p_object_id": "ITI123", "p_track_format": "none" }'</pre>
          </div>
        </details>

        <details>
          <summary>5.2 Le m√™me objet ITI avec KML, √©tapes en bleu</summary>
          <div class="content">
            <div style="position:relative;">
              <button class="copy copy-floating" data-copy="#ex-42">Copier</button>
<pre id="ex-42">curl -X POST "{BASE_URL}/rpc/get_object_resource" \
  -H "Content-Type: application/json" \
  -H "Accept: application/json" \
  -H "apikey: {SUPABASE_ANON_KEY}" \
  -H "Authorization: Bearer {SUPABASE_ANON_KEY}" \
  -d '{
    "p_object_id": "ITI123",
    "p_track_format": "kml",
    "p_options": { "include_stages": true, "stage_color": "blue" }
  }'</pre>
          </div>
        </details>

        <details>
          <summary>5.3 Liste pagin√©e d'itin√©raires publi√©s, 20 par page</summary>
          <div class="content">
            <div style="position:relative;">
              <button class="copy copy-floating" data-copy="#ex-43a">Copier</button>
<pre id="ex-43a">curl -X POST "{BASE_URL}/rpc/list_object_resources_page" \
  -H "Content-Type: application/json" \
  -H "Accept: application/json" \
  -H "apikey: {SUPABASE_ANON_KEY}" \
  -H "Authorization: Bearer {SUPABASE_ANON_KEY}" \
  -d '{ "p_page_size": 20, "p_types": ["ITI"], "p_status": ["published"] }'</pre>
            <p class="inline-help">Puis, pour la page suivante, reprenez <code>info.next_cursor</code> :</p>
            <div style="position:relative;">
              <button class="copy copy-floating" data-copy="#ex-43b">Copier</button>
<pre id="ex-43b">curl -X POST "{BASE_URL}/rpc/list_object_resources_page" \
  -H "Content-Type: application/json" \
  -H "Accept: application/json" \
  -H "apikey: {SUPABASE_ANON_KEY}" \
  -H "Authorization: Bearer {SUPABASE_ANON_KEY}" \
  -d '{ "p_cursor": "&lt;valeur de next_cursor&gt;" }'</pre>
          </div>
        </details>

        <details>
          <summary>5.4 Sync incr√©mentale depuis une date (keyset)</summary>
          <div class="content">
            <div style="position:relative;">
              <button class="copy copy-floating" data-copy="#ex-44">Copier</button>
<pre id="ex-44">curl -X POST "{BASE_URL}/rpc/list_object_resources_since_fast" \
  -H "Content-Type: application/json" \
  -H "Accept: application/json" \
  -H "apikey: {SUPABASE_ANON_KEY}" \
  -H "Authorization: Bearer {SUPABASE_ANON_KEY}" \
  -d '{
    "p_since": "2024-04-01T00:00:00Z",
    "p_types": ["ITI"], "p_status": ["published"]
  }'</pre>
            <p class="inline-help">Bouclez avec <code>p_cursor</code> tant que <code>next_cursor</code> n‚Äôest pas <code>null</code>.</p>
          </div>
        </details>

        <details>
          <summary>5.5 Liste filtr√©e (ITI boucles ‚â§ 15 km, √† 20 km de 45.76/4.84, avec image principale)</summary>
          <div class="content">
            <div style="position:relative;">
              <button class="copy copy-floating" data-copy="#ex-45">Copier</button>
<pre id="ex-45">curl -X POST "{BASE_URL}/rpc/list_object_resources_filtered_page" \
  -H "Content-Type: application/json" \
  -H "Accept: application/json" \
  -H "apikey: {SUPABASE_ANON_KEY}" \
  -H "Authorization: Bearer {SUPABASE_ANON_KEY}" \
  -d '{
    "p_page_size": 24,
    "p_types": ["ITI"],
    "p_filters": {
      "itinerary": { "is_loop": true, "distance_max_km": 15, "practices_any": ["hiking"] },
      "within_radius": { "lat": 45.76, "lon": 4.84, "radius_m": 20000 },
      "media_types_any": ["image"],
      "media_published_only": true,
      "media_must_have_main": true
    }
  }'</pre>
          </div>
        </details>

        <details>
          <summary>5.6 Restaurant avec menu complet</summary>
          <div class="content">
            <div style="position:relative;">
              <button class="copy copy-floating" data-copy="#ex-46">Copier</button>
<pre id="ex-46">curl -X POST "{BASE_URL}/rpc/get_object_resource" \
  -H "Content-Type: application/json" \
  -H "Accept: application/json" \
  -H "apikey: {SUPABASE_ANON_KEY}" \
  -H "Authorization: Bearer {SUPABASE_ANON_KEY}" \
  -d '{
    "p_object_id": "RESTAURANT-001",
    "p_lang_prefs": ["fr", "en"]
  }'</pre>
            </div>
            <p class="inline-help">La r√©ponse inclura les <code>menus[]</code> avec leurs <code>items[]</code>, cat√©gories, prix, tags alimentaires et allerg√®nes.</p>
          </div>
        </details>

        <details>
          <summary>5.7 R√©cup√©ration avec Deep Data</summary>
          <div class="content">
            <div style="position:relative;">
              <button class="copy copy-floating" data-copy="#ex-47">Copier</button>
<pre id="ex-47">curl -X POST "{BASE_URL}/rpc/get_object_with_deep_data" \
  -H "Content-Type: application/json" \
  -H "Accept: application/json" \
  -H "apikey: {SUPABASE_ANON_KEY}" \
  -H "Authorization: Bearer {SUPABASE_ANON_KEY}" \
  -d '{ "p_object_id": "HOT123" }'</pre>
            <p class="inline-help">Retourne l'objet avec ses objets parents, acteurs et organisations li√©es.</p>
          </div>
        </details>

        <details>
          <summary>5.8 Recherche de restaurants par cuisine</summary>
          <div class="content">
            <div style="position:relative;">
              <button class="copy copy-floating" data-copy="#ex-48">Copier</button>
<pre id="ex-48">curl -X POST "{BASE_URL}/rpc/search_restaurants_by_cuisine" \
  -H "Content-Type: application/json" \
  -H "Accept: application/json" \
  -H "apikey: {SUPABASE_ANON_KEY}" \
  -H "Authorization: Bearer {SUPABASE_ANON_KEY}" \
  -d '{
    "p_cuisine_types": ["local", "veggie", "seafood"],
    "p_languages": ["fr", "en"],
    "p_limit": 20
  }'</pre>
            <p class="inline-help">Recherche sp√©cialis√©e pour trouver des restaurants par types de cuisine.</p>
          </div>
        </details>

        <details>
          <summary>5.9 Recherche d'√©v√©nements par cuisine de restaurant</summary>
          <div class="content">
            <div style="position:relative;">
              <button class="copy copy-floating" data-copy="#ex-49">Copier</button>
<pre id="ex-49">curl -X POST "{BASE_URL}/rpc/search_events_by_restaurant_cuisine" \
  -H "Content-Type: application/json" \
  -H "Accept: application/json" \
  -H "apikey: {SUPABASE_ANON_KEY}" \
  -H "Authorization: Bearer {SUPABASE_ANON_KEY}" \
  -d '{
    "p_cuisine_types": ["local", "gastronomy"],
    "p_languages": ["fr"],
    "p_limit": 15
  }'</pre>
            <p class="inline-help">Trouve des √©v√©nements (FMA) bas√©s sur les types de cuisine des restaurants associ√©s.</p>
          </div>
        </details>

        <details>
          <summary>5.10 R√©cup√©ration avec options avanc√©es</summary>
          <div class="content">
            <div style="position:relative;">
              <button class="copy copy-floating" data-copy="#ex-410">Copier</button>
<pre id="ex-410">curl -X POST "{BASE_URL}/rpc/get_object_resource" \
  -H "Content-Type: application/json" \
  -H "Accept: application/json" \
  -H "apikey: {SUPABASE_ANON_KEY}" \
  -H "Authorization: Bearer {SUPABASE_ANON_KEY}" \
  -d '{
    "p_object_id": "HOT123",
    "p_lang_prefs": ["fr", "en"],
    "p_options": {
      "render": true,
      "render_locale": "fr-FR",
      "render_tz": "Europe/Paris",
      "fields": ["id", "name", "contacts", "media", "actors"],
      "org_object_id": "ORG456"
    }
  }'</pre>
            <p class="inline-help">Exemple avec contr√¥le du rendu, filtrage des champs et pr√©f√©rence d'organisation.</p>
          </div>
        </details>

        <details>
          <summary>5.11 √âv√©nement avec menu (FMA)</summary>
          <div class="content">
            <div style="position:relative;">
              <button class="copy copy-floating" data-copy="#ex-47">Copier</button>
<pre id="ex-47">curl -X POST "{BASE_URL}/rpc/get_object_resource" \
  -H "Content-Type: application/json" \
  -H "Accept: application/json" \
  -H "apikey: {SUPABASE_ANON_KEY}" \
  -H "Authorization: Bearer {SUPABASE_ANON_KEY}" \
  -d '{
    "p_object_id": "FMA-FESTIVAL-2024",
    "p_lang_prefs": ["fr"]
  }'</pre>
            </div>
            <p class="inline-help">Les √©v√©nements peuvent aussi avoir des menus pour les repas/boissons propos√©s.</p>
          </div>
        </details>
      </section>

      <!-- 6) Conseils -->
      <section class="card" id="tips">
        <h2>6) Conseils & bonnes pratiques</h2>
        <div class="row">
          <div>
            <h3>Trac√© ITI</h3>
            <ul>
              <li>En listing, laissez <code>p_track_format: "none"</code> (plus rapide).</li>
              <li>Pour le d√©tail, demandez le trac√© en <code>"kml"</code> ou <code>"gpx"</code>.</li>
              <li><b>KML + √©tapes</b> : fixez <code>stage_color</code> pour un rendu homog√®ne (ex. <code>"blue"</code>).</li>
            </ul>
          </div>
          <div>
            <h3>Pagination</h3>
            <ul>
              <li><b>Page/offset</b> (<code>list_object_resources_page</code>) : simple pour UI.</li>
              <li><b>Keyset</b> (<code>list_object_resources_since_fast</code>) : id√©al pour synchroniser des donn√©es modifi√©es.</li>
            </ul>
          </div>
        </div>
        <div class="row">
          <div>
            <h3>Filtres</h3>
            <ul>
              <li>N‚Äôenvoyez que les filtres utiles : les autres sont ignor√©s.</li>
              <li>Combiner plusieurs cl√©s applique un <b>ET</b> logique.</li>
            </ul>
          </div>
          <div>
            <h3>Langues & robustesse</h3>
            <ul>
              <li><code>p_lang_prefs</code> prend un ordre de pr√©f√©rence (ex. <code>["en","fr"]</code>).</li>
              <li>Si un champ n‚Äôexiste pas, attendez-vous √† <code>[]</code>, <code>{}</code> ou <code>null</code> suivant le bloc.</li>
            </ul>
          </div>
        </div>
        <div class="row">
          <div>
            <h3>Deep Data & Performance</h3>
            <ul>
              <li>Utilisez les fonctions Deep Data pour √©viter les appels multiples.</li>
              <li>Activez <code>render: true</code> pour des donn√©es format√©es pr√™tes √† l'affichage.</li>
              <li>Utilisez <code>fields</code> et <code>include</code> pour limiter les donn√©es retourn√©es.</li>
            </ul>
          </div>
          <div>
            <h3>Recherches sp√©cialis√©es</h3>
            <ul>
              <li>Pr√©f√©rez <code>search_restaurants_by_cuisine</code> aux filtres g√©n√©riques.</li>
              <li>Utilisez <code>search_events_by_restaurant_cuisine</code> pour les √©v√©nements li√©s √† la gastronomie.</li>
              <li>Les fonctions Deep Data incluent automatiquement les objets li√©s.</li>
            </ul>
          </div>
        </div>
        <div class="row">
          <div>
            <h3>Nouveaux blocs de donn√©es</h3>
            <ul>
              <li><code>actors[]</code> : personnes physiques li√©es √† l'objet avec leurs r√¥les.</li>
              <li><code>legal_records[]</code> : enregistrements l√©gaux et certifications officielles.</li>
              <li><code>incoming_relations[]</code> et <code>outgoing_relations[]</code> : relations s√©par√©es par sens.</li>
            </ul>
          </div>
          <div>
            <h3>Options avanc√©es</h3>
            <ul>
              <li><code>org_object_id</code> : priorise les descriptions d'une organisation sp√©cifique.</li>
              <li><code>render_locale</code> et <code>render_tz</code> : contr√¥lent le formatage des donn√©es.</li>
              <li><code>include_private</code> : acc√®s aux donn√©es priv√©es (n√©cessite permissions).</li>
            </ul>
          </div>
        </div>
        <div class="sep"></div>
        <p class="footer">¬© OTI du Sud ¬∑ API</p>
      </section>
    </div>
  </main>

  <!-- Floating toggle sections button -->
  <button id="floatingToggleSections" class="floating-toggle" title="D√©plier/Replier toutes les sections">
    <span id="floatingToggleIcon">‚ñæ</span>
  </button>

  <script>
    // THEME
    const root = document.documentElement;
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)');
    const saved = localStorage.getItem('oti:theme');
    if(saved === 'dark' || (saved === null && prefersDark.matches)){ document.body.classList.add('dark'); }
    
    // Update theme button text and arrow on load
    function updateThemeButtonText() {
      const themeText = document.getElementById('themeText');
      const isDark = document.body.classList.contains('dark');
      themeText.textContent = isDark ? 'Dark' : 'Light';
      
      // Update arrow direction
      const button = document.getElementById('toggleTheme');
      const currentText = button.innerHTML;
      if (currentText.includes('‚ñæ') || currentText.includes('‚ñ¥')) {
        button.innerHTML = currentText.replace(/[‚ñæ‚ñ¥]/, isDark ? '‚ñ¥' : '‚ñæ');
      }
    }
    
    // Update button text on load
    updateThemeButtonText();
    
    document.getElementById('toggleTheme').addEventListener('click', ()=>{
      document.body.classList.toggle('dark');
      localStorage.setItem('oti:theme', document.body.classList.contains('dark') ? 'dark' : 'light');
      updateThemeButtonText();
    });

    // TOGGLE SECTIONS
    const toggleSectionsBtn = document.getElementById('toggleSections');
    const floatingToggleBtn = document.getElementById('floatingToggleSections');
    const floatingToggleIcon = document.getElementById('floatingToggleIcon');
    let sectionsExpanded = false;
    
    function toggleAllSections() {
      // Get current scroll position before toggling
      const currentScrollTop = window.pageYOffset || document.documentElement.scrollTop;
      const currentSection = getCurrentVisibleSection();
      
      const details = document.querySelectorAll('details');
      sectionsExpanded = !sectionsExpanded;
      
      details.forEach(d => d.open = sectionsExpanded);
      
      // Update header button text and icon
      toggleSectionsBtn.innerHTML = sectionsExpanded ? '‚ñ∏ Fermer tout' : '‚ñæ Ouvrir tout';
      toggleSectionsBtn.title = sectionsExpanded ? 'Replier toutes les sections' : 'D√©plier toutes les sections';
      
      // Update floating button icon
      floatingToggleIcon.textContent = sectionsExpanded ? '‚ñ∏' : '‚ñæ';
      floatingToggleBtn.title = sectionsExpanded ? 'Replier toutes les sections' : 'D√©plier toutes les sections';
      
      // Restore scroll position after DOM updates
      requestAnimationFrame(() => {
        if (currentSection) {
          // Scroll to the same section that was visible
          currentSection.scrollIntoView({ 
            behavior: 'smooth', 
            block: 'start' 
          });
        } else {
          // Fallback to previous scroll position
          window.scrollTo({
            top: currentScrollTop,
            behavior: 'smooth'
          });
        }
      });
    }
    
    function getCurrentVisibleSection() {
      const sections = document.querySelectorAll('section[id], details[id], div[id]');
      let currentSection = null;
      let closestDistance = Infinity;
      
      sections.forEach(section => {
        if (section.id) {
          const rect = section.getBoundingClientRect();
          const distanceFromTop = Math.abs(rect.top);
          
          // Check if section is in viewport (at least partially visible)
          if (rect.top <= window.innerHeight / 2 && rect.bottom > 0) {
            if (distanceFromTop < closestDistance) {
              closestDistance = distanceFromTop;
              currentSection = section;
            }
          }
        }
      });
      
      return currentSection;
    }
    
    toggleSectionsBtn.addEventListener('click', toggleAllSections);
    floatingToggleBtn.addEventListener('click', toggleAllSections);

    // COPY buttons
    function copyFromSelector(sel, btn){
      const el = document.querySelector(sel);
      if(!el) return;
      const text = el.innerText;
      navigator.clipboard.writeText(text).then(()=>{
        btn.classList.add('success'); btn.textContent='Copi√© ‚úì';
        setTimeout(()=>{ btn.classList.remove('success'); btn.textContent='Copier'; }, 1200);
      });
    }
    document.querySelectorAll('.copy').forEach(btn=>{
      const sel = btn.getAttribute('data-copy');
      btn.addEventListener('click', ()=> copyFromSelector(sel, btn));
    });

    // TABS
    document.querySelectorAll('[data-tabs]').forEach(box=>{
      const buttons = box.querySelectorAll('.tab-bar button');
      const panels = box.querySelectorAll('.tab-panel');
      buttons.forEach(b=>{
        b.addEventListener('click', ()=>{
          const tab = b.getAttribute('data-tab');
          buttons.forEach(x=>x.classList.toggle('active', x===b));
          panels.forEach(p=>p.classList.toggle('active', p.getAttribute('data-panel')===tab));
        });
      });
    });

    // TOC build + ScrollSpy
    const tocEl = document.getElementById('toc');
    const headings = [...document.querySelectorAll('#content h2, #content details > summary')];
    const tocLinks = [];
    
    headings.forEach(h=>{
      // Ensure id
      const base = (h.textContent||'section').toLowerCase()
        .replace(/[^\w]+/g,'-').replace(/(^-|-$)/g,'');
      let id = base, i=1;
      while(document.getElementById(id)){ id = base + '-' + (i++); }
      if(!h.id) h.id = id;

      const a = document.createElement('a');
      a.href = '#' + id;
      a.textContent = h.tagName.toLowerCase()==='summary' ? h.textContent : '‚Ä¢ ' + h.textContent;
      if(h.tagName.toLowerCase()==='summary') a.classList.add('sub');
      
      // Add click handler for manual navigation
      a.addEventListener('click', (e)=>{
        e.preventDefault();
        const targetId = a.getAttribute('href').slice(1);
        const targetElement = document.getElementById(targetId);
        
        if(targetElement){
          // Remove all active classes
          tocLinks.forEach(link=>link.classList.remove('active'));
          
          // Add active class to clicked link
          a.classList.add('active');
          
          // Smooth scroll to target
          targetElement.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
          });
          
          // Update URL without jumping
          history.pushState(null, null, '#' + targetId);
        }
      });
      
      tocLinks.push(a); 
      tocEl.appendChild(a);
    });

    // Remove the old observer - we'll use the enhanced one below

    // Handle URL hash changes and initial page load
    function updateActiveFromHash() {
      const hash = window.location.hash.slice(1);
      if (hash) {
        tocLinks.forEach(a => a.classList.remove('active'));
        const targetLink = tocLinks.find(a => a.getAttribute('href').slice(1) === hash);
        if (targetLink) {
          targetLink.classList.add('active');
          // Scroll to the section if it exists
          const targetElement = document.getElementById(hash);
          if (targetElement) {
            setTimeout(() => {
              targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 100);
          }
        }
      }
    }

    // Handle browser back/forward buttons
    window.addEventListener('popstate', updateActiveFromHash);
    
    // Handle initial page load with hash
    window.addEventListener('load', updateActiveFromHash);
    
    // Handle hash changes
    window.addEventListener('hashchange', updateActiveFromHash);

    // Simple and reliable scroll synchronization
    let scrollTimeout;
    let isUserScrollingTOC = false;
    
    // Main scroll handler
    window.addEventListener('scroll', () => {
      if (isUserScrollingTOC) return;
      
      clearTimeout(scrollTimeout);
      scrollTimeout = setTimeout(() => {
        syncTOCWithMainContent();
      }, 50);
    });
    
    function syncTOCWithMainContent() {
      const tocContainer = document.getElementById('toc');
      const tocLinks = Array.from(tocContainer.querySelectorAll('a'));
      
      if (tocLinks.length === 0) return;
      
      // Proportional scroll of TOC based on main content scroll position
      const contentEl = document.getElementById('content');
      const contentStart = contentEl.offsetTop;
      const contentEnd = contentStart + contentEl.scrollHeight - window.innerHeight;
      const pageY = window.pageYOffset || document.documentElement.scrollTop || 0;
      const clampedY = Math.max(contentStart, Math.min(pageY, contentEnd));
      const progress = contentEnd > contentStart ? (clampedY - contentStart) / (contentEnd - contentStart) : 0;
      const maxTOCScroll = Math.max(0, tocContainer.scrollHeight - tocContainer.clientHeight);
      tocContainer.scrollTop = progress * maxTOCScroll;
      
      // Determine current heading (the headings used to build the TOC)
      const allHeadings = (typeof headings !== 'undefined' && Array.isArray(headings) && headings.length)
        ? headings
        : [...document.querySelectorAll('#content h2, #content details > summary')];
      
      let currentHeading = allHeadings[0];
      const anchorY = 110; // approx sticky header height
      for (let i = 0; i < allHeadings.length; i++) {
        const rect = allHeadings[i].getBoundingClientRect();
        if (rect.top <= anchorY) {
          currentHeading = allHeadings[i];
        } else {
          break;
        }
      }
      
      // Update active link in TOC
      tocLinks.forEach(link => link.classList.remove('active'));
      const activeLink = tocLinks.find(link => link.getAttribute('href').slice(1) === currentHeading.id);
      if (activeLink) {
        activeLink.classList.add('active');
      }
    }

    // Simple hover effects for TOC links (no scrolling)
    tocLinks.forEach(link => {
      link.addEventListener('mouseenter', () => {
        const targetId = link.getAttribute('href').slice(1);
        const targetElement = document.getElementById(targetId);
        
        if (targetElement) {
          // Temporarily highlight the section
          targetElement.style.transition = 'all 0.3s ease';
          targetElement.style.boxShadow = '0 0 0 3px rgba(118,176,151,.3)';
          
          // Remove highlight after a delay
          setTimeout(() => {
            targetElement.style.boxShadow = '';
          }, 2000);
        }
      });
      
      link.addEventListener('mouseleave', () => {
        const targetId = link.getAttribute('href').slice(1);
        const targetElement = document.getElementById(targetId);
        
        if (targetElement) {
          // Remove highlight immediately on mouse leave
          targetElement.style.boxShadow = '';
        }
      });
    });

    // Handle manual TOC scrolling to prevent conflicts
    const tocContainer = document.getElementById('toc');
    let tocScrollTimeout;
    
    tocContainer.addEventListener('scroll', () => {
      // Temporarily disable main scroll sync when user scrolls TOC manually
      isUserScrollingTOC = true;
      
      clearTimeout(tocScrollTimeout);
      tocScrollTimeout = setTimeout(() => {
        isUserScrollingTOC = false;
      }, 500); // Re-enable after 500ms of no TOC scrolling
    });

    // Initialize TOC scroll position on page load
    window.addEventListener('load', () => {
      setTimeout(syncTOCWithMainContent, 100);
    });

    // GLOBAL SEARCH: filter cards/sections by text
    const q = document.getElementById('globalSearch');
    const searchable = [...document.querySelectorAll('#content .card, #content details, #content table, #content pre')];
    q.addEventListener('input', ()=>{
      const v = q.value.trim().toLowerCase();
      searchable.forEach(s=>{
        const text = s.innerText.toLowerCase();
        const match = !v || text.includes(v);
        s.style.display = match ? '' : 'none';
      });
    });

    // Keyboard shortcuts
    document.addEventListener('keydown', (e)=>{
      if((e.ctrlKey || e.metaKey) && e.key.toLowerCase()==='k'){
        e.preventDefault(); q.focus();
      }
    });
  </script>
</body>
</html>
